{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Client/Helpers/index.js","webpack:///./src/Client/Helpers/ConnectionHelper.js","webpack:///./src/Common/Helpers/ConnectionHelper.js","webpack:///./src/Client/Helpers/ContentHelper.js","webpack:///./src/Common/Helpers/ContentHelper.js","webpack:///./src/Client/Helpers/DebugHelper.js","webpack:///./src/Common/Helpers/DebugHelper.js","webpack:///./src/Client/Helpers/LanguageHelper.js","webpack:///./src/Common/Helpers/LanguageHelper.js","webpack:///./src/Client/Helpers/MarkdownHelper.js","webpack:///./src/Client/Helpers/MediaHelper.js","webpack:///./src/Common/Helpers/MediaHelper.js","webpack:///./src/Client/Helpers/ProjectHelper.js","webpack:///./src/Client/Helpers/RequestHelper.js","webpack:///./src/Client/Helpers/ResourceHelper.js","webpack:///./src/Client/Helpers/SchemaHelper.js","webpack:///./src/Common/Helpers/SchemaHelper.js","webpack:///./src/Client/Helpers/SettingsHelper.js","webpack:///./src/Common/Helpers/SettingsHelper.js","webpack:///./src/Client/Helpers/UIHelper.js"],"names":["namespace","add","require","ConnectionHelperCommon","ConnectionHelper","Promise","resolve","resources","connections","id","checkParam","String","i","connection","HashBrown","Helpers","ResourceHelper","get","Models","Connection","ProjectHelper","currentProject","currentEnvironment","then","RequestHelper","reloadResource","Views","Navigation","NavbarMain","reload","module","exports","project","environment","SettingsHelper","getSettings","providers","media","setSettings","getConnectionById","ContentHelperCommon","ContentHelper","content","Content","set","value","schema","multilingual","oldValue","window","language","_multilingual","parentId","aboveId","belowId","getContentByIdSync","sort","nodes","filter","x","newIndex","location","hash","indexOf","setTimeout","UI","highlight","editor","document","querySelector","string","toLowerCase","replace","reject","childSchemaId","getContentById","parentContent","SchemaHelper","getSchemaById","schemaId","parentSchema","allowedChildSchemas","childSchema","Error","name","DebugHelperCommon","DebugHelper","debugSocket","WebSocket","protocol","host","onopen","ev","debug","log","onmessage","onSocketMessage","data","JSON","parse","type","errorModal","sender","message","e","dateString","senderString","toUpperCase","console","date","Date","monthString","getMonth","getDate","hoursString","getHours","minutesString","getMinutes","secondsString","getSeconds","output","getFullYear","ignoreLast","senderName","constructor","toString","verbosity","error","getDebugVerbosity","onLog","getDateString","parseSender","trace","LanguageHelperCommon","selectedLanguages","LanguageHelper","selected","Array","isArray","languages","getLanguages","sets","properties","getLocalizedProperties","MarkdownHelper","html","TurndownService","extend","destination","arguments","length","source","key","hasOwnProperty","repeat","character","count","join","blockElements","isBlock","node","nodeName","voidElements","isVoid","voidSelector","hasVoid","rules","paragraph","replacement","lineBreak","options","br","heading","hLevel","Number","charAt","headingStyle","underline","blockquote","list","parent","parentNode","lastElementChild","listItem","prefix","bulletListMarker","start","getAttribute","index","prototype","call","children","nextSibling","test","indentedCodeBlock","codeBlockStyle","firstChild","textContent","fencedCodeBlock","className","match","fence","horizontalRule","hr","inlineLink","linkStyle","href","title","referenceLink","reference","linkReferenceStyle","references","push","append","emphasis","trim","emDelimiter","strong","strongDelimiter","code","hasSiblings","previousSibling","isCodeBlock","delimiter","leadingSpace","trailingSpace","matches","image","alt","src","titlePart","Rules","_keep","_remove","blankRule","blankReplacement","keepReplacement","defaultRule","defaultReplacement","array","rule","unshift","keep","remove","forNode","isBlank","findRule","forEach","fn","filterValue","TypeError","collapseWhitespace","element","isPre","prevText","prevVoid","prev","next","nodeType","text","substr","nextNode","removeChild","current","root","canParseHTMLNatively","Parser","DOMParser","canParse","parseFromString","createHTMLParser","shouldUseActiveX","doc","ActiveXObject","designMode","open","write","close","implementation","createHTMLDocument","useActiveX","HTMLParser","RootNode","input","htmlParser","getElementById","cloneNode","_htmlParser","Node","isCode","flankingWhitespace","leading","trailing","hasLeading","hasTrailing","isFlankedByWhitespace","side","sibling","regExp","isFlanked","nodeValue","reduce","leadingNewLinesRegExp","trailingNewLinesRegExp","escapes","defaults","outerHTML","turndown","canConvert","process","postProcess","use","plugin","addRule","escape","accumulator","self","childNodes","replacementForNode","whitespace","separatingNewlines","newlines","maxNewlines","string1","string2","separator","MediaHelperCommon","MediaHelper","request","result","item","onPickMedia","onChangeResource","onError","allResources","reloadAllResources","addEventListener","isMediaView","Crisp","View","$","addClass","getMediaProvider","getMediaPath","catch","path","parts","pathname","substring","split","method","url","customRequest","environmentUrl","ajax","processData","contentType","success","response","headers","xhr","XMLHttpRequest","k","setRequestHeader","FormData","stringify","send","onreadystatechange","DONE","OK","NOT_MODIFIED","UNAUTHORIZED","readyState","status","responseText","statusCode","newUrl","messageModal","poke","object","model","Form","User","Media","getModel","empty","queue","$msg","_","div","class","processQueue","shift","toggleClass","action","store","Object","indexedDB","onsuccess","target","onerror","query","errorCode","onupgradeneeded","db","createObjectStore","keyPath","autoIncrement","objectStore","transaction","put","delete","category","Resource","indexedDbTransaction","removeCache","getObject","getCache","setCache","SchemaHelperCommon","fieldSchema","getSchemaByIdSync","nextSchema","parentSchemaId","compiledSchema","FieldSchema","appendConfig","config","schemas","ContentSchema","callback","Schema","mergedSchema","merge","parentValues","childValues","icon","editorId","tabs","fields","defaultTabId","SettingsHelperCommon","section","apiUrl","settings","updateCache","cache","cacheSanityCheck","usedBy","UIHelper","label","direction","buttonLabel","dismiss","$highlight","style","offsetTop","offsetLeft","offsetWidth","offsetHeight","if","button","click","parentElement","$space","field","onChange","items","HTMLElement","classList","contains","dataset","fieldSortable","oldIndex","splice","itemSortKeyElement","itemKey","innerHTML","itemValue","nextKey","nextSortKeyElement","nextElementSibling","newObject","fieldKey","fieldValue","btnSort","divValue","isSorting","sortable","toggle","sortableClassName","isActive","slice","canSort","currentDraggedChild","child","ondragover","bodyRect","body","getBoundingClientRect","each","pageY","cursorY","childY","y","siblingY","hasMoved","insertBefore","newChildY","newSiblingY","transform","removeAttribute","draggable","ondragstart","dataTransfer","setData","ondragend","ondragcancel","ondrag","ondragstop","initialValue","Math","floor","random","$input","$element","change","checked","for","on","newValue","attr","dropdownItems","isDropdownUnique","render","itemIndex","dropdownItem","$chip","ul","dropdownItemIndex","li","a","preventDefault","p","span","isSelected","useIndicators","useControls","height","ol","role","onClickOK","stack","warning","group","modal","Modals","Modal","isBlocking","onSubmit","onCancel","IframeModal","ConfirmModal","openContextMenu","clearTargets","targets","querySelectorAll","existingMenu","find","dropdown","Widgets","Dropdown","reverseKeys","pickedItem","top","touches","left","pageX","appendChild","stopPropagation","which","ctrlKey","touchTargets"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;AClFa;AAEb;;;;AAGAA,SAAS,CAAC,SAAD,CAAT,CACCC,GADD,CACKC,mBAAO,CAAC,CAAD,CADZ,EAECD,GAFD,CAEKC,mBAAO,CAAC,CAAD,CAFZ,EAGCD,GAHD,CAGKC,mBAAO,CAAC,CAAD,CAHZ,EAICD,GAJD,CAIKC,mBAAO,CAAC,CAAD,CAJZ,EAKCD,GALD,CAKKC,mBAAO,CAAC,CAAD,CALZ,EAMCD,GAND,CAMKC,mBAAO,CAAC,EAAD,CANZ,EAOCD,GAPD,CAOKC,mBAAO,CAAC,EAAD,CAPZ,EAQCD,GARD,CAQKC,mBAAO,CAAC,EAAD,CARZ,EASCD,GATD,CASKC,mBAAO,CAAC,EAAD,CATZ,EAUCD,GAVD,CAUKC,mBAAO,CAAC,EAAD,CAVZ,EAWCD,GAXD,CAWKC,mBAAO,CAAC,EAAD,CAXZ,EAYCD,GAZD,CAYKC,mBAAO,CAAC,EAAD,CAZZ,E;;;;;;;ACLa;;;;;;;;;;;;;;;;;;;;;;;;AAEb,IAAMC,sBAAsB,GAAGD,mBAAO,CAAC,CAAD,CAAtC;AAEA;;;;;;;IAKME,gB;;;;;;;;;;;;;;AACF;;;;;wCAK2B;AACvB,aAAOC,OAAO,CAACC,OAAR,CAAgBC,SAAS,CAACC,WAA1B,CAAP;AACH;AAED;;;;;;;;;;0CAO6BC,E,EAAI;AAC7BC,gBAAU,CAACD,EAAD,EAAK,IAAL,EAAWE,MAAX,CAAV;;AAEA,WAAI,IAAIC,CAAR,IAAaL,SAAS,CAACC,WAAvB,EAAoC;AAChC,YAAIK,UAAU,GAAGN,SAAS,CAACC,WAAV,CAAsBI,CAAtB,CAAjB;;AAEA,YAAGC,UAAU,CAACJ,EAAX,IAAiBA,EAApB,EAAwB;AACpB,iBAAOI,UAAP;AACH;AACJ;AACJ;AAED;;;;;;;;;;sCAOyBJ,E,EAAI;AACzB,UAAG,CAACA,EAAJ,EAAQ;AAAE,eAAOJ,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAP;AAA+B;;AAEzC,aAAOQ,SAAS,CAACC,OAAV,CAAkBC,cAAlB,CAAiCC,GAAjC,CAAqCH,SAAS,CAACI,MAAV,CAAiBC,UAAtD,EAAkE,aAAlE,EAAiFV,EAAjF,CAAP;AACH;AAED;;;;;;;;;;qCAOwBA,E,EAAI;AACxB,aAAO,6EACHK,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCC,cAD7B,EAEHP,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCE,kBAF7B,EAGHb,EAHG,EAILc,IAJK,CAIA,YAAM;AACT,eAAOT,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCC,cAAhC,CAA+C,OAA/C,CAAP;AACH,OANM,EAONF,IAPM,CAOD,YAAM;AACRT,iBAAS,CAACY,KAAV,CAAgBC,UAAhB,CAA2BC,UAA3B,CAAsCC,MAAtC;AACH,OATM,CAAP;AAUH;AAED;;;;;;;;uCAK0B;AACtB,0FACIf,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCC,cADpC,EAEIP,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCE,kBAFpC;AAIH;;;;EAxE0BnB,sB;;AA2E/B2B,MAAM,CAACC,OAAP,GAAiB3B,gBAAjB,C;;;;;;;ACpFa;AAEb;;;;;;;;;;;;IAKMA,gB;;;;;;;;;;AACF;;;;;;;;sCAQyB4B,O,EAASC,W,EAAa;AAC3CvB,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACuB,WAAD,EAAc,aAAd,EAA6BtB,MAA7B,CAAV;AAEA,aAAON,OAAO,CAACC,OAAR,EAAP;AACH;AAED;;;;;;;;;;;;qCASwB0B,O,EAASC,W,EAAwB;AAAA,UAAXxB,EAAW,uEAAN,IAAM;AACrDC,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACuB,WAAD,EAAc,aAAd,EAA6BtB,MAA7B,CAAV;AAEA,aAAOG,SAAS,CAACC,OAAV,CAAkBmB,cAAlB,CAAiCC,WAAjC,CAA6CH,OAA7C,EAAsDC,WAAtD,EAAmE,WAAnE,EACNV,IADM,CACD,UAACa,SAAD,EAAe;AACjBA,iBAAS,GAAGA,SAAS,IAAI,EAAzB;AACAA,iBAAS,CAACC,KAAV,GAAkB5B,EAAlB;AAEA,eAAOK,SAAS,CAACC,OAAV,CAAkBmB,cAAlB,CAAiCI,WAAjC,CAA6CN,OAA7C,EAAsDC,WAAtD,EAAmE,WAAnE,EAAgFG,SAAhF,CAAP;AACH,OANM,CAAP;AAOH;AAED;;;;;;;;;;;qCAQwBJ,O,EAASC,W,EAAa;AAAA;;AAC1CvB,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACuB,WAAD,EAAc,aAAd,EAA6BtB,MAA7B,CAAV;AAEA,aAAOG,SAAS,CAACC,OAAV,CAAkBmB,cAAlB,CAAiCC,WAAjC,CAA6CH,OAA7C,EAAsDC,WAAtD,EAAmE,WAAnE,EAEP;AAFO,OAGNV,IAHM,CAGD,UAACa,SAAD,EAAe;AACjB,YAAG,CAACA,SAAJ,EAAe;AACX,iBAAOtB,SAAS,CAACC,OAAV,CAAkBmB,cAAlB,CAAiCC,WAAjC,CAA6CH,OAA7C,EAAsD,IAAtD,EAA4D,WAA5D,CAAP;AAEH,SAHD,MAGO;AACH,iBAAO3B,OAAO,CAACC,OAAR,CAAgB8B,SAAhB,CAAP;AACH;AACJ,OAVM,EAYP;AAZO,OAaNb,IAbM,CAaD,UAACa,SAAD,EAAe;AACjBA,iBAAS,GAAGA,SAAS,IAAI,EAAzB;;AAEA,YAAGA,SAAS,CAACC,KAAb,EAAoB;AAChB,iBAAO,KAAI,CAACE,iBAAL,CAAuBP,OAAvB,EAAgCC,WAAhC,EAA6CG,SAAS,CAACC,KAAvD,CAAP;AACH,SAFD,MAEO;AACH,iBAAOhC,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAP;AACH;AACJ,OArBM,CAAP;AAsBH;;;;;;AAGLwB,MAAM,CAACC,OAAP,GAAiB3B,gBAAjB,C;;;;;;;AClFa;;;;;;;;;;;;;;;;;;;;AAEb,IAAMoC,mBAAmB,GAAGtC,mBAAO,CAAC,CAAD,CAAnC;AAEA;;;;;;;IAKMuC,a;;;;;;;;;;;;;;AACF;;;;;;;uCAO0BhC,E,EAAI;AAC1B,UAAG,CAACA,EAAJ,EAAQ;AAAE,eAAO,IAAP;AAAc;;AADE;AAAA;AAAA;;AAAA;AAG1B,6BAAmBF,SAAS,CAACmC,OAA7B,8HAAsC;AAAA,cAA9BA,OAA8B;;AAClC,cAAGA,OAAO,CAACjC,EAAR,KAAeA,EAAlB,EAAsB;AAClB,mBAAOiC,OAAP;AACH;AACJ;AAPyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQ7B;AAED;;;;;;;;;;mCAOsBjC,E,EAAI;AACtB,UAAG,CAACA,EAAJ,EAAQ;AAAE,eAAOJ,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAP;AAA+B;;AAEzC,aAAOQ,SAAS,CAACC,OAAV,CAAkBC,cAAlB,CAAiCC,GAAjC,CAAqCH,SAAS,CAACI,MAAV,CAAiByB,OAAtD,EAA+D,SAA/D,EAA0ElC,EAA1E,CAAP;AACH;AAED;;;;;;;;;;;mCAQsBA,E,EAAIiC,O,EAAS;AAC/BhC,gBAAU,CAACD,EAAD,EAAK,IAAL,EAAWE,MAAX,CAAV;AACAD,gBAAU,CAACgC,OAAD,EAAU,SAAV,EAAqB5B,SAAS,CAACI,MAAV,CAAiByB,OAAtC,CAAV;AAEA,aAAO7B,SAAS,CAACC,OAAV,CAAkBC,cAAlB,CAAiC4B,GAAjC,CAAqC,SAArC,EAAgDnC,EAAhD,EAAoDiC,OAApD,CAAP;AACH;AAED;;;;;;;;;qCAMwBG,K,EAAOC,M,EAAQ;AACnC;AACA,UAAGA,MAAM,CAACC,YAAP,KAAwB,CAACF,KAAD,IAAU,QAAOA,KAAP,MAAiB,QAAnD,CAAH,EAAiE;AAC7D,YAAIG,QAAQ,GAAGH,KAAf;AAEAA,aAAK,GAAG,EAAR;AACAA,aAAK,CAACI,MAAM,CAACC,QAAR,CAAL,GAAyBF,QAAzB;AACH,OAPkC,CASnC;AACA;;;AACA,UAAG,CAACF,MAAM,CAACC,YAAR,IAAwBF,KAAxB,IAAiC,QAAOA,KAAP,MAAiB,QAAlD,IAA8DA,KAAK,CAACM,aAAvE,EAAsF;AAClFN,aAAK,GAAGA,KAAK,CAACI,MAAM,CAACC,QAAR,CAAb;AACH,OAbkC,CAenC;;;AACA,UAAGJ,MAAM,CAACC,YAAP,IAAuBF,KAAvB,IAAgC,CAACA,KAAK,CAACM,aAA1C,EAAyD;AACrDN,aAAK,CAACM,aAAN,GAAsB,IAAtB;AAEH,OAHD,MAGO,IAAG,CAACL,MAAM,CAACC,YAAR,IAAwBF,KAAxB,IAAiCA,KAAK,CAACM,aAA1C,EAAyD;AAC5D,eAAON,KAAK,CAACM,aAAb;AAEH;;AAED,aAAON,KAAP;AACH;AAED;;;;;;;;;;oCAOuBO,Q,EAAUC,O,EAASC,O,EAAS;AAC/C,UAAGD,OAAH,EAAY;AACR,eAAO,KAAKE,kBAAL,CAAwBF,OAAxB,EAAiCG,IAAjC,GAAwC,CAA/C;AACH;;AAED,UAAGF,OAAH,EAAY;AACR,eAAO,KAAKC,kBAAL,CAAwBD,OAAxB,EAAiCE,IAAjC,GAAwC,CAA/C;AACH,OAP8C,CAS/C;;;AACA,UAAIC,KAAK,GAAGlD,SAAS,CAACmC,OAAV,CAAkBgB,MAAlB,CAAyB,UAACC,CAAD,EAAO;AACxC,eAAOA,CAAC,CAACP,QAAF,IAAcA,QAAd,IAA2B,CAACO,CAAC,CAACP,QAAH,IAAe,CAACA,QAAlD;AACH,OAFW,CAAZ,CAV+C,CAc/C;AACA;;AACA,UAAIQ,QAAQ,GAAG,KAAf;AAhB+C;AAAA;AAAA;;AAAA;AAkB/C,8BAAmBH,KAAnB,mIAA0B;AAAA,cAAlBf,OAAkB;;AACtB,cAAGkB,QAAQ,GAAG,KAAX,IAAoBlB,OAAO,CAACc,IAA/B,EAAqC;AACjCI,oBAAQ,GAAGlB,OAAO,CAACc,IAAR,GAAe,KAA1B;AACH;AACJ;AAtB8C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAwB/C,aAAOI,QAAP;AACH;AAED;;;;;;gCAGmB;AACf,UAAGC,QAAQ,CAACC,IAAT,CAAcC,OAAd,CAAsB,UAAtB,IAAoC,CAAvC,EAA0C;AACtCF,gBAAQ,CAACC,IAAT,GAAgB,WAAhB;AACH;;AAED,aAAO,IAAIzD,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC5B0D,kBAAU,CAAC,YAAM;AACb1D,iBAAO;AACV,SAFS,EAEP,GAFO,CAAV;AAGH,OAJM,EAKNiB,IALM,CAKD,YAAM;AACR,eAAO0C,EAAE,CAACC,SAAH,CAAa,2CAAb,EAA0D,oEAA1D,EAAgI,OAAhI,EAAyI,MAAzI,CAAP;AACH,OAPM,EAQN3C,IARM,CAQD,YAAM;AACR,eAAO0C,EAAE,CAACC,SAAH,CAAa,4CAAb,EAA2D,oHAA3D,EAAiL,OAAjL,EAA0L,MAA1L,CAAP;AACH,OAVM,EAWN3C,IAXM,CAWD,YAAM;AACR,YAAI4C,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAAb;;AAEA,YAAG,CAACF,MAAJ,EAAY;AACR,iBAAOF,EAAE,CAACC,SAAH,CAAa,mCAAb,EAAkD,yEAAlD,EAA6H,MAA7H,EAAqI,MAArI,CAAP;AACH;;AAED,eAAOD,EAAE,CAACC,SAAH,CAAa,kBAAb,EAAiC,2DAAjC,EAA8F,MAA9F,EAAsG,MAAtG,CAAP;AACH,OAnBM,CAAP;AAoBH;;;;EA7IuB1B,mB;;AAgJ5BV,MAAM,CAACC,OAAP,GAAiBU,aAAjB,C;;;;;;;ACzJa;AAEb;;;;;;;;;;;;IAKMA,a;;;;;;;;;;AACF;;;;;;;;mCAQsBT,O,EAASC,W,EAAa;AACxCvB,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACuB,WAAD,EAAc,aAAd,EAA6BtB,MAA7B,CAAV;AAEA,aAAON,OAAO,CAACC,OAAR,EAAP;AACH;AAED;;;;;;;;;;4BAOegE,M,EAAQ;AACnB,aAAO,CAACA,MAAM,IAAI,EAAX,EACFC,WADE,GAEFC,OAFE,CAEM,QAFN,EAEgB,IAFhB,EAGFA,OAHE,CAGM,QAHN,EAGgB,IAHhB,EAIFA,OAJE,CAIM,IAJN,EAIY,IAJZ,EAKFA,OALE,CAKM,IALN,EAKY,IALZ,EAMFA,OANE,CAMM,IANN,EAMY,IANZ,EAOFA,OAPE,CAOM,UAPN,EAOkB,EAPlB,EAQFA,OARE,CAQM,KARN,EAQa,GARb,CAAP;AAUH;AAED;;;;;;;;;;;;mCASsBxC,O,EAASC,W,EAAaxB,E,EAAI;AAC5CC,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACuB,WAAD,EAAc,aAAd,EAA6BtB,MAA7B,CAAV;AACAD,gBAAU,CAACD,EAAD,EAAK,IAAL,EAAWE,MAAX,CAAV;AAEA,aAAON,OAAO,CAACC,OAAR,EAAP;AACH;AAED;;;;;;;;;;;;;mCAUsB0B,O,EAASC,W,EAAaxB,E,EAAIiC,O,EAAS;AACrDhC,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACuB,WAAD,EAAc,aAAd,EAA6BtB,MAA7B,CAAV;AACAD,gBAAU,CAACD,EAAD,EAAK,IAAL,EAAWE,MAAX,CAAV;AACAD,gBAAU,CAACgC,OAAD,EAAU,SAAV,EAAqB5B,SAAS,CAACI,MAAV,CAAiByB,OAAtC,CAAV;AAEA,aAAO,IAAItC,OAAJ,CAAY,UAACC,OAAD,EAAUmE,MAAV,EAAqB;AACpCnE,eAAO;AACV,OAFM,CAAP;AAGH;AAED;;;;;;;;;;;;;2CAU8B0B,O,EAASC,W,EAAamB,Q,EAAUsB,a,EAAe;AACzEhE,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACuB,WAAD,EAAc,aAAd,EAA6BtB,MAA7B,CAAV;AACAD,gBAAU,CAAC0C,QAAD,EAAW,UAAX,EAAuBzC,MAAvB,CAAV;AACAD,gBAAU,CAACgE,aAAD,EAAgB,eAAhB,EAAiC/D,MAAjC,CAAV,CAJyE,CAMzE;;AACA,UAAG,CAACyC,QAAJ,EAAc;AACV,eAAO/C,OAAO,CAACC,OAAR,EAAP;AAEH,OAHD,MAGO;AACH,eAAO,KAAKqE,cAAL,CAAoB3C,OAApB,EAA6BC,WAA7B,EAA0CmB,QAA1C,EACN7B,IADM,CACD,UAACqD,aAAD,EAAmB;AACrB,iBAAO9D,SAAS,CAACC,OAAV,CAAkB8D,YAAlB,CAA+BC,aAA/B,CAA6C9C,OAA7C,EAAsDC,WAAtD,EAAmE2C,aAAa,CAACG,QAAjF,CAAP;AACH,SAHM,EAINxD,IAJM,CAID,UAACyD,YAAD,EAAkB;AACpB;AACA,cAAGA,YAAY,CAACC,mBAAb,CAAiClB,OAAjC,CAAyCW,aAAzC,IAA0D,CAA7D,EAAgE;AAC5D,mBAAO5D,SAAS,CAACC,OAAV,CAAkB8D,YAAlB,CAA+BC,aAA/B,CAA6C9C,OAA7C,EAAsDC,WAAtD,EAAmEyC,aAAnE,EACNnD,IADM,CACD,UAAC2D,WAAD,EAAiB;AACnB,qBAAO7E,OAAO,CAACoE,MAAR,CAAe,IAAIU,KAAJ,CAAU,0BAA0BD,WAAW,CAACE,IAAtC,GAA6C,oDAA7C,GAAoGJ,YAAY,CAACI,IAAjH,GAAwH,GAAlI,CAAf,CAAP;AACH,aAHM,CAAP,CAD4D,CAMhE;AACC,WAPD,MAOO;AACH,mBAAO/E,OAAO,CAACC,OAAR,EAAP;AAEH;AACJ,SAjBM,CAAP;AAkBH;AACJ;AAED;;;;;;;;oCAKuB;AACnB,aAAO,IAAID,OAAJ,CAAY,UAACC,OAAD,EAAUmE,MAAV,EAAqB;AACpCnE,eAAO;AACV,OAFM,CAAP;AAGH;AAED;;;;;;;;;;sCAOyBG,E,EAAI;AACzB,aAAO,IAAIJ,OAAJ,CAAY,UAACC,OAAD,EAAUmE,MAAV,EAAqB;AACpCnE,eAAO;AACV,OAFM,CAAP;AAGH;;;;;;AAGLwB,MAAM,CAACC,OAAP,GAAiBU,aAAjB,C;;;;;;;ACpJa;;;;;;;;;;;;;;;;;;;;AAEb,IAAM4C,iBAAiB,GAAGnF,mBAAO,CAAC,CAAD,CAAjC;AAEA;;;;;;;IAKMoF,W;;;;;;;;;;;;;;AACF;;;kCAGqB;AAAA;;AACjB,UAAIC,WAAW,GAAG,IAAIC,SAAJ,CAAc3B,QAAQ,CAAC4B,QAAT,CAAkBjB,OAAlB,CAA0B,MAA1B,EAAkC,IAAlC,IAA0C,IAA1C,GAAiDX,QAAQ,CAAC6B,IAA1D,GAAiE,YAA/E,CAAlB;;AAEAH,iBAAW,CAACI,MAAZ,GAAqB,UAACC,EAAD,EAAQ;AACzBC,aAAK,CAACC,GAAN,CAAU,mBAAV,EAA+B,WAA/B;AACH,OAFD;;AAIAP,iBAAW,CAACQ,SAAZ,GAAwB,UAACH,EAAD,EAAQ;AAC5B,aAAI,CAACI,eAAL,CAAqBJ,EAArB;AACH,OAFD;AAGH;AAED;;;;;;oCAGuBA,E,EAAI;AACvB,UAAI;AACA,YAAIK,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWP,EAAE,CAACK,IAAd,CAAX;;AAEA,gBAAOA,IAAI,CAACG,IAAZ;AACI,eAAK,OAAL;AACInC,cAAE,CAACoC,UAAH,CAAc,IAAIlB,KAAJ,CAAUc,IAAI,CAACK,MAAL,GAAc,IAAd,GAAqBL,IAAI,CAACM,OAApC,CAAd;AACA;;AAEJ,eAAK,SAAL;AACItC,cAAE,CAACoC,UAAH,CAAc,IAAIlB,KAAJ,CAAUc,IAAI,CAACK,MAAL,GAAc,IAAd,GAAqBL,IAAI,CAACM,OAApC,CAAd;AACA;AAPR;AAUH,OAbD,CAaE,OAAMC,CAAN,EAAS;AACPvC,UAAE,CAACoC,UAAH,CAAcT,EAAd;AACH;AACJ;;;;EApCqBP,iB;;AAuC1BvD,MAAM,CAACC,OAAP,GAAiBuD,WAAjB,C;;;;;;;AChDa;AAEb;;;;;;;;;;;;IAKMA,W;;;;;;;;;;AACF;;;;;;;;0BAQamB,U,EAAYC,Y,EAAcH,O,EAASH,I,EAAM;AAClD,UAAGA,IAAH,EAAS;AACLG,eAAO,GAAG,MAAMH,IAAI,CAACO,WAAL,EAAN,GAA2B,IAA3B,GAAkCJ,OAA5C;AACH;;AAEDK,aAAO,CAACd,GAAR,CAAYW,UAAU,GAAG,KAAb,GAAqBC,YAArB,GAAoC,KAApC,GAA4CH,OAAxD;AACH;AAED;;;;;;;;oCAKuB;AACnB,UAAIM,IAAI,GAAG,IAAIC,IAAJ,EAAX;AAEA,UAAIC,WAAW,GAAIF,IAAI,CAACG,QAAL,KAAkB,CAArC;;AAEA,UAAGD,WAAW,GAAG,EAAjB,EAAqB;AACjBA,mBAAW,GAAG,MAAMA,WAApB;AACH;;AAED,UAAIN,UAAU,GAAGI,IAAI,CAACI,OAAL,EAAjB;;AAEA,UAAGR,UAAU,GAAG,EAAhB,EAAoB;AAChBA,kBAAU,GAAG,MAAMA,UAAnB;AACH;;AAED,UAAIS,WAAW,GAAGL,IAAI,CAACM,QAAL,EAAlB;;AAEA,UAAGD,WAAW,GAAG,EAAjB,EAAqB;AACjBA,mBAAW,GAAG,MAAMA,WAApB;AACH;;AAED,UAAIE,aAAa,GAAGP,IAAI,CAACQ,UAAL,EAApB;;AAEA,UAAGD,aAAa,GAAG,EAAnB,EAAuB;AACnBA,qBAAa,GAAG,MAAMA,aAAtB;AACH;;AAED,UAAIE,aAAa,GAAGT,IAAI,CAACU,UAAL,EAApB;;AAEA,UAAGD,aAAa,GAAG,EAAnB,EAAuB;AACnBA,qBAAa,GAAG,MAAMA,aAAtB;AACH;;AAED,UAAIE,MAAM,GACNX,IAAI,CAACY,WAAL,KAAqB,GAArB,GACAV,WADA,GACc,GADd,GAEAN,UAFA,GAEa,GAFb,GAGAS,WAHA,GAGc,GAHd,GAIAE,aAJA,GAIgB,GAJhB,GAKAE,aANJ;AAQA,aAAOE,MAAP;AACH;AAED;;;;;;;;;;gCAOmBlB,M,EAAQoB,U,EAAY;AACnC,UAAIC,UAAU,GAAG,EAAjB;;AAEA,UAAGrB,MAAH,EAAW;AACP,YAAG,OAAOA,MAAP,KAAkB,QAArB,EAA+B;AAC3BqB,oBAAU,GAAGrB,MAAb;AAEH,SAHD,MAGO,IAAG,OAAOA,MAAP,KAAkB,UAArB,EAAiC;AACpCqB,oBAAU,GAAGrB,MAAM,CAAClB,IAApB;AAEH,SAHM,MAGA,IAAGkB,MAAM,CAACsB,WAAV,EAAuB;AAC1BD,oBAAU,GAAGrB,MAAM,CAACsB,WAAP,CAAmBxC,IAAhC;AAEH,SAHM,MAGA;AACHuC,oBAAU,GAAGrB,MAAM,CAACuB,QAAP,EAAb;AAEH;AACJ;;AAED,aAAOF,UAAP;AACH;AAED;;;;;;;;wCAK2B;AACvB,aAAO,CAAP;AACH;AAED;;;;;;;;;;wBAOWpB,O,EAASD,M,EAAuB;AAAA,UAAfwB,SAAe,uEAAH,CAAG;;AACvC,UAAGA,SAAS,IAAI,CAAhB,EAAmB;AACf,aAAKC,KAAL,CAAW,8BAAX,EAA2C,IAA3C;AAEH,OAHD,MAGO,IAAG,CAACD,SAAJ,EAAe;AAClBA,iBAAS,GAAG,CAAZ;AACH;;AAED,UAAG,KAAKE,iBAAL,MAA4BF,SAA/B,EAA0C;AACtC,aAAKG,KAAL,CAAW,KAAKC,aAAL,EAAX,EAAiC,KAAKC,WAAL,CAAiB7B,MAAjB,CAAjC,EAA2DC,OAA3D;AACH;AACJ;AAED;;;;;;;;;0BAMawB,M,EAAOzB,M,EAAQ;AACxB,UAAGyB,MAAK,YAAY5C,KAAjB,KAA2B,IAA9B,EAAoC;AAChC4C,cAAK,GAAG,IAAI5C,KAAJ,CAAU4C,MAAV,CAAR;AACH;;AAED,WAAKE,KAAL,CAAW,KAAKC,aAAL,EAAX,EAAiC,KAAKC,WAAL,CAAiB7B,MAAjB,CAAjC,EAA2DyB,MAAK,CAACxB,OAAN,IAAiBwB,MAAK,CAACK,KAAlF,EAA0F,OAA1F;AAEA,YAAML,MAAN;AACH;AAED;;;;;;4BAGexB,O,EAASD,M,EAAQ;AAC5B,WAAK2B,KAAL,CAAW,KAAKC,aAAL,EAAX,EAAiC,KAAKC,WAAL,CAAiB7B,MAAjB,CAAjC,EAA2DC,OAA3D,EAAoE,SAApE;AACH;;;;;;AAGLzE,MAAM,CAACC,OAAP,GAAiBuD,WAAjB,C;;;;;;;AC3Ja;;;;;;;;;;;;;;;;;;;;AAEb,IAAM+C,oBAAoB,GAAGnI,mBAAO,CAAC,CAAD,CAApC;;AAEA,IAAIoI,iBAAiB,GAAG,EAAxB;AAEA;;;;;;IAKMC,c;;;;;;;;;;;;;;AACF;;;;;;;iCAOoBvG,O,EAAS;AACzBA,aAAO,GAAGA,OAAO,IAAIlB,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCC,cAArD;AAEA,aAAOP,SAAS,CAACC,OAAV,CAAkBmB,cAAlB,CAAiCC,WAAjC,CAA6CH,OAA7C,EAAsD,IAAtD,EAA4D,WAA5D,EACNT,IADM,CACD,UAACiH,QAAD,EAAc;AAChB,YAAG,CAACA,QAAD,IAAa,CAACC,KAAK,CAACC,OAAN,CAAcF,QAAd,CAAjB,EAA0C;AACtCA,kBAAQ,GAAG,CAAC,IAAD,CAAX;AACH;;AAEDA,gBAAQ,CAAChF,IAAT;AAEA8E,yBAAiB,CAACtG,OAAD,CAAjB,GAA6BwG,QAA7B;AAEA,eAAOnI,OAAO,CAACC,OAAR,CAAgBkI,QAAhB,CAAP;AACH,OAXM,CAAP;AAYH;AAED;;;;;;;;;;qCAOwBxG,O,EAAS;AAC7BA,aAAO,GAAGA,OAAO,IAAIlB,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCC,cAArD;AAEA,aAAOiH,iBAAiB,CAACtG,OAAD,CAAjB,IAA8B,CAAC,IAAD,CAArC;AACH;AAED;;;;;;;;;;;iCAQoBA,O,EAAS2G,S,EAAW;AACpCjI,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACiI,SAAD,EAAY,WAAZ,EAAyBF,KAAzB,CAAV;;AAEA,UAAG,CAACA,KAAK,CAACC,OAAN,CAAcC,SAAd,CAAJ,EAA8B;AAC1B,eAAOtI,OAAO,CAACoE,MAAR,CAAe,IAAIU,KAAJ,CAAU,+CAA8CwD,SAA9C,IAA0D,GAApE,CAAf,CAAP;AACH;;AAED,aAAO7H,SAAS,CAACC,OAAV,CAAkBmB,cAAlB,CAAiCI,WAAjC,CAA6CN,OAA7C,EAAsD,IAAtD,EAA4D,WAA5D,EAAyE2G,SAAzE,CAAP;AACH;;;;EAvDwBN,oB;;AA0D7BvG,MAAM,CAACC,OAAP,GAAiBwG,cAAjB,C;;;;;;;ACrEa;AAEb;;;;;;;;;;;;IAKMA,c;;;;;;;;;;AACF;;;;;;;iCAOoBvG,O,EAAS;AACzBtB,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AAEA,aAAON,OAAO,CAACC,OAAR,CAAgB,EAAhB,CAAP;AACH;AAED;;;;;;;;;;;iCAQoB0B,O,EAAS2G,S,EAAW;AACpCjI,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACiI,SAAD,EAAY,WAAZ,EAAyBF,KAAzB,CAAV;AAEA,aAAOpI,OAAO,CAACC,OAAR,EAAP;AACH;AAED;;;;;;;;;;;;gDASmC0B,O,EAASC,W,EAAaS,O,EAAS;AAC9DhC,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACuB,WAAD,EAAc,aAAd,EAA6BtB,MAA7B,CAAV;AACAD,gBAAU,CAACgC,OAAD,EAAU,SAAV,EAAqB5B,SAAS,CAACI,MAAV,CAAiByB,OAAtC,CAAV;AAEA,aAAO,KAAKiG,YAAL,CAAkB5G,OAAlB,EACNT,IADM,CACD,UAACoH,SAAD,EAAe;AACjB,YAAIE,IAAI,GAAG,EAAX;AADiB;AAAA;AAAA;;AAAA;AAGjB,+BAAoBF,SAApB,8HAA+B;AAAA,gBAAvBzF,QAAuB;AAC3B,gBAAI4F,UAAU,GAAGpG,OAAO,CAACqG,sBAAR,CAA+B7F,QAA/B,CAAjB;AAEA2F,gBAAI,CAAC3F,QAAD,CAAJ,GAAiB4F,UAAjB;AACH;AAPgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AASjB,eAAOzI,OAAO,CAACC,OAAR,CAAgBuI,IAAhB,CAAP;AACH,OAXM,CAAP;AAYH;AAED;;;;;;;;yCAK4B;AACxB,aAAO,CACH,IADG,EAEH,IAFG,EAGH,IAHG,EAIH,IAJG,EAKH,IALG,EAMH,IANG,EAOH,IAPG,EAQH,IARG,EASH,IATG,EAUH,IAVG,EAWH,IAXG,EAYH,IAZG,EAaH,IAbG,EAcH,IAdG,EAeH,IAfG,EAgBH,IAhBG,EAiBH,IAjBG,EAkBH,IAlBG,EAmBH,IAnBG,EAoBH,IApBG,EAqBH,IArBG,EAsBH,IAtBG,EAuBH,IAvBG,EAwBH,IAxBG,EAyBH,IAzBG,EA0BH,IA1BG,EA2BH,IA3BG,EA4BH,IA5BG,EA6BH,IA7BG,EA8BH,IA9BG,EA+BH,IA/BG,EAgCH,IAhCG,EAiCH,IAjCG,EAkCH,IAlCG,EAmCH,IAnCG,EAoCH,IApCG,EAqCH,IArCG,EAsCH,IAtCG,EAuCH,IAvCG,EAwCH,IAxCG,EAyCH,IAzCG,EA0CH,IA1CG,EA2CH,IA3CG,EA4CH,IA5CG,EA6CH,IA7CG,EA8CH,IA9CG,EA+CH,IA/CG,EAgDH,IAhDG,EAiDH,IAjDG,EAkDH,IAlDG,EAmDH,IAnDG,EAoDH,IApDG,EAqDH,IArDG,EAsDH,IAtDG,EAuDH,IAvDG,EAwDH,IAxDG,EAyDH,IAzDG,EA0DH,IA1DG,EA2DH,IA3DG,EA4DH,IA5DG,EA6DH,IA7DG,EA8DH,IA9DG,EA+DH,IA/DG,EAgEH,IAhEG,EAiEH,IAjEG,EAkEH,IAlEG,EAmEH,IAnEG,EAoEH,IApEG,EAqEH,IArEG,EAsEH,IAtEG,EAuEH,IAvEG,EAwEH,IAxEG,EAyEH,IAzEG,EA0EH,IA1EG,EA2EH,IA3EG,EA4EH,IA5EG,EA6EH,IA7EG,EA8EH,IA9EG,EA+EH,IA/EG,EAgFH,IAhFG,EAiFH,IAjFG,EAkFH,IAlFG,EAmFH,IAnFG,EAoFH,IApFG,EAqFH,IArFG,EAsFH,IAtFG,EAuFH,IAvFG,EAwFH,IAxFG,EAyFH,IAzFG,EA0FH,IA1FG,EA2FH,IA3FG,EA4FH,IA5FG,EA6FH,IA7FG,EA8FH,IA9FG,EA+FH,IA/FG,EAgGH,IAhGG,EAiGH,IAjGG,EAkGH,IAlGG,EAmGH,IAnGG,EAoGH,IApGG,EAqGH,IArGG,EAsGH,IAtGG,EAuGH,IAvGG,EAwGH,IAxGG,EAyGH,IAzGG,EA0GH,IA1GG,EA2GH,IA3GG,EA4GH,IA5GG,EA6GH,IA7GG,EA8GH,IA9GG,EA+GH,IA/GG,EAgHH,IAhHG,EAiHH,IAjHG,EAkHH,IAlHG,EAmHH,IAnHG,EAoHH,IApHG,EAqHH,IArHG,EAsHH,IAtHG,EAuHH,IAvHG,EAwHH,IAxHG,EAyHH,IAzHG,EA0HH,IA1HG,EA2HH,IA3HG,EA4HH,IA5HG,EA6HH,IA7HG,EA8HH,IA9HG,EA+HH,IA/HG,EAgIH,IAhIG,EAiIH,IAjIG,EAkIH,IAlIG,EAmIH,IAnIG,EAoIH,IApIG,EAqIH,IArIG,EAsIH,IAtIG,EAuIH,IAvIG,EAwIH,IAxIG,EAyIH,IAzIG,EA0IH,IA1IG,EA2IH,IA3IG,EA4IH,IA5IG,EA6IH,IA7IG,EA8IH,IA9IG,EA+IH,IA/IG,EAgJH,IAhJG,EAiJH,IAjJG,EAkJH,IAlJG,EAmJH,IAnJG,EAoJH,IApJG,EAqJH,IArJG,EAsJH,IAtJG,EAuJH,IAvJG,EAwJH,IAxJG,EAyJH,IAzJG,EA0JH,IA1JG,EA2JH,IA3JG,EA4JH,IA5JG,EA6JH,IA7JG,EA8JH,IA9JG,EA+JH,IA/JG,EAgKH,IAhKG,EAiKH,IAjKG,EAkKH,IAlKG,EAmKH,IAnKG,EAoKH,IApKG,EAqKH,IArKG,EAsKH,IAtKG,EAuKH,IAvKG,EAwKH,IAxKG,EAyKH,IAzKG,EA0KH,IA1KG,EA2KH,IA3KG,EA4KH,IA5KG,EA6KH,IA7KG,EA8KH,IA9KG,EA+KH,IA/KG,EAgLH,IAhLG,EAiLH,IAjLG,EAkLH,IAlLG,EAmLH,IAnLG,EAoLH,IApLG,EAqLH,IArLG,EAsLH,IAtLG,EAuLH,IAvLG,EAwLH,IAxLG,EAyLH,IAzLG,CAAP;AA2LH;;;;;;AAGL/G,MAAM,CAACC,OAAP,GAAiBwG,cAAjB,C;;;;;;;ACpQa;AAEb;;;;;;;;;;;;IAKMS,c;;;;;;;;;;AACF;;;;;;;;;;;6BAWgBC,I,EAAM;AAClB,UAAIC,eAAe,GAAI,YAAY;AAC/B;;AAEA,iBAASC,MAAT,CAAgBC,WAAhB,EAA6B;AACzB,eAAK,IAAIxI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyI,SAAS,CAACC,MAA9B,EAAsC1I,CAAC,EAAvC,EAA2C;AACvC,gBAAI2I,MAAM,GAAGF,SAAS,CAACzI,CAAD,CAAtB;;AACA,iBAAK,IAAI4I,GAAT,IAAgBD,MAAhB,EAAwB;AACpB,kBAAIA,MAAM,CAACE,cAAP,CAAsBD,GAAtB,CAAJ,EACIJ,WAAW,CAACI,GAAD,CAAX,GAAmBD,MAAM,CAACC,GAAD,CAAzB;AACH;AACJ;;AACL,iBAAOJ,WAAP;AACH;;AAED,iBAASM,MAAT,CAAgBC,SAAhB,EAA2BC,KAA3B,EAAkC;AAC9B,iBAAOnB,KAAK,CAACmB,KAAK,GAAG,CAAT,CAAL,CAAiBC,IAAjB,CAAsBF,SAAtB,CAAP;AACH;;AAED,YAAIG,aAAa,GAAG,CAChB,SADgB,EAEhB,SAFgB,EAGhB,OAHgB,EAIhB,OAJgB,EAKhB,YALgB,EAMhB,MANgB,EAOhB,QAPgB,EAQhB,QARgB,EAShB,IATgB,EAUhB,KAVgB,EAWhB,KAXgB,EAYhB,IAZgB,EAahB,IAbgB,EAchB,UAdgB,EAehB,YAfgB,EAgBhB,QAhBgB,EAiBhB,QAjBgB,EAkBhB,MAlBgB,EAmBhB,UAnBgB,EAoBhB,IApBgB,EAqBhB,IArBgB,EAsBhB,IAtBgB,EAuBhB,IAvBgB,EAwBhB,IAxBgB,EAyBhB,IAzBgB,EA0BhB,QA1BgB,EA2BhB,QA3BgB,EA4BhB,IA5BgB,EA6BhB,MA7BgB,EA8BhB,SA9BgB,EA+BhB,IA/BgB,EAgChB,MAhCgB,EAiChB,MAjCgB,EAkChB,KAlCgB,EAmChB,UAnCgB,EAoChB,UApCgB,EAqChB,IArCgB,EAsChB,QAtCgB,EAuChB,GAvCgB,EAwChB,KAxCgB,EAyChB,SAzCgB,EA0ChB,OA1CgB,EA2ChB,OA3CgB,EA4ChB,IA5CgB,EA6ChB,OA7CgB,EA8ChB,IA9CgB,EA+ChB,OA/CgB,EAgDhB,IAhDgB,EAiDhB,IAjDgB,CAApB;;AAoDA,iBAASC,OAAT,CAAiBC,IAAjB,EAAuB;AACnB,iBAAOF,aAAa,CAAC/F,OAAd,CAAsBiG,IAAI,CAACC,QAAL,CAAc1F,WAAd,EAAtB,MAAuD,CAAC,CAA/D;AACH;;AAED,YAAI2F,YAAY,GAAG,CACf,MADe,EAEf,MAFe,EAGf,IAHe,EAIf,KAJe,EAKf,SALe,EAMf,OANe,EAOf,IAPe,EAQf,KARe,EASf,OATe,EAUf,QAVe,EAWf,MAXe,EAYf,MAZe,EAaf,OAbe,EAcf,QAde,EAef,OAfe,EAgBf,KAhBe,CAAnB;;AAmBA,iBAASC,MAAT,CAAgBH,IAAhB,EAAsB;AAClB,iBAAOE,YAAY,CAACnG,OAAb,CAAqBiG,IAAI,CAACC,QAAL,CAAc1F,WAAd,EAArB,MAAsD,CAAC,CAA9D;AACH;;AAED,YAAI6F,YAAY,GAAGF,YAAY,CAACL,IAAb,EAAnB;;AACA,iBAASQ,OAAT,CAAiBL,IAAjB,EAAuB;AACnB,iBAAOA,IAAI,CAAC3F,aAAL,IAAsB2F,IAAI,CAAC3F,aAAL,CAAmB+F,YAAnB,CAA7B;AACH;;AAED,YAAIE,KAAK,GAAG,EAAZ;AAEAA,aAAK,CAACC,SAAN,GAAkB;AACd7G,gBAAM,EAAE,GADM;AAGd8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmB;AAC5B,mBAAO,SAASA,OAAT,GAAmB,MAA1B;AACH;AALa,SAAlB;AAQA4H,aAAK,CAACG,SAAN,GAAkB;AACd/G,gBAAM,EAAE,IADM;AAGd8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3C,mBAAOA,OAAO,CAACC,EAAR,GAAa,IAApB;AACH;AALa,SAAlB;AAQAL,aAAK,CAACM,OAAN,GAAgB;AACZlH,gBAAM,EAAE,CACJ,IADI,EAEJ,IAFI,EAGJ,IAHI,EAIJ,IAJI,EAKJ,IALI,EAMJ,IANI,CADI;AAUZ8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3C,gBAAIG,MAAM,GAAGC,MAAM,CAACd,IAAI,CAACC,QAAL,CAAcc,MAAd,CAAqB,CAArB,CAAD,CAAnB;;AAEA,gBAAIL,OAAO,CAACM,YAAR,KAAyB,QAAzB,IAAqCH,MAAM,GAAG,CAAlD,EAAqD;AACjD,kBAAII,SAAS,GAAGvB,MAAM,CAAEmB,MAAM,KAAK,CAAX,GAClB,GADkB,GAElB,GAFgB,EAEVnI,OAAO,CAAC4G,MAFE,CAAtB;AAGA,qBAAQ,SAAS5G,OAAT,GAAmB,IAAnB,GAA0BuI,SAA1B,GAAsC,MAA9C;AACH,aALD,MAKO;AACH,qBAAO,SAASvB,MAAM,CAAC,GAAD,EAAMmB,MAAN,CAAf,GAA+B,GAA/B,GAAqCnI,OAArC,GAA+C,MAAtD;AACH;AACJ;AArBW,SAAhB;AAwBA4H,aAAK,CAACY,UAAN,GAAmB;AACfxH,gBAAM,EAAE,YADO;AAGf8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmB;AAC5BA,mBAAO,GAAGA,OAAO,CAAC8B,OAAR,CAAgB,YAAhB,EAA8B,EAA9B,CAAV;AACA9B,mBAAO,GAAGA,OAAO,CAAC8B,OAAR,CAAgB,KAAhB,EAAuB,IAAvB,CAAV;AACA,mBAAO,SAAS9B,OAAT,GAAmB,MAA1B;AACH;AAPc,SAAnB;AAUA4H,aAAK,CAACa,IAAN,GAAa;AACTzH,gBAAM,EAAE,CACJ,IADI,EACE,IADF,CADC;AAKT8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyB;AAClC,gBAAIoB,MAAM,GAAGpB,IAAI,CAACqB,UAAlB;;AACA,gBAAID,MAAM,CAACnB,QAAP,KAAoB,IAApB,IAA4BmB,MAAM,CAACE,gBAAP,KAA4BtB,IAA5D,EAAkE;AAC9D,qBAAO,OAAOtH,OAAd;AACH,aAFD,MAEO;AACH,qBAAO,SAASA,OAAT,GAAmB,MAA1B;AACH;AACJ;AAZQ,SAAb;AAeA4H,aAAK,CAACiB,QAAN,GAAiB;AACb7H,gBAAM,EAAE,IADK;AAGb8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3ChI,mBAAO,GAAGA,OAAO,CAAC8B,OAAR,CAAgB,MAAhB,EAAwB,EAAxB,EAA4B;AAA5B,aACLA,OADK,CACG,MADH,EACW,IADX,EACiB;AADjB,aAELA,OAFK,CAEG,MAFH,EAEW,QAFX,CAAV,CAD2C,CAGX;;AAChC,gBAAIgH,MAAM,GAAGd,OAAO,CAACe,gBAAR,GAA2B,KAAxC;AACA,gBAAIL,MAAM,GAAGpB,IAAI,CAACqB,UAAlB;;AACA,gBAAID,MAAM,CAACnB,QAAP,KAAoB,IAAxB,EAA8B;AAC1B,kBAAIyB,KAAK,GAAGN,MAAM,CAACO,YAAP,CAAoB,OAApB,CAAZ;AACA,kBAAIC,KAAK,GAAGnD,KAAK,CACZoD,SADO,CAEP9H,OAFO,CAGP+H,IAHO,CAGFV,MAAM,CAACW,QAHL,EAGe/B,IAHf,CAAZ;AAIAwB,oBAAM,GAAG,CAACE,KAAK,GACTZ,MAAM,CAACY,KAAD,CAAN,GAAgBE,KADP,GAETA,KAAK,GAAG,CAFL,IAEU,KAFnB;AAGH;;AACD,mBAAQJ,MAAM,GAAG9I,OAAT,IAAoBsH,IAAI,CAACgC,WAAL,IAAoB,CAAC,MAAMC,IAAN,CAAWvJ,OAAX,CAArB,GACtB,IADsB,GAEtB,EAFE,CAAR;AAGH;AAtBY,SAAjB;AAyBA4H,aAAK,CAAC4B,iBAAN,GAA0B;AACtBxI,gBAAM,EAAE,gBAAUsG,IAAV,EAAgBU,OAAhB,EAAyB;AAC7B,mBAAQA,OAAO,CAACyB,cAAR,KAA2B,UAA3B,IAAyCnC,IAAI,CAACC,QAAL,KAAkB,KAA3D,IAAoED,IAAI,CAACoC,UAAzE,IAAuFpC,IAAI,CAACoC,UAAL,CAAgBnC,QAAhB,KAA6B,MAA5H;AACH,WAHqB;AAKtBO,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3C,mBAAQ,aAAaV,IAAI,CAACoC,UAAL,CAAgBC,WAAhB,CAA4B7H,OAA5B,CAAoC,KAApC,EAA2C,QAA3C,CAAb,GAAoE,MAA5E;AACH;AAPqB,SAA1B;AAUA8F,aAAK,CAACgC,eAAN,GAAwB;AACpB5I,gBAAM,EAAE,gBAAUsG,IAAV,EAAgBU,OAAhB,EAAyB;AAC7B,mBAAQA,OAAO,CAACyB,cAAR,KAA2B,QAA3B,IAAuCnC,IAAI,CAACC,QAAL,KAAkB,KAAzD,IAAkED,IAAI,CAACoC,UAAvE,IAAqFpC,IAAI,CAACoC,UAAL,CAAgBnC,QAAhB,KAA6B,MAA1H;AACH,WAHmB;AAKpBO,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3C,gBAAI6B,SAAS,GAAGvC,IAAI,CAACoC,UAAL,CAAgBG,SAAhB,IAA6B,EAA7C;AACA,gBAAIrJ,QAAQ,GAAG,CAACqJ,SAAS,CAACC,KAAV,CAAgB,gBAAhB,KAAqC,CAAC,IAAD,EAAO,EAAP,CAAtC,EAAkD,CAAlD,CAAf;AAEA,mBAAQ,SAAS9B,OAAO,CAAC+B,KAAjB,GAAyBvJ,QAAzB,GAAoC,IAApC,GAA2C8G,IAAI,CAACoC,UAAL,CAAgBC,WAA3D,GAAyE,IAAzE,GAAgF3B,OAAO,CAAC+B,KAAxF,GAAgG,MAAxG;AACH;AAVmB,SAAxB;AAaAnC,aAAK,CAACoC,cAAN,GAAuB;AACnBhJ,gBAAM,EAAE,IADW;AAGnB8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3C,mBAAO,SAASA,OAAO,CAACiC,EAAjB,GAAsB,MAA7B;AACH;AALkB,SAAvB;AAQArC,aAAK,CAACsC,UAAN,GAAmB;AACflJ,gBAAM,EAAE,gBAAUsG,IAAV,EAAgBU,OAAhB,EAAyB;AAC7B,mBAAQA,OAAO,CAACmC,SAAR,KAAsB,SAAtB,IAAmC7C,IAAI,CAACC,QAAL,KAAkB,GAArD,IAA4DD,IAAI,CAAC2B,YAAL,CAAkB,MAAlB,CAApE;AACH,WAHc;AAKfnB,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyB;AAClC,gBAAI8C,IAAI,GAAG9C,IAAI,CAAC2B,YAAL,CAAkB,MAAlB,CAAX;AACA,gBAAIoB,KAAK,GAAG/C,IAAI,CAAC+C,KAAL,GACN,OAAO/C,IAAI,CAAC+C,KAAZ,GAAoB,GADd,GAEN,EAFN;AAGA,mBAAO,MAAMrK,OAAN,GAAgB,IAAhB,GAAuBoK,IAAvB,GAA8BC,KAA9B,GAAsC,GAA7C;AACH;AAXc,SAAnB;AAcAzC,aAAK,CAAC0C,aAAN,GAAsB;AAClBtJ,gBAAM,EAAE,gBAAUsG,IAAV,EAAgBU,OAAhB,EAAyB;AAC7B,mBAAQA,OAAO,CAACmC,SAAR,KAAsB,YAAtB,IAAsC7C,IAAI,CAACC,QAAL,KAAkB,GAAxD,IAA+DD,IAAI,CAAC2B,YAAL,CAAkB,MAAlB,CAAvE;AACH,WAHiB;AAKlBnB,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3C,gBAAIoC,IAAI,GAAG9C,IAAI,CAAC2B,YAAL,CAAkB,MAAlB,CAAX;AACA,gBAAIoB,KAAK,GAAG/C,IAAI,CAAC+C,KAAL,GACN,OAAO/C,IAAI,CAAC+C,KAAZ,GAAoB,GADd,GAEN,EAFN;AAGA,gBAAIvC,WAAJ;AACA,gBAAIyC,SAAJ;;AAEA,oBAAQvC,OAAO,CAACwC,kBAAhB;AACI,mBAAK,WAAL;AACI1C,2BAAW,GAAG,MAAM9H,OAAN,GAAgB,KAA9B;AACAuK,yBAAS,GAAG,MAAMvK,OAAN,GAAgB,KAAhB,GAAwBoK,IAAxB,GAA+BC,KAA3C;AACA;;AACJ,mBAAK,UAAL;AACIvC,2BAAW,GAAG,MAAM9H,OAAN,GAAgB,GAA9B;AACAuK,yBAAS,GAAG,MAAMvK,OAAN,GAAgB,KAAhB,GAAwBoK,IAAxB,GAA+BC,KAA3C;AACA;;AACJ;AACI,oBAAItM,EAAE,GAAG,KAAK0M,UAAL,CAAgB7D,MAAhB,GAAyB,CAAlC;AACAkB,2BAAW,GAAG,MAAM9H,OAAN,GAAgB,IAAhB,GAAuBjC,EAAvB,GAA4B,GAA1C;AACAwM,yBAAS,GAAG,MAAMxM,EAAN,GAAW,KAAX,GAAmBqM,IAAnB,GAA0BC,KAAtC;AAZR;;AAeA,iBACKI,UADL,CAEKC,IAFL,CAEUH,SAFV;AAGA,mBAAOzC,WAAP;AACH,WAhCiB;AAkClB2C,oBAAU,EAAE,EAlCM;AAoClBE,gBAAM,EAAE,gBAAU3C,OAAV,EAAmB;AACvB,gBAAIyC,UAAU,GAAG,EAAjB;;AACA,gBAAI,KAAKA,UAAL,CAAgB7D,MAApB,EAA4B;AACxB6D,wBAAU,GAAG,SAAS,KACjBA,UADiB,CAEjBtD,IAFiB,CAEZ,IAFY,CAAT,GAEK,MAFlB;AAGA,mBAAKsD,UAAL,GAAkB,EAAlB,CAJwB,CAIF;AACzB;;AACD,mBAAOA,UAAP;AACH;AA7CiB,SAAtB;AAgDA7C,aAAK,CAACgD,QAAN,GAAiB;AACb5J,gBAAM,EAAE,CACJ,IADI,EACE,GADF,CADK;AAKb8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3C,gBAAI,CAAChI,OAAO,CAAC6K,IAAR,EAAL,EACI,OAAO,EAAP;AACJ,mBAAO7C,OAAO,CAAC8C,WAAR,GAAsB9K,OAAtB,GAAgCgI,OAAO,CAAC8C,WAA/C;AACH;AATY,SAAjB;AAYAlD,aAAK,CAACmD,MAAN,GAAe;AACX/J,gBAAM,EAAE,CACJ,QADI,EACM,GADN,CADG;AAKX8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyBU,OAAzB,EAAkC;AAC3C,gBAAI,CAAChI,OAAO,CAAC6K,IAAR,EAAL,EACI,OAAO,EAAP;AACJ,mBAAO7C,OAAO,CAACgD,eAAR,GAA0BhL,OAA1B,GAAoCgI,OAAO,CAACgD,eAAnD;AACH;AATU,SAAf;AAYApD,aAAK,CAACqD,IAAN,GAAa;AACTjK,gBAAM,EAAE,gBAAUsG,IAAV,EAAgB;AACpB,gBAAI4D,WAAW,GAAG5D,IAAI,CAAC6D,eAAL,IAAwB7D,IAAI,CAACgC,WAA/C;AACA,gBAAI8B,WAAW,GAAG9D,IAAI,CAACqB,UAAL,CAAgBpB,QAAhB,KAA6B,KAA7B,IAAsC,CAAC2D,WAAzD;AAEA,mBAAO5D,IAAI,CAACC,QAAL,KAAkB,MAAlB,IAA4B,CAAC6D,WAApC;AACH,WANQ;AAQTtD,qBAAW,EAAE,qBAAU9H,OAAV,EAAmB;AAC5B,gBAAI,CAACA,OAAO,CAAC6K,IAAR,EAAL,EACI,OAAO,EAAP;AAEJ,gBAAIQ,SAAS,GAAG,GAAhB;AACA,gBAAIC,YAAY,GAAG,EAAnB;AACA,gBAAIC,aAAa,GAAG,EAApB;AACA,gBAAIC,OAAO,GAAGxL,OAAO,CAAC8J,KAAR,CAAc,MAAd,CAAd;;AACA,gBAAI0B,OAAJ,EAAa;AACT,kBAAI,KAAKjC,IAAL,CAAUvJ,OAAV,CAAJ,EACIsL,YAAY,GAAG,GAAf;AACJ,kBAAI,KAAK/B,IAAL,CAAUvJ,OAAV,CAAJ,EACIuL,aAAa,GAAG,GAAhB;;AACJ,qBAAOC,OAAO,CAACnK,OAAR,CAAgBgK,SAAhB,MAA+B,CAAC,CAAvC;AACIA,yBAAS,GAAGA,SAAS,GAAG,GAAxB;AADJ;AAEC;;AAEL,mBAAOA,SAAS,GAAGC,YAAZ,GAA2BtL,OAA3B,GAAqCuL,aAArC,GAAqDF,SAA5D;AACH;AA1BQ,SAAb;AA6BAzD,aAAK,CAAC6D,KAAN,GAAc;AACVzK,gBAAM,EAAE,KADE;AAGV8G,qBAAW,EAAE,qBAAU9H,OAAV,EAAmBsH,IAAnB,EAAyB;AAClC,gBAAIoE,GAAG,GAAGpE,IAAI,CAACoE,GAAL,IAAY,EAAtB;AACA,gBAAIC,GAAG,GAAGrE,IAAI,CAAC2B,YAAL,CAAkB,KAAlB,KAA4B,EAAtC;AACA,gBAAIoB,KAAK,GAAG/C,IAAI,CAAC+C,KAAL,IAAc,EAA1B;AACA,gBAAIuB,SAAS,GAAGvB,KAAK,GACf,OAAOA,KAAP,GAAe,GADA,GAEf,EAFN;AAGA,mBAAOsB,GAAG,GACJ,OAAOD,GAAP,GAAa,IAAb,GAAoBC,GAApB,GAA0BC,SAA1B,GAAsC,GADlC,GAEJ,EAFN;AAGH;AAbS,SAAd;AAgBA;;;;AAIA,iBAASC,KAAT,CAAe7D,OAAf,EAAwB;AACpB,eAAKA,OAAL,GAAeA,OAAf;AACA,eAAK8D,KAAL,GAAa,EAAb;AACA,eAAKC,OAAL,GAAe,EAAf;AAEA,eAAKC,SAAL,GAAiB;AACblE,uBAAW,EAAEE,OAAO,CAACiE;AADR,WAAjB;AAIA,eAAKC,eAAL,GAAuBlE,OAAO,CAACkE,eAA/B;AAEA,eAAKC,WAAL,GAAmB;AACfrE,uBAAW,EAAEE,OAAO,CAACoE;AADN,WAAnB;AAIA,eAAKC,KAAL,GAAa,EAAb;;AACA,eAAK,IAAIvF,GAAT,IAAgBkB,OAAO,CAACJ,KAAxB;AACI,iBAAKyE,KAAL,CAAW3B,IAAX,CAAgB1C,OAAO,CAACJ,KAAR,CAAcd,GAAd,CAAhB;AADJ;AAEC;;AAEL+E,aAAK,CAAC1C,SAAN,GAAkB;AACd5L,aAAG,EAAE,aAAUuJ,GAAV,EAAewF,IAAf,EAAqB;AACtB,iBACKD,KADL,CAEKE,OAFL,CAEaD,IAFb;AAGH,WALa;AAOdE,cAAI,EAAE,cAAUxL,MAAV,EAAkB;AACpB,iBACK8K,KADL,CAEKS,OAFL,CAEa;AAACvL,oBAAM,EAAEA,MAAT;AAAiB8G,yBAAW,EAAE,KAAKoE;AAAnC,aAFb;AAGH,WAXa;AAadO,gBAAM,EAAE,gBAAUzL,MAAV,EAAkB;AACtB,iBACK+K,OADL,CAEKQ,OAFL,CAEa;AACLvL,oBAAM,EAAEA,MADH;AAEL8G,yBAAW,EAAE,uBAAY;AACrB,uBAAO,EAAP;AACH;AAJI,aAFb;AAQH,WAtBa;AAwBd4E,iBAAO,EAAE,iBAAUpF,IAAV,EAAgB;AACrB,gBAAIA,IAAI,CAACqF,OAAT,EACI,OAAO,KAAKX,SAAZ;AACJ,gBAAIM,IAAJ;AAEA,gBAAKA,IAAI,GAAGM,QAAQ,CAAC,KAAKP,KAAN,EAAa/E,IAAb,EAAmB,KAAKU,OAAxB,CAApB,EACI,OAAOsE,IAAP;AACJ,gBAAKA,IAAI,GAAGM,QAAQ,CAAC,KAAKd,KAAN,EAAaxE,IAAb,EAAmB,KAAKU,OAAxB,CAApB,EACI,OAAOsE,IAAP;AACJ,gBAAKA,IAAI,GAAGM,QAAQ,CAAC,KAAKb,OAAN,EAAezE,IAAf,EAAqB,KAAKU,OAA1B,CAApB,EACI,OAAOsE,IAAP;AAEJ,mBAAO,KAAKH,WAAZ;AACH,WArCa;AAuCdU,iBAAO,EAAE,iBAAUC,EAAV,EAAc;AACnB,iBAAK,IAAI5O,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKmO,KAAL,CAAWzF,MAA/B,EAAuC1I,CAAC,EAAxC;AACI4O,gBAAE,CAAC,KAAKT,KAAL,CAAWnO,CAAX,CAAD,EAAgBA,CAAhB,CAAF;AADJ;AAEC;AA1CS,SAAlB;;AA6CA,iBAAS0O,QAAT,CAAkBhF,KAAlB,EAAyBN,IAAzB,EAA+BU,OAA/B,EAAwC;AACpC,eAAK,IAAI9J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0J,KAAK,CAAChB,MAA1B,EAAkC1I,CAAC,EAAnC,EAAuC;AACnC,gBAAIoO,IAAI,GAAG1E,KAAK,CAAC1J,CAAD,CAAhB;AACA,gBAAI6O,WAAW,CAACT,IAAD,EAAOhF,IAAP,EAAaU,OAAb,CAAf,EACI,OAAOsE,IAAP;AACP;;AACD,iBAAO,KAAK,CAAZ;AACH;;AAED,iBAASS,WAAT,CAAqBT,IAArB,EAA2BhF,IAA3B,EAAiCU,OAAjC,EAA0C;AACtC,cAAIhH,MAAM,GAAGsL,IAAI,CAACtL,MAAlB;;AACA,cAAI,OAAOA,MAAP,KAAkB,QAAtB,EAAgC;AAC5B,gBAAIA,MAAM,KAAKsG,IAAI,CAACC,QAAL,CAAc1F,WAAd,EAAf,EACI,OAAO,IAAP;AACP,WAHD,MAGO,IAAIkE,KAAK,CAACC,OAAN,CAAchF,MAAd,CAAJ,EAA2B;AAC9B,gBAAIA,MAAM,CAACK,OAAP,CAAeiG,IAAI,CAACC,QAAL,CAAc1F,WAAd,EAAf,IAA8C,CAAC,CAAnD,EACI,OAAO,IAAP;AACP,WAHM,MAGA,IAAI,OAAOb,MAAP,KAAkB,UAAtB,EAAkC;AACrC,gBAAIA,MAAM,CAACoI,IAAP,CAAYkD,IAAZ,EAAkBhF,IAAlB,EAAwBU,OAAxB,CAAJ,EACI,OAAO,IAAP;AACP,WAHM,MAGA;AACH,kBAAM,IAAIgF,SAAJ,CAAc,mDAAd,CAAN;AACH;AACJ;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;;;;;;;AAKA,iBAASC,kBAAT,CAA4BjF,OAA5B,EAAqC;AACjC,cAAIkF,OAAO,GAAGlF,OAAO,CAACkF,OAAtB;AACA,cAAI7F,OAAO,GAAGW,OAAO,CAACX,OAAtB;AACA,cAAII,MAAM,GAAGO,OAAO,CAACP,MAArB;;AACA,cAAI0F,KAAK,GAAGnF,OAAO,CAACmF,KAAR,IAAiB,UAAU7F,IAAV,EAAgB;AACzC,mBAAOA,IAAI,CAACC,QAAL,KAAkB,KAAzB;AACH,WAFD;;AAIA,cAAI,CAAC2F,OAAO,CAACxD,UAAT,IAAuByD,KAAK,CAACD,OAAD,CAAhC,EACI;AAEJ,cAAIE,QAAQ,GAAG,IAAf;AACA,cAAIC,QAAQ,GAAG,KAAf;AAEA,cAAIC,IAAI,GAAG,IAAX;AACA,cAAIhG,IAAI,GAAGiG,IAAI,CAACD,IAAD,EAAOJ,OAAP,EAAgBC,KAAhB,CAAf;;AAEA,iBAAO7F,IAAI,KAAK4F,OAAhB,EAAyB;AACrB,gBAAI5F,IAAI,CAACkG,QAAL,KAAkB,CAAlB,IAAuBlG,IAAI,CAACkG,QAAL,KAAkB,CAA7C,EAAgD;AAAE;AAC9C,kBAAIC,IAAI,GAAGnG,IAAI,CACV/D,IADM,CAENzB,OAFM,CAEE,aAFF,EAEiB,GAFjB,CAAX;;AAIA,kBAAI,CAAC,CAACsL,QAAD,IAAa,KAAK7D,IAAL,CAAU6D,QAAQ,CAAC7J,IAAnB,CAAd,KAA2C,CAAC8J,QAA5C,IAAwDI,IAAI,CAAC,CAAD,CAAJ,KAAY,GAAxE,EAA6E;AACzEA,oBAAI,GAAGA,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAP;AACH,eAP2C,CAS5C;;;AACA,kBAAI,CAACD,IAAL,EAAW;AACPnG,oBAAI,GAAGmF,MAAM,CAACnF,IAAD,CAAb;AACA;AACH;;AAEDA,kBAAI,CAAC/D,IAAL,GAAYkK,IAAZ;AAEAL,sBAAQ,GAAG9F,IAAX;AACH,aAlBD,MAkBO,IAAIA,IAAI,CAACkG,QAAL,KAAkB,CAAtB,EAAyB;AAAE;AAC9B,kBAAInG,OAAO,CAACC,IAAD,CAAP,IAAiBA,IAAI,CAACC,QAAL,KAAkB,IAAvC,EAA6C;AACzC,oBAAI6F,QAAJ,EAAc;AACVA,0BAAQ,CAAC7J,IAAT,GAAgB6J,QAAQ,CACnB7J,IADW,CAEXzB,OAFW,CAEH,IAFG,EAEG,EAFH,CAAhB;AAGH;;AAEDsL,wBAAQ,GAAG,IAAX;AACAC,wBAAQ,GAAG,KAAX;AACH,eATD,MASO,IAAI5F,MAAM,CAACH,IAAD,CAAV,EAAkB;AACrB;AACA8F,wBAAQ,GAAG,IAAX;AACAC,wBAAQ,GAAG,IAAX;AACH;AACJ,aAfM,MAeA;AACH/F,kBAAI,GAAGmF,MAAM,CAACnF,IAAD,CAAb;AACA;AACH;;AAED,gBAAIqG,QAAQ,GAAGJ,IAAI,CAACD,IAAD,EAAOhG,IAAP,EAAa6F,KAAb,CAAnB;AACAG,gBAAI,GAAGhG,IAAP;AACAA,gBAAI,GAAGqG,QAAP;AACH;;AAED,cAAIP,QAAJ,EAAc;AACVA,oBAAQ,CAAC7J,IAAT,GAAgB6J,QAAQ,CACnB7J,IADW,CAEXzB,OAFW,CAEH,IAFG,EAEG,EAFH,CAAhB;;AAGA,gBAAI,CAACsL,QAAQ,CAAC7J,IAAd,EAAoB;AAChBkJ,oBAAM,CAACW,QAAD,CAAN;AACH;AACJ;AACJ;AAED;;;;;;;;;AAOA,iBAASX,MAAT,CAAgBnF,IAAhB,EAAsB;AAClB,cAAIiG,IAAI,GAAGjG,IAAI,CAACgC,WAAL,IAAoBhC,IAAI,CAACqB,UAApC;AAEArB,cAAI,CACCqB,UADL,CAEKiF,WAFL,CAEiBtG,IAFjB;AAIA,iBAAOiG,IAAP;AACH;AAED;;;;;;;;;;;AASA,iBAASA,IAAT,CAAcD,IAAd,EAAoBO,OAApB,EAA6BV,KAA7B,EAAoC;AAChC,cAAKG,IAAI,IAAIA,IAAI,CAAC3E,UAAL,KAAoBkF,OAA7B,IAAyCV,KAAK,CAACU,OAAD,CAAlD,EAA6D;AACzD,mBAAOA,OAAO,CAACvE,WAAR,IAAuBuE,OAAO,CAAClF,UAAtC;AACH;;AAED,iBAAOkF,OAAO,CAACnE,UAAR,IAAsBmE,OAAO,CAACvE,WAA9B,IAA6CuE,OAAO,CAAClF,UAA5D;AACH;AAED;;;;;AAIA,YAAImF,IAAI,GAAI,OAAOvN,MAAP,KAAkB,WAAlB,GACNA,MADM,GAEN,EAFN;AAIA;;;;AAIA,iBAASwN,oBAAT,GAAgC;AAC5B,cAAIC,MAAM,GAAGF,IAAI,CAACG,SAAlB;AACA,cAAIC,QAAQ,GAAG,KAAf,CAF4B,CAI5B;AACA;;AACA,cAAI;AACA;AACA,gBAAI,IAAIF,MAAJ,GAAaG,eAAb,CAA6B,EAA7B,EAAiC,WAAjC,CAAJ,EAAmD;AAC/CD,sBAAQ,GAAG,IAAX;AACH;AACJ,WALD,CAKE,OAAOpK,CAAP,EAAU,CAAE;;AAEd,iBAAOoK,QAAP;AACH;;AAED,iBAASE,gBAAT,GAA4B;AACxB,cAAIJ,MAAM,GAAG,SAATA,MAAS,GAAY,CAAE,CAA3B;;AAEA;AACI,gBAAIK,gBAAgB,EAApB,EAAwB;AACpBL,oBAAM,CAAC7E,SAAP,CAAiBgF,eAAjB,GAAmC,UAAUvM,MAAV,EAAkB;AACjD,oBAAI0M,GAAG,GAAG,IAAI/N,MAAM,CAACgO,aAAX,CAAyB,UAAzB,CAAV;AACAD,mBAAG,CAACE,UAAJ,GAAiB,IAAjB,CAFiD,CAE1B;;AACvBF,mBAAG,CAACG,IAAJ;AACAH,mBAAG,CAACI,KAAJ,CAAU9M,MAAV;AACA0M,mBAAG,CAACK,KAAJ;AACA,uBAAOL,GAAP;AACH,eAPD;AAQH,aATD,MASO;AACHN,oBAAM,CAAC7E,SAAP,CAAiBgF,eAAjB,GAAmC,UAAUvM,MAAV,EAAkB;AACjD,oBAAI0M,GAAG,GAAG5M,QAAQ,CACbkN,cADK,CAELC,kBAFK,CAEc,EAFd,CAAV;AAGAP,mBAAG,CAACG,IAAJ;AACAH,mBAAG,CAACI,KAAJ,CAAU9M,MAAV;AACA0M,mBAAG,CAACK,KAAJ;AACA,uBAAOL,GAAP;AACH,eARD;AASH;AACJ;AACD,iBAAON,MAAP;AACH;;AAED,iBAASK,gBAAT,GAA4B;AACxB,cAAIS,UAAU,GAAG,KAAjB;;AACA,cAAI;AACApN,oBAAQ,CACHkN,cADL,CAEKC,kBAFL,CAEwB,EAFxB,EAGKJ,IAHL;AAIH,WALD,CAKE,OAAO3K,CAAP,EAAU;AACR,gBAAIvD,MAAM,CAACgO,aAAX,EACIO,UAAU,GAAG,IAAb;AACH;;AACL,iBAAOA,UAAP;AACH;;AAED,YAAIC,UAAU,GAAGhB,oBAAoB,KAC/BD,IAAI,CAACG,SAD0B,GAE/BG,gBAAgB,EAFtB;;AAIA,iBAASY,QAAT,CAAkBC,KAAlB,EAAyB;AACrB,cAAInB,IAAJ;;AACA,cAAI,OAAOmB,KAAP,KAAiB,QAArB,EAA+B;AAC3B,gBAAIX,GAAG,GAAGY,UAAU,GAAGf,eAAb,EACV;AACA;AACA,gDAAoCc,KAApC,GAA4C,eAHlC,EAIV,WAJU,CAAV;AAKAnB,gBAAI,GAAGQ,GAAG,CAACa,cAAJ,CAAmB,eAAnB,CAAP;AACH,WAPD,MAOO;AACHrB,gBAAI,GAAGmB,KAAK,CAACG,SAAN,CAAgB,IAAhB,CAAP;AACH;;AACDnC,4BAAkB,CAAC;AAACC,mBAAO,EAAEY,IAAV;AAAgBzG,mBAAO,EAAEA,OAAzB;AAAkCI,kBAAM,EAAEA;AAA1C,WAAD,CAAlB;AAEA,iBAAOqG,IAAP;AACH;;AAED,YAAIuB,WAAJ;;AACA,iBAASH,UAAT,GAAsB;AAClBG,qBAAW,GAAGA,WAAW,IAAI,IAAIN,UAAJ,EAA7B;AACA,iBAAOM,WAAP;AACH;;AAED,iBAASC,IAAT,CAAchI,IAAd,EAAoB;AAChBA,cAAI,CAACD,OAAL,GAAeA,OAAO,CAACC,IAAD,CAAtB;AACAA,cAAI,CAACiI,MAAL,GAAcjI,IAAI,CACbC,QADS,CAET1F,WAFS,OAES,MAFT,IAEmByF,IAAI,CAACqB,UAAL,CAAgB4G,MAFjD;AAGAjI,cAAI,CAACqF,OAAL,GAAeA,OAAO,CAACrF,IAAD,CAAtB;AACAA,cAAI,CAACkI,kBAAL,GAA0BA,kBAAkB,CAAClI,IAAD,CAA5C;AACA,iBAAOA,IAAP;AACH;;AAED,iBAASqF,OAAT,CAAiBrF,IAAjB,EAAuB;AACnB,iBAAQ,CACJ,GADI,EAEJ,IAFI,EAGJ,IAHI,EAIJ,QAJI,EAKJ,QALI,EAMJ,OANI,EAOJ,OAPI,EAQNjG,OARM,CAQEiG,IAAI,CAACC,QARP,MAQqB,CAAC,CARtB,IAQ2B,SAASgC,IAAT,CAAcjC,IAAI,CAACqC,WAAnB,CAR3B,IAQ8D,CAAClC,MAAM,CAACH,IAAD,CARrE,IAQ+E,CAACK,OAAO,CAACL,IAAD,CAR/F;AASH;;AAED,iBAASkI,kBAAT,CAA4BlI,IAA5B,EAAkC;AAC9B,cAAImI,OAAO,GAAG,EAAd;AACA,cAAIC,QAAQ,GAAG,EAAf;;AAEA,cAAI,CAACpI,IAAI,CAACD,OAAV,EAAmB;AACf,gBAAIsI,UAAU,GAAG,aAAapG,IAAb,CAAkBjC,IAAI,CAACqC,WAAvB,CAAjB;AACA,gBAAIiG,WAAW,GAAG,aAAarG,IAAb,CAAkBjC,IAAI,CAACqC,WAAvB,CAAlB;;AAEA,gBAAIgG,UAAU,IAAI,CAACE,qBAAqB,CAAC,MAAD,EAASvI,IAAT,CAAxC,EAAwD;AACpDmI,qBAAO,GAAG,GAAV;AACH;;AACD,gBAAIG,WAAW,IAAI,CAACC,qBAAqB,CAAC,OAAD,EAAUvI,IAAV,CAAzC,EAA0D;AACtDoI,sBAAQ,GAAG,GAAX;AACH;AACJ;;AAED,iBAAO;AAACD,mBAAO,EAAEA,OAAV;AAAmBC,oBAAQ,EAAEA;AAA7B,WAAP;AACH;;AAED,iBAASG,qBAAT,CAA+BC,IAA/B,EAAqCxI,IAArC,EAA2C;AACvC,cAAIyI,OAAJ;AACA,cAAIC,MAAJ;AACA,cAAIC,SAAJ;;AAEA,cAAIH,IAAI,KAAK,MAAb,EAAqB;AACjBC,mBAAO,GAAGzI,IAAI,CAAC6D,eAAf;AACA6E,kBAAM,GAAG,IAAT;AACH,WAHD,MAGO;AACHD,mBAAO,GAAGzI,IAAI,CAACgC,WAAf;AACA0G,kBAAM,GAAG,IAAT;AACH;;AAED,cAAID,OAAJ,EAAa;AACT,gBAAIA,OAAO,CAACvC,QAAR,KAAqB,CAAzB,EAA4B;AACxByC,uBAAS,GAAGD,MAAM,CAACzG,IAAP,CAAYwG,OAAO,CAACG,SAApB,CAAZ;AACH,aAFD,MAEO,IAAIH,OAAO,CAACvC,QAAR,KAAqB,CAArB,IAA0B,CAACnG,OAAO,CAAC0I,OAAD,CAAtC,EAAiD;AACpDE,uBAAS,GAAGD,MAAM,CAACzG,IAAP,CAAYwG,OAAO,CAACpG,WAApB,CAAZ;AACH;AACJ;;AACD,iBAAOsG,SAAP;AACH;;AAED,YAAIE,MAAM,GAAGpK,KAAK,CAACoD,SAAN,CAAgBgH,MAA7B;AACA,YAAIC,qBAAqB,GAAG,MAA5B;AACA,YAAIC,sBAAsB,GAAG,MAA7B;AACA,YAAIC,OAAO,GAAG,CACV,CACI,KADJ,EACW,MADX,CADU,EAIV,CACI,KADJ,EACW,KADX,CAJU,EAOV,CACI,KADJ,EACW,KADX,CAPU,EAUV,CACI,OADJ,EACa,MADb,CAVU,EAaV,CACI,QADJ,EACc,MADd,CAbU,EAgBV,CACI,aADJ,EACmB,OADnB,CAhBU,EAmBV,CACI,IADJ,EACU,KADV,CAnBU,EAsBV,CACI,OADJ,EACa,OADb,CAtBU,EAyBV,CACI,KADJ,EACW,KADX,CAzBU,EA4BV,CACI,KADJ,EACW,KADX,CA5BU,EA+BV,CACI,KADJ,EACW,KADX,CA/BU,EAkCV,CACI,IADJ,EACU,KADV,CAlCU,EAqCV,CAAC,YAAD,EAAe,QAAf,CArCU,CAAd;;AAwCA,iBAAS9J,eAAT,CAAyBwB,OAAzB,EAAkC;AAC9B,cAAI,EAAE,gBAAgBxB,eAAlB,CAAJ,EACI,OAAO,IAAIA,eAAJ,CAAoBwB,OAApB,CAAP;AAEJ,cAAIuI,QAAQ,GAAG;AACX3I,iBAAK,EAAEA,KADI;AAEXU,wBAAY,EAAE,QAFH;AAGX2B,cAAE,EAAE,OAHO;AAIXlB,4BAAgB,EAAE,GAJP;AAKXU,0BAAc,EAAE,UALL;AAMXM,iBAAK,EAAE,KANI;AAOXe,uBAAW,EAAE,GAPF;AAQXE,2BAAe,EAAE,IARN;AASXb,qBAAS,EAAE,SATA;AAUXK,8BAAkB,EAAE,MAVT;AAWXvC,cAAE,EAAE,IAXO;AAYXgE,4BAAgB,EAAE,0BAAUjM,OAAV,EAAmBsH,IAAnB,EAAyB;AACvC,qBAAOA,IAAI,CAACD,OAAL,GACD,MADC,GAED,EAFN;AAGH,aAhBU;AAiBX6E,2BAAe,EAAE,yBAAUlM,OAAV,EAAmBsH,IAAnB,EAAyB;AACtC,qBAAOA,IAAI,CAACD,OAAL,GACD,SAASC,IAAI,CAACkJ,SAAd,GAA0B,MADzB,GAEDlJ,IAAI,CAACkJ,SAFX;AAGH,aArBU;AAsBXpE,8BAAkB,EAAE,4BAAUpM,OAAV,EAAmBsH,IAAnB,EAAyB;AACzC,qBAAOA,IAAI,CAACD,OAAL,GACD,SAASrH,OAAT,GAAmB,MADlB,GAEDA,OAFN;AAGH;AA1BU,WAAf;AA4BA,eAAKgI,OAAL,GAAevB,MAAM,CAAC,EAAD,EAAK8J,QAAL,EAAevI,OAAf,CAArB;AACA,eAAKJ,KAAL,GAAa,IAAIiE,KAAJ,CAAU,KAAK7D,OAAf,CAAb;AACH;;AAEDxB,uBAAe,CAAC2C,SAAhB,GAA4B;AACxB;;;;;;;AAQAsH,kBAAQ,EAAE,kBAAUxB,KAAV,EAAiB;AACvB,gBAAI,CAACyB,UAAU,CAACzB,KAAD,CAAf,EAAwB;AACpB,oBAAM,IAAIjC,SAAJ,CAAciC,KAAK,GAAG,yDAAtB,CAAN;AACH;;AAED,gBAAIA,KAAK,KAAK,EAAd,EACI,OAAO,EAAP;AAEJ,gBAAInK,MAAM,GAAG6L,OAAO,CAACvH,IAAR,CAAa,IAAb,EAAmB,IAAI4F,QAAJ,CAAaC,KAAb,CAAnB,CAAb;AACA,mBAAO2B,WAAW,CAACxH,IAAZ,CAAiB,IAAjB,EAAuBtE,MAAvB,CAAP;AACH,WAnBuB;;AAqBxB;;;;;;;AAQA+L,aAAG,EAAE,aAAUC,MAAV,EAAkB;AACnB,gBAAI/K,KAAK,CAACC,OAAN,CAAc8K,MAAd,CAAJ,EAA2B;AACvB,mBAAK,IAAI5S,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4S,MAAM,CAAClK,MAA3B,EAAmC1I,CAAC,EAApC;AACI,qBAAK2S,GAAL,CAASC,MAAM,CAAC5S,CAAD,CAAf;AADJ;AAEC,aAHL,MAIK,IAAI,OAAO4S,MAAP,KAAkB,UAAtB,EAAkC;AACnCA,oBAAM,CAAC,IAAD,CAAN;AACH,aAFI,MAEE;AACH,oBAAM,IAAI9D,SAAJ,CAAc,oDAAd,CAAN;AACH;;AACD,mBAAO,IAAP;AACH,WAxCuB;;AA0CxB;;;;;;;;AASA+D,iBAAO,EAAE,iBAAUjK,GAAV,EAAewF,IAAf,EAAqB;AAC1B,iBACK1E,KADL,CAEKrK,GAFL,CAESuJ,GAFT,EAEcwF,IAFd;AAGA,mBAAO,IAAP;AACH,WAxDuB;;AA0DxB;;;;;;;AAQAE,cAAI,EAAE,cAAUxL,MAAV,EAAkB;AACpB,iBACK4G,KADL,CAEK4E,IAFL,CAEUxL,MAFV;AAGA,mBAAO,IAAP;AACH,WAvEuB;;AAyExB;;;;;;;AAQAyL,gBAAM,EAAE,gBAAUzL,MAAV,EAAkB;AACtB,iBACK4G,KADL,CAEK6E,MAFL,CAEYzL,MAFZ;AAGA,mBAAO,IAAP;AACH,WAtFuB;;AAwFxB;;;;;;;AAQAgQ,gBAAM,EAAE,gBAAUpP,MAAV,EAAkB;AACtB,mBAAO0O,OAAO,CAACH,MAAR,CAAe,UAAUc,WAAV,EAAuBD,MAAvB,EAA+B;AACjD,qBAAOC,WAAW,CAACnP,OAAZ,CAAoBkP,MAAM,CAAC,CAAD,CAA1B,EAA+BA,MAAM,CAAC,CAAD,CAArC,CAAP;AACH,aAFM,EAEJpP,MAFI,CAAP;AAGH;AApGuB,SAA5B;AAuGA;;;;;;;;AAQA,iBAAS+O,OAAT,CAAiBhI,UAAjB,EAA6B;AACzB,cAAIuI,IAAI,GAAG,IAAX;AACA,iBAAOf,MAAM,CAAC/G,IAAP,CAAYT,UAAU,CAACwI,UAAvB,EAAmC,UAAUrM,MAAV,EAAkBwC,IAAlB,EAAwB;AAC9DA,gBAAI,GAAG,IAAIgI,IAAJ,CAAShI,IAAT,CAAP;AAEA,gBAAIQ,WAAW,GAAG,EAAlB;;AACA,gBAAIR,IAAI,CAACkG,QAAL,KAAkB,CAAtB,EAAyB;AACrB1F,yBAAW,GAAGR,IAAI,CAACiI,MAAL,GACRjI,IAAI,CAAC4I,SADG,GAERgB,IAAI,CAACF,MAAL,CAAY1J,IAAI,CAAC4I,SAAjB,CAFN;AAGH,aAJD,MAIO,IAAI5I,IAAI,CAACkG,QAAL,KAAkB,CAAtB,EAAyB;AAC5B1F,yBAAW,GAAGsJ,kBAAkB,CAAChI,IAAnB,CAAwB8H,IAAxB,EAA8B5J,IAA9B,CAAd;AACH;;AAED,mBAAOH,IAAI,CAACrC,MAAD,EAASgD,WAAT,CAAX;AACH,WAbM,EAaJ,EAbI,CAAP;AAcH;AAED;;;;;;;;;AAQA,iBAAS8I,WAAT,CAAqB9L,MAArB,EAA6B;AACzB,cAAIoM,IAAI,GAAG,IAAX;AACA,eACKtJ,KADL,CAEKiF,OAFL,CAEa,UAAUP,IAAV,EAAgB;AACrB,gBAAI,OAAOA,IAAI,CAAC3B,MAAZ,KAAuB,UAA3B,EAAuC;AACnC7F,oBAAM,GAAGqC,IAAI,CAACrC,MAAD,EAASwH,IAAI,CAAC3B,MAAL,CAAYuG,IAAI,CAAClJ,OAAjB,CAAT,CAAb;AACH;AACJ,WANL;AAQA,iBAAOlD,MAAM,CACRhD,OADE,CACM,YADN,EACoB,EADpB,EAEFA,OAFE,CAEM,cAFN,EAEsB,EAFtB,CAAP;AAGH;AAED;;;;;;;;;AAQA,iBAASsP,kBAAT,CAA4B9J,IAA5B,EAAkC;AAC9B,cAAIgF,IAAI,GAAG,KACN1E,KADM,CAEN8E,OAFM,CAEEpF,IAFF,CAAX;AAGA,cAAItH,OAAO,GAAG2Q,OAAO,CAACvH,IAAR,CAAa,IAAb,EAAmB9B,IAAnB,CAAd;AACA,cAAI+J,UAAU,GAAG/J,IAAI,CAACkI,kBAAtB;AACA,cAAI6B,UAAU,CAAC5B,OAAX,IAAsB4B,UAAU,CAAC3B,QAArC,EACI1P,OAAO,GAAGA,OAAO,CAAC6K,IAAR,EAAV;AACJ,iBAAQwG,UAAU,CAAC5B,OAAX,GAAqBnD,IAAI,CAACxE,WAAL,CAAiB9H,OAAjB,EAA0BsH,IAA1B,EAAgC,KAAKU,OAArC,CAArB,GAAqEqJ,UAAU,CAAC3B,QAAxF;AACH;AAED;;;;;;;;;;AASA,iBAAS4B,kBAAT,CAA4BxM,MAA5B,EAAoCgD,WAApC,EAAiD;AAC7C,cAAIyJ,QAAQ,GAAG,CACXzM,MAAM,CAACgF,KAAP,CAAauG,sBAAb,EAAqC,CAArC,CADW,EAEXvI,WAAW,CAACgC,KAAZ,CAAkBsG,qBAAlB,EAAyC,CAAzC,CAFW,EAGbtP,IAHa,EAAf;AAIA,cAAI0Q,WAAW,GAAGD,QAAQ,CAACA,QAAQ,CAAC3K,MAAT,GAAkB,CAAnB,CAA1B;AACA,iBAAO4K,WAAW,CAAC5K,MAAZ,GAAqB,CAArB,GACD4K,WADC,GAED,MAFN;AAGH;;AAED,iBAASrK,IAAT,CAAcsK,OAAd,EAAuBC,OAAvB,EAAgC;AAC5B,cAAIC,SAAS,GAAGL,kBAAkB,CAACG,OAAD,EAAUC,OAAV,CAAlC,CAD4B,CAG5B;;AACAD,iBAAO,GAAGA,OAAO,CAAC3P,OAAR,CAAgBuO,sBAAhB,EAAwC,EAAxC,CAAV;AACAqB,iBAAO,GAAGA,OAAO,CAAC5P,OAAR,CAAgBsO,qBAAhB,EAAuC,EAAvC,CAAV;AAEA,iBAAOqB,OAAO,GAAGE,SAAV,GAAsBD,OAA7B;AACH;AAED;;;;;;;;;AAQA,iBAAShB,UAAT,CAAoBzB,KAApB,EAA2B;AACvB,iBAAQA,KAAK,IAAI,IAAT,KAAkB,OAAOA,KAAP,KAAiB,QAAjB,IAA8BA,KAAK,CAACzB,QAAN,KAAmByB,KAAK,CAACzB,QAAN,KAAmB,CAAnB,IAAwByB,KAAK,CAACzB,QAAN,KAAmB,CAA3C,IAAgDyB,KAAK,CAACzB,QAAN,KAAmB,EAAtF,CAAhD,CAAR;AACH;;AAED,eAAOhH,eAAP;AAEH,OAlhCsB,EAAvB;;AAqhCA,aAAO,IAAIA,eAAJ,GAAsBiK,QAAtB,CAA+BlK,IAA/B,CAAP;AACH;;;;;;AAGLnH,MAAM,CAACC,OAAP,GAAiBiH,cAAjB,C;;;;;;;AC7iCa;;;;;;;;;;;;;;;;;;;;AAEb,IAAMsL,iBAAiB,GAAGpU,mBAAO,CAAC,EAAD,CAAjC;AAEA;;;;;;;IAKMqU,W;;;;;;;;;;;;;;AACF;;;;;8BAKiB;AACb,aAAOzT,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCgT,OAAhC,CAAwC,KAAxC,EAA+C,YAA/C,CAAP;AACH;AAED;;;;;;;;yCAK4B;AACxB,aAAO1T,SAAS,CAACC,OAAV,CAAkBmB,cAAlB,CAAiCC,WAAjC,CAA6CrB,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCC,cAA7E,EAA6FP,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCE,kBAA7H,EAAiJ,WAAjJ,EACNC,IADM,CACD,UAACkT,MAAD,EAAY;AACd,YAAG,CAACA,MAAD,IAAW,CAACA,MAAM,CAACpS,KAAtB,EAA6B;AACzB,iBAAOhC,OAAO,CAACoE,MAAR,CAAe,IAAIU,KAAJ,CAAU,yKAAV,CAAf,CAAP;AACH;;AAED,eAAO9E,OAAO,CAACC,OAAR,EAAP;AACH,OAPM,CAAP;AAQH;AAED;;;;;;;;;;qCAOwBG,E,EAAI;AACxB,WAAI,IAAIG,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGL,SAAS,CAAC8B,KAAV,CAAgBiH,MAAnC,EAA2C1I,CAAC,EAA5C,EAAgD;AAC5C,YAAIyB,KAAK,GAAG9B,SAAS,CAAC8B,KAAV,CAAgBzB,CAAhB,CAAZ;;AAEA,YAAGyB,KAAK,CAAC5B,EAAN,IAAYA,EAAf,EAAmB;AACf,iBAAO4B,KAAP;AACH;AACJ;;AAED,aAAO,IAAP;AACH;AAED;;;;;;gCAGmB5B,E,EAAI;AACnB,aAAO,YAAYW,aAAa,CAACC,cAA1B,GAA2C,GAA3C,GAAiDD,aAAa,CAACE,kBAA/D,GAAoF,GAApF,GAA0Fb,EAAjG;AACH;AAED;;;;;;;;;;iCAOoBA,E,EAAI;AACpB,aAAO,IAAIJ,OAAJ,CAAY,UAACC,OAAD,EAAUmE,MAAV,EAAqB;AACpC,aAAI,IAAI7D,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGL,SAAS,CAAC8B,KAAV,CAAgBiH,MAAnC,EAA2C1I,CAAC,EAA5C,EAAgD;AAC5C,cAAIyB,KAAK,GAAG9B,SAAS,CAAC8B,KAAV,CAAgBzB,CAAhB,CAAZ;;AAEA,cAAGyB,KAAK,CAAC5B,EAAN,IAAYA,EAAf,EAAmB;AACfH,mBAAO,CAAC+B,KAAD,CAAP;AACA;AACH;AACJ;;AAEDoC,cAAM,CAAC,IAAIU,KAAJ,CAAU,oBAAoB1E,EAApB,GAAyB,aAAnC,CAAD,CAAN;AACH,OAXM,CAAP;AAYH;AAED;;;;;;;;;;;gCAQmBA,E,EAAIiU,I,EAAM;AACzB,aAAO5T,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCgT,OAAhC,CAAwC,MAAxC,EAAgD,gBAAgB/T,EAAhE,EAAoEiU,IAApE,CAAP;AACH;AAED;;;;;;;;;;wCAO2BC,W,EAAaC,gB,EAAkBC,O,EAASC,Y,EAAc;AAC7E;AACA7Q,QAAE,CAACoC,UAAH,GAAgBwO,OAAhB,CAF6E,CAI7E;;AACA/T,eAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCuT,kBAAhC,GAAqD,YAAM;AACvDxU,iBAAS,GAAGuU,YAAZ;AAEA,eAAOzU,OAAO,CAACC,OAAR,EAAP;AACH,OAJD,CAL6E,CAW7E;;;AACA2C,YAAM,CAAC+R,gBAAP,CAAwB,YAAxB,EAAsC,YAAM;AACxC,YAAIC,WAAW,GAAGpR,QAAQ,CAACC,IAAT,CAAcC,OAAd,CAAsB,UAAtB,MAAsC,CAAxD;;AAEA,YAAGkR,WAAH,EAAgB;AACZ,cAAIxU,EAAE,GAAGoD,QAAQ,CAACC,IAAT,CAAcU,OAAd,CAAsB,UAAtB,EAAkC,EAAlC,CAAT;AAEAmQ,qBAAW,CAAClU,EAAD,CAAX;AACH;AACJ,OARD,EAZ6E,CAsB7E;;AACAK,eAAS,CAACY,KAAV,CAAgBC,UAAhB,CAA2BC,UAA3B,CAAsCC,MAAtC,GAA+C,YAAM;AACjDqT,aAAK,CAACC,IAAN,CAAWlU,GAAX,CAAe,YAAf,EAA6BY,MAA7B;AAEA+S,wBAAgB;AACnB,OAJD,CAvB6E,CA6B7E;;;AACAQ,OAAC,CAAC,oBAAD,CAAD,CAAwBC,QAAxB,CAAiC,cAAjC;AACH;;;;EA5HqBf,iB;;AA+H1BxS,MAAM,CAACC,OAAP,GAAiBwS,WAAjB,C;;;;;;;ACxIa;AAEb;;;;;;;;;;;;IAKMA,W;;;;;;;;;;AACF;;;;;kCAKqB;AACjB,aAAOnU,gBAAgB,CAACkV,gBAAjB,GACN/T,IADM,CACD,UAACV,UAAD,EAAgB;AAClBP,eAAO,CAACO,UAAU,CAAC0U,YAAX,EAAD,CAAP;AACH,OAHM,EAINC,KAJM,CAIA,YAAM;AACTlV,eAAO,CAAC,EAAD,CAAP;AACH,OANM,CAAP;AAOH;AAED;;;;;;;;8BAKiB;AACb,aAAOD,OAAO,CAACC,OAAR,CAAgB,EAAhB,CAAP;AACH;AAED;;;;;;;;;;;gCAQmBG,E,EAAIiU,I,EAAM;AACzB,aAAOrU,OAAO,CAACC,OAAR,EAAP;AACH;AAED;;;;;;;;;;gCAOmB0B,O,EAAS;AACxBtB,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AAEA,UAAI8U,IAAI,GACJ,cACArU,aAAa,CAACC,cADd,GAEA,OAHJ;AAKA,aAAOoU,IAAP;AACH;;;;;;AAGL3T,MAAM,CAACC,OAAP,GAAiBwS,WAAjB,C;;;;;;;AC/Da;AAEb;;;;;;;;;;;;IAKMnT,a;;;;;;;;;;AACF;;;;;wBAK4B;AACxB,UAAIsU,KAAK,GAAG7R,QAAQ,CAAC8R,QAAT,CAAkBC,SAAlB,CAA4B,CAA5B,EAA+BC,KAA/B,CAAqC,GAArC,CAAZ;;AAEA,UAAGH,KAAK,CAAC3R,OAAN,CAAc,WAAd,IAA6B,CAAC,CAAjC,EAAoC;AAAE,eAAO,IAAP;AAAc;;AAEpD,aAAO2R,KAAK,CAAC,CAAD,CAAZ;AACH;AAED;;;;;;;;wBAKgC;AAC5B,UAAIA,KAAK,GAAG7R,QAAQ,CAAC8R,QAAT,CAAkBC,SAAlB,CAA4B,CAA5B,EAA+BC,KAA/B,CAAqC,GAArC,CAAZ;;AAEA,UAAGH,KAAK,CAAC3R,OAAN,CAAc,WAAd,IAA6B,CAAC,CAAjC,EAAoC;AAAE,eAAO,IAAP;AAAc;;AAEpD,aAAO2R,KAAK,CAAC,CAAD,CAAZ;AACH;;;;;;AAGL5T,MAAM,CAACC,OAAP,GAAiBX,aAAjB,C;;;;;;;ACnCa;AAEb;;;;;;;;;;;;;;IAKMI,a;;;;;;;;;;AACF;;;;;;;;;4BASesU,M,EAAQC,G,EAAK9P,I,EAAM;AAC9B,aAAOzE,aAAa,CAACwU,aAAd,CAA4BF,MAA5B,EAAoCtU,aAAa,CAACyU,cAAd,CAA6BF,GAA7B,CAApC,EAAuE9P,IAAvE,CAAP;AACH;AAED;;;;;;;;;;;;+BASkB8P,G,EAAK3P,I,EAAMH,I,EAAM;AAC/B,aAAO,IAAI5F,OAAJ,CAAY,UAACC,OAAD,EAAUmE,MAAV,EAAqB;AACpC2Q,SAAC,CAACc,IAAF,CAAO;AACHH,aAAG,EAAEvU,aAAa,CAACyU,cAAd,CAA6BF,GAA7B,CADF;AAEH3P,cAAI,EAAE,MAFH;AAGHH,cAAI,EAAEA,IAHH;AAIHkQ,qBAAW,EAAE,KAJV;AAKHC,qBAAW,EAAE,KALV;AAMHC,iBAAO,EAAE,iBAACC,QAAD,EAAc;AACnBhW,mBAAO,CAACgW,QAAD,CAAP;AACH,WARE;AASHvO,eAAK,EAAE,eAACvB,CAAD,EAAO;AACV/B,kBAAM,CAAC+B,CAAD,CAAN;AACH;AAXE,SAAP;AAaH,OAdM,CAAP,CAD+B,CAgB/B;AACH;AAED;;;;;;;;;;;;;kCAUqBsP,M,EAAQC,G,EAAK9P,I,EAAMsQ,O,EAAS;AAC7CA,aAAO,GAAGA,OAAO,IAAI;AACjB,wBAAgB;AADC,OAArB;AAIA,aAAO,IAAIlW,OAAJ,CAAY,UAACC,OAAD,EAAUmE,MAAV,EAAqB;AACpC,YAAI+R,GAAG,GAAG,IAAIC,cAAJ,EAAV;AACAD,WAAG,CAACrF,IAAJ,CAAS2E,MAAM,CAACnP,WAAP,EAAT,EAA+BoP,GAA/B;;AAEA,aAAI,IAAIW,CAAR,IAAaH,OAAb,EAAsB;AAClBC,aAAG,CAACG,gBAAJ,CAAqBD,CAArB,EAAwBH,OAAO,CAACG,CAAD,CAA/B;AACH;;AAED,YAAGzQ,IAAH,EAAS;AACL,cAAG,QAAOA,IAAP,MAAgB,QAAhB,IAA4BA,IAAI,YAAY2Q,QAAhB,KAA6B,KAA5D,EAAmE;AAC/D3Q,gBAAI,GAAGC,IAAI,CAAC2Q,SAAL,CAAe5Q,IAAf,CAAP;AACH;;AAEDuQ,aAAG,CAACM,IAAJ,CAAS7Q,IAAT;AAEH,SAPD,MAOO;AACHuQ,aAAG,CAACM,IAAJ;AAEH;;AAEDN,WAAG,CAACO,kBAAJ,GAAyB,YAAM;AAC3B,cAAMC,IAAI,GAAG,CAAb;AACA,cAAMC,EAAE,GAAG,GAAX;AACA,cAAMC,YAAY,GAAG,GAArB;AACA,cAAMC,YAAY,GAAG,GAArB;;AAEA,cAAGX,GAAG,CAACY,UAAJ,KAAmBJ,IAAtB,EAA4B;AACxB,gBAAGR,GAAG,CAACa,MAAJ,KAAeF,YAAlB,EAAgC;AAC5BtT,sBAAQ,GAAG,kBAAkBA,QAAQ,CAAC8R,QAA3B,GAAsC9R,QAAQ,CAACC,IAA1D;AAEAW,oBAAM,CAAC,IAAIU,KAAJ,CAAU,uBAAV,CAAD,CAAN;AAEH,aALD,MAKO,IAAGqR,GAAG,CAACa,MAAJ,IAAcJ,EAAd,IAAoBT,GAAG,CAACa,MAAJ,IAAcH,YAArC,EAAmD;AACtD,kBAAIZ,QAAQ,GAAGE,GAAG,CAACc,YAAnB;;AAEA,kBAAGhB,QAAQ,IAAIA,QAAQ,IAAI,IAA3B,EAAiC;AAC7B,oBAAI;AACAA,0BAAQ,GAAGpQ,IAAI,CAACC,KAAL,CAAWmQ,QAAX,CAAX;AAEH,iBAHD,CAGE,OAAM9P,CAAN,EAAS,CACP;AAEH;AACJ;;AAED,kBAAG8P,QAAQ,KAAK,EAAhB,EAAoB;AAAEA,wBAAQ,GAAG,IAAX;AAAkB;;AAExChW,qBAAO,CAACgW,QAAD,CAAP;AAEH,aAjBM,MAiBA;AACH,kBAAIvO,KAAK,GAAG,IAAI5C,KAAJ,CAAUqR,GAAG,CAACc,YAAd,CAAZ;AAEAvP,mBAAK,CAACwP,UAAN,GAAmBf,GAAG,CAACa,MAAvB;AAEA5S,oBAAM,CAACsD,KAAD,CAAN;AAEH;AACJ;AACJ,SAtCD;AAuCH,OA3DM,CAAP;AA4DH;AAED;;;;;;;;mCAKsBgO,G,EAAK;AACvB,UAAIyB,MAAM,GAAG,OAAb;;AAEA,UAAG1W,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCC,cAAnC,EAAmD;AAC/CmW,cAAM,IAAI1W,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCC,cAAhC,GAAiD,GAA3D;AACH;;AAED,UAAGP,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCE,kBAAnC,EAAuD;AACnDkW,cAAM,IAAI1W,SAAS,CAACC,OAAV,CAAkBK,aAAlB,CAAgCE,kBAAhC,GAAqD,GAA/D;AACH;;AAEDkW,YAAM,IAAIzB,GAAV;AAEA,aAAOyB,MAAP;AACH;AAED;;;;;;uCAG0B;AACtBvT,QAAE,CAACwT,YAAH,CAAgB,SAAhB,EAA2B,4BAA3B,EAAyD,KAAzD;;AAEA,eAASC,IAAT,GAAgB;AACZtC,SAAC,CAACc,IAAF,CAAO;AACH9P,cAAI,EAAE,KADH;AAEH2P,aAAG,EAAE,GAFF;AAGHM,iBAAO,EAAE,mBAAM;AACXxS,oBAAQ,CAAChC,MAAT;AACH,WALE;AAMHkG,eAAK,EAAE,iBAAM;AACT2P,gBAAI;AACP;AARE,SAAP;AAUH;;AAEDA,UAAI;AACP;;;;AAED;;;mCAGsBtS,I,EAAM;AACxB,aAAO5D,aAAa,CAACgT,OAAd,CAAsB,KAAtB,EAA6BpP,IAA7B,EACN7D,IADM,CACD,UAACkT,MAAD,EAAY;AACdxR,cAAM,CAAC1C,SAAP,CAAiB6E,IAAjB,IAAyBqP,MAAzB,CADc,CAGd;;AACA,aAAI,IAAI7T,CAAR,IAAaqC,MAAM,CAAC1C,SAAP,CAAiB6E,IAAjB,CAAb,EAAqC;AACjC,cAAIuS,MAAM,GAAG1U,MAAM,CAAC1C,SAAP,CAAiB6E,IAAjB,EAAuBxE,CAAvB,CAAb;AACA,cAAIgX,KAAK,GAAG,IAAZ;;AAEA,kBAAOxS,IAAP;AACI,iBAAK,aAAL;AACIwS,mBAAK,GAAG,IAAI9W,SAAS,CAACI,MAAV,CAAiBC,UAArB,CAAgCwW,MAAhC,CAAR;AACA;;AAEJ,iBAAK,SAAL;AACIC,mBAAK,GAAG,IAAI9W,SAAS,CAACI,MAAV,CAAiByB,OAArB,CAA6BgV,MAA7B,CAAR;AACA;;AAEJ,iBAAK,OAAL;AACIC,mBAAK,GAAG,IAAI9W,SAAS,CAACI,MAAV,CAAiB2W,IAArB,CAA0BF,MAA1B,CAAR;AACA;;AAEJ,iBAAK,OAAL;AACIC,mBAAK,GAAG,IAAI9W,SAAS,CAACI,MAAV,CAAiB4W,IAArB,CAA0BH,MAA1B,CAAR;AACA;;AAEJ,iBAAK,OAAL;AACIC,mBAAK,GAAG,IAAI9W,SAAS,CAACI,MAAV,CAAiB6W,KAArB,CAA2BJ,MAA3B,CAAR;AACA;;AAEJ,iBAAK,SAAL;AACIC,mBAAK,GAAG9W,SAAS,CAACC,OAAV,CAAkB8D,YAAlB,CAA+BmT,QAA/B,CAAwCL,MAAxC,CAAR;AACA;;AAEJ;AACI,qBAAOtX,OAAO,CAACoE,MAAR,CAAe,IAAIU,KAAJ,CAAU,eAAeC,IAAf,GAAsB,wBAAhC,CAAf,CAAP;AA1BR;;AA6BAnC,gBAAM,CAAC1C,SAAP,CAAiB6E,IAAjB,EAAuBxE,CAAvB,IAA4BgX,KAA5B;AACH;;AAED,eAAOvX,OAAO,CAACC,OAAR,CAAgBmU,MAAhB,CAAP;AACH,OA1CM,EA2CNe,KA3CM,CA2CA,UAAChP,CAAD,EAAO;AACV;AACA,YAAGA,CAAC,CAAC+Q,UAAF,KAAiB,GAApB,EAAyB;AACrBtT,YAAE,CAACoC,UAAH,CAAcG,CAAd;AACH;;AAEDvD,cAAM,CAAC1C,SAAP,CAAiB6E,IAAjB,IAAyB,EAAzB;AAEA,eAAO/E,OAAO,CAACC,OAAR,CAAgB,EAAhB,CAAP;AACH,OApDM,CAAP;AAqDH;;;;AAED;;;yCAG4B;AACxB8U,OAAC,CAAC,uCAAD,CAAD,CAA2C6C,KAA3C;AAEA,UAAIC,KAAK,GAAG,CACR,SADQ,EAER,SAFQ,EAGR,OAHQ,EAIR,aAJQ,EAKR,OALQ,EAMR,OANQ,CAAZ;;AASA,4BAAgBA,KAAhB,eAAuB;AAAnB,YAAIxD,IAAI,GAAIwD,KAAJ,IAAR;;AACA,YAAIC,IAAI,GAAGC,CAAC,CAACC,GAAF,CAAM;AAACC,eAAK,EAAE,0BAAR;AAAoC,uBAAa5D;AAAjD,SAAN,EAA8DA,IAA9D,CAAX;;AAEAU,SAAC,CAAC,uCAAD,CAAD,CAA2C/H,MAA3C,CAAkD8K,IAAlD;AACH;;AAED,UAAII,YAAY,GAAG,SAAfA,YAAe,GAAM;AACrB,YAAInT,IAAI,GAAG8S,KAAK,CAACM,KAAN,EAAX;AAEA,eAAOhX,aAAa,CAACC,cAAd,CAA6B2D,IAA7B,EACN7D,IADM,CACD,YAAM;AACR6T,WAAC,CAAC,uDAAuDhQ,IAAvD,GAA8D,IAA/D,CAAD,CAAsEqT,WAAtE,CAAkF,QAAlF,EAA4F,IAA5F;;AAEA,cAAGP,KAAK,CAAC5O,MAAN,GAAe,CAAlB,EAAqB;AACjB,mBAAOjJ,OAAO,CAACC,OAAR,EAAP;AAEH,WAHD,MAGO;AACH,mBAAOiY,YAAY,EAAnB;AAEH;AACJ,SAXM,CAAP;AAYH,OAfD;;AAiBA,aAAOA,YAAY,EAAnB;AACH;;;;;;AAILzW,MAAM,CAACC,OAAP,GAAiBP,aAAjB,C;;;;;;;AC/Qa;AAEb;;;;;;;;;;;;IAKMR,c;;;;;;;;;;AACF;;;;;;;;;yCAS4B0X,M,EAAQC,K,EAA+B;AAAA,UAAxBlY,EAAwB,uEAAnB,IAAmB;AAAA,UAAbwF,IAAa,uEAAN,IAAM;AAC/DvF,gBAAU,CAACgY,MAAD,EAAS,QAAT,EAAmB/X,MAAnB,CAAV;AACAD,gBAAU,CAACiY,KAAD,EAAQ,OAAR,EAAiBhY,MAAjB,CAAV;AACAD,gBAAU,CAACD,EAAD,EAAK,IAAL,EAAWE,MAAX,CAAV;AACAD,gBAAU,CAACuF,IAAD,EAAO,MAAP,EAAe2S,MAAf,CAAV;AAEA,aAAO,IAAIvY,OAAJ,CAAY,UAACC,OAAD,EAAUmE,MAAV,EAAqB;AACpC,YAAI;AACA,cAAI+P,OAAO,GAAGvR,MAAM,CAAC4V,SAAP,CAAiB1H,IAAjB,CAAsB,cAAtB,EAAsC,CAAtC,CAAd;;AAEAqD,iBAAO,CAACsE,SAAR,GAAoB,UAACtS,CAAD,EAAO;AACvBlG,mBAAO,CAACkG,CAAC,CAACuS,MAAF,CAAStE,MAAV,CAAP;AACH,WAFD;;AAIAD,iBAAO,CAACwE,OAAR,GAAkB,UAACxS,CAAD,EAAO;AACrB/B,kBAAM,CAAC,IAAIU,KAAJ,CAAU,WAAWe,IAAI,CAAC2Q,SAAL,CAAeoC,KAAf,CAAX,GAAmC,gBAAnC,GAAsDP,MAAtD,GAA+D,eAA/D,GAAiFC,KAAjF,GAAyF,wBAAzF,GAAoHnS,CAAC,CAACuS,MAAF,CAASG,SAAvI,CAAD,CAAN;AACH,WAFD;;AAIA1E,iBAAO,CAAC2E,eAAR,GAA0B,UAAC3S,CAAD,EAAO;AAC7B,gBAAI4S,EAAE,GAAG5S,CAAC,CAACuS,MAAF,CAAStE,MAAlB;AAEA2E,cAAE,CAACC,iBAAH,CAAqB,aAArB,EAAoC;AAAEC,qBAAO,EAAE,IAAX;AAAiBC,2BAAa,EAAE;AAAhC,aAApC;AACAH,cAAE,CAACC,iBAAH,CAAqB,SAArB,EAAgC;AAAEC,qBAAO,EAAE,IAAX;AAAiBC,2BAAa,EAAE;AAAhC,aAAhC;AACAH,cAAE,CAACC,iBAAH,CAAqB,SAArB,EAAgC;AAAEC,qBAAO,EAAE,IAAX;AAAiBC,2BAAa,EAAE;AAAhC,aAAhC;AACAH,cAAE,CAACC,iBAAH,CAAqB,OAArB,EAA8B;AAAEC,qBAAO,EAAE,IAAX;AAAiBC,2BAAa,EAAE;AAAhC,aAA9B;AACAH,cAAE,CAACC,iBAAH,CAAqB,OAArB,EAA8B;AAAEC,qBAAO,EAAE,IAAX;AAAiBC,2BAAa,EAAE;AAAhC,aAA9B;AACAH,cAAE,CAACC,iBAAH,CAAqB,OAArB,EAA8B;AAAEC,qBAAO,EAAE,IAAX;AAAiBC,2BAAa,EAAE;AAAhC,aAA9B;AACH,WATD;AAWH,SAtBD,CAsBE,OAAM/S,CAAN,EAAS;AACP/B,gBAAM,CAAC+B,CAAD,CAAN;AAEH;AACJ,OA3BM,EA4BNjF,IA5BM,CA4BD,UAAC6X,EAAD,EAAQ;AACV,eAAO,IAAI/Y,OAAJ,CAAY,UAACC,OAAD,EAAUmE,MAAV,EAAqB;AACpC,cAAI;AACA,gBAAI+U,WAAW,GAAGJ,EAAE,CAACK,WAAH,CAAe,CAACd,KAAD,CAAf,EAAwB,WAAxB,EAAqCa,WAArC,CAAiDb,KAAjD,CAAlB;AACA,gBAAInE,OAAO,GAAG,IAAd;;AAEA,gBAAGkE,MAAM,KAAK,KAAd,EAAqB;AACjBzS,kBAAI,CAACxF,EAAL,GAAUA,EAAV;AACA+T,qBAAO,GAAGgF,WAAW,CAACE,GAAZ,CAAgBzT,IAAhB,CAAV;AACH,aAHD,MAGO,IAAGyS,MAAM,KAAK,KAAd,EAAqB;AACxBlE,qBAAO,GAAGgF,WAAW,CAACvY,GAAZ,CAAgBR,EAAhB,CAAV;AACH,aAFM,MAEA,IAAGiY,MAAM,KAAK,QAAd,EAAwB;AAC3BlE,qBAAO,GAAGgF,WAAW,CAACG,MAAZ,CAAmBlZ,EAAnB,CAAV;AACH;;AAED+T,mBAAO,CAACsE,SAAR,GAAoB,UAACtS,CAAD,EAAO;AACvBlG,qBAAO,CAACkG,CAAC,CAACuS,MAAF,CAAStE,MAAV,CAAP;AACH,aAFD;;AAIAD,mBAAO,CAACwE,OAAR,GAAkB,UAACxS,CAAD,EAAO;AACrB/B,oBAAM,CAAC,IAAIU,KAAJ,CAAU,WAAWe,IAAI,CAAC2Q,SAAL,CAAeoC,KAAf,CAAX,GAAmC,gBAAnC,GAAsDP,MAAtD,GAA+D,eAA/D,GAAiFC,KAAjF,GAAyF,wBAAzF,GAAoHnS,CAAC,CAACuS,MAAF,CAASG,SAAvI,CAAD,CAAN;AACH,aAFD;AAIH,WArBD,CAqBE,OAAM1S,CAAN,EAAS;AACP/B,kBAAM,CAAC+B,CAAD,CAAN;AAEH;AACJ,SA1BM,CAAP;AA2BH,OAxDM,CAAP;AAyDH;AAED;;;;;;;;;;;;6BASgBoR,K,EAAOgC,Q,EAAUnZ,E,EAAI;AACjCC,gBAAU,CAACkX,KAAD,EAAQ,OAAR,EAAiB9W,SAAS,CAACI,MAAV,CAAiB2Y,QAAlC,CAAV;AACAnZ,gBAAU,CAACkZ,QAAD,EAAW,UAAX,EAAuBjZ,MAAvB,CAAV;AAEA,aAAO,KAAKmZ,oBAAL,CAA0B,KAA1B,EAAiCF,QAAjC,EAA2CnZ,EAA3C,EACNc,IADM,CACD,UAAC0E,IAAD,EAAU;AACZ,YAAG,CAACA,IAAJ,EAAU;AAAE,iBAAO5F,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAP;AAA+B;;AAE3C,YAAG,CAACmI,KAAK,CAACC,OAAN,CAAczC,IAAd,CAAJ,EAAyB;AAAE,iBAAO5F,OAAO,CAACC,OAAR,CAAgB,IAAIsX,KAAJ,CAAU3R,IAAV,CAAhB,CAAP;AAA2C;;AAEtE,aAAI,IAAIrF,CAAR,IAAaqF,IAAb,EAAmB;AACfA,cAAI,CAACrF,CAAD,CAAJ,GAAU,IAAIgX,KAAJ,CAAU3R,IAAI,CAACrF,CAAD,CAAd,CAAV;AACH;;AAED,eAAOP,OAAO,CAACC,OAAR,CAAgB2F,IAAhB,CAAP;AACH,OAXM,EAYNuP,KAZM,CAYA,UAAChP,CAAD,EAAO;AACV,eAAOnG,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAP;AACH,OAdM,CAAP;AAeH;AAED;;;;;;;;;;;;6BASgBsZ,Q,EAAUnZ,E,EAAIwF,I,EAAM;AAAA;;AAChCvF,gBAAU,CAACkZ,QAAD,EAAW,UAAX,EAAuBjZ,MAAvB,CAAV;AACAD,gBAAU,CAACD,EAAD,EAAK,IAAL,EAAWE,MAAX,CAAV;AACAD,gBAAU,CAACuF,IAAD,EAAO,MAAP,EAAenF,SAAS,CAACI,MAAV,CAAiB2Y,QAAhC,CAAV;AAEA,aAAO,KAAKE,WAAL,CAAiBH,QAAjB,EAA2BnZ,EAA3B,EACNc,IADM,CACD,YAAM;AACR,eAAO,KAAI,CAACuY,oBAAL,CAA0B,KAA1B,EAAiCF,QAAjC,EAA2CnZ,EAA3C,EAA+CwF,IAAI,CAAC+T,SAAL,EAA/C,CAAP;AACH,OAHM,CAAP;AAIH;AAED;;;;;;;;;;;gCAQmBJ,Q,EAAUnZ,E,EAAIwF,I,EAAM;AACnCvF,gBAAU,CAACkZ,QAAD,EAAW,UAAX,EAAuBjZ,MAAvB,CAAV;AACAD,gBAAU,CAACD,EAAD,EAAK,IAAL,EAAWE,MAAX,CAAV;AAEA,aAAO,KAAKmZ,oBAAL,CAA0B,QAA1B,EAAoCF,QAApC,EAA8CnZ,EAA9C,CAAP;AACH;AAED;;;;;;;;;;;2BAQcmZ,Q,EAAUnZ,E,EAAI;AAAA;;AACxBC,gBAAU,CAACkZ,QAAD,EAAW,UAAX,EAAuBjZ,MAAvB,CAAV;AACAD,gBAAU,CAACD,EAAD,EAAK,IAAL,EAAWE,MAAX,CAAV;AAEA,aAAOG,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCgT,OAAhC,CAAwC,QAAxC,EAAkDoF,QAAQ,GAAG,GAAX,GAAiBnZ,EAAnE,EACNc,IADM,CACD,YAAM;AACR,eAAO,MAAI,CAACwY,WAAL,CAAiBH,QAAjB,EAA2BnZ,EAA3B,CAAP;AACH,OAHM,CAAP;AAIH;AAED;;;;;;;;;;;;wBASWmX,K,EAAOgC,Q,EAAqB;AAAA;;AAAA,UAAXnZ,EAAW,uEAAN,IAAM;AACnCC,gBAAU,CAACkX,KAAD,EAAQ,OAAR,EAAiB9W,SAAS,CAACI,MAAV,CAAiB2Y,QAAlC,CAAV;AACAnZ,gBAAU,CAACkZ,QAAD,EAAW,UAAX,EAAuBjZ,MAAvB,CAAV;AAEA,aAAO,KAAKsZ,QAAL,CAAcrC,KAAd,EAAqBgC,QAArB,EAA+BnZ,EAA/B,EACNc,IADM,CACD,UAACkT,MAAD,EAAY;AACd,YAAGA,MAAH,EAAW;AAAE,iBAAOpU,OAAO,CAACC,OAAR,CAAgBmU,MAAhB,CAAP;AAAiC;;AAE9C,eAAO3T,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCgT,OAAhC,CAAwC,KAAxC,EAA+CoF,QAAQ,IAAInZ,EAAE,GAAG,MAAMA,EAAT,GAAc,EAApB,CAAvD,EACNc,IADM,CACD,UAACkT,MAAD,EAAY;AACd,cAAG,CAACA,MAAJ,EAAY;AAAE,kBAAM,IAAItP,KAAJ,CAAU,cAAcyU,QAAd,IAA0BnZ,EAAE,GAAG,MAAMA,EAAT,GAAc,EAA1C,IAAgD,YAA1D,CAAN;AAAgF;;AAE9F,cAAG,CAACgI,KAAK,CAACC,OAAN,CAAc+L,MAAd,CAAJ,EAA2B;AACvBA,kBAAM,GAAG,IAAImD,KAAJ,CAAUnD,MAAV,CAAT;;AAEA,kBAAI,CAACyF,QAAL,CAAcN,QAAd,EAAwBnF,MAAM,CAAChU,EAA/B,EAAmCgU,MAAnC;;AAEA,mBAAOpU,OAAO,CAACC,OAAR,CAAgBmU,MAAhB,CAAP;AAEH,WAPD,MAOO;AACH,iBAAI,IAAI7T,CAAR,IAAa6T,MAAb,EAAqB;AACjBA,oBAAM,CAAC7T,CAAD,CAAN,GAAY,IAAIgX,KAAJ,CAAUnD,MAAM,CAAC7T,CAAD,CAAhB,CAAZ;;AAEA,oBAAI,CAACsZ,QAAL,CAAcN,QAAd,EAAwBnF,MAAM,CAAC7T,CAAD,CAAN,CAAUH,EAAlC,EAAsCgU,MAAM,CAAC7T,CAAD,CAA5C;AACH;AACJ;;AAED,iBAAOP,OAAO,CAACC,OAAR,CAAgBmU,MAAhB,CAAP;AACH,SApBM,CAAP;AAqBH,OAzBM,CAAP;AA0BH;AAED;;;;;;;;;;;;wBASWmF,Q,EAAUnZ,E,EAAIwF,I,EAAM;AAAA;;AAC3BvF,gBAAU,CAACkZ,QAAD,EAAW,UAAX,EAAuBjZ,MAAvB,CAAV;AACAD,gBAAU,CAACkZ,QAAD,EAAW,IAAX,EAAiBjZ,MAAjB,CAAV;AACAD,gBAAU,CAACuF,IAAD,EAAO,MAAP,EAAenF,SAAS,CAACI,MAAV,CAAiB2Y,QAAhC,CAAV;AAEA,aAAO/Y,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCgT,OAAhC,CAAwC,MAAxC,EAAgDoF,QAAQ,GAAG,GAAX,GAAiBnZ,EAAjE,EAAqEwF,IAArE,EACN1E,IADM,CACD,YAAM;AACR,eAAO,MAAI,CAAC2Y,QAAL,CAAcN,QAAd,EAAwBnZ,EAAxB,EAA4BwF,IAA5B,CAAP;AACH,OAHM,CAAP;AAIH;;;;;;AAGLnE,MAAM,CAACC,OAAP,GAAiBf,cAAjB,C;;;;;;;ACnOa;;;;;;;;;;;;;;;;;;;;AAEb,IAAMmZ,kBAAkB,GAAGja,mBAAO,CAAC,EAAD,CAAlC;AAEA;;;;;;;IAKM2E,Y;;;;;;;;;;;;;;AACF;;;;;;;8CAOiCpE,E,EAAI;AACjC,UAAG,CAACA,EAAJ,EAAQ;AACJ,eAAOJ,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAP;AACH;;AAED,aAAOQ,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCgT,OAAhC,CAAwC,KAAxC,EAA+C,aAAa/T,EAAb,GAAkB,yBAAjE,EACNc,IADM,CACD,UAACuB,MAAD,EAAY;AACd,eAAOzC,OAAO,CAACC,OAAR,CAAgBuE,YAAY,CAACmT,QAAb,CAAsBlV,MAAtB,CAAhB,CAAP;AACH,OAHM,CAAP;AAIH;AAED;;;;;;;;;;oDAOuCrC,E,EAAI;AACvC,UAAI2Z,WAAW,GAAG,KAAKC,iBAAL,CAAuB5Z,EAAvB,CAAlB;;AAEA,UAAG,CAAC2Z,WAAJ,EAAiB;AAAE,eAAO,IAAP;AAAc;;AAEjC,UAAIE,UAAU,GAAG,KAAKD,iBAAL,CAAuBD,WAAW,CAACG,cAAnC,CAAjB;AACA,UAAIC,cAAc,GAAG,IAAI1Z,SAAS,CAACI,MAAV,CAAiBuZ,WAArB,CAAiCL,WAAW,CAACJ,SAAZ,EAAjC,CAArB;;AAEA,aAAMM,UAAN,EAAkB;AACdE,sBAAc,CAACE,YAAf,CAA4BJ,UAAU,CAACK,MAAvC;AAEAL,kBAAU,GAAG,KAAKD,iBAAL,CAAuBC,UAAU,CAACC,cAAlC,CAAb;AACH;;AAED,aAAOC,cAAP;AACH;AAED;;;;;;;;;;kCAOqB/Z,E,EAAI;AAAA;;AACrB,aAAOK,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCgT,OAAhC,CAAwC,KAAxC,EAA+C,aAAa/T,EAA5D,EACNc,IADM,CACD,UAACuB,MAAD,EAAY;AACd,eAAOzC,OAAO,CAACC,OAAR,CAAgB,KAAI,CAAC0X,QAAL,CAAclV,MAAd,CAAhB,CAAP;AACH,OAHM,CAAP;AAIH;AAED;;;;;;;;;;sCAOyBsD,I,EAAM;AAC3B,UAAG,CAACA,IAAJ,EAAU;AAAE,eAAO7F,SAAS,CAACqa,OAAjB;AAA2B;;AAEvC,aAAOra,SAAS,CAACqa,OAAV,CAAkBlX,MAAlB,CAAyB,UAACZ,MAAD,EAAY;AACxC,YAAGA,MAAM,CAACrC,EAAP,IAAa2F,IAAI,GAAG,MAAvB,EAA+B;AAAE,iBAAO,KAAP;AAAe;;AAEhD,eAAOtD,MAAM,CAACsD,IAAP,KAAgBA,IAAvB;AACH,OAJM,CAAP;AAKH;AAED;;;;;;;;;;sCAOyB3F,E,EAAI;AACzB,WAAI,IAAIG,CAAR,IAAaL,SAAS,CAACqa,OAAvB,EAAgC;AAC5B,YAAI9X,MAAM,GAAGvC,SAAS,CAACqa,OAAV,CAAkBha,CAAlB,CAAb;;AAEA,YAAGkC,MAAM,CAACrC,EAAP,IAAaA,EAAhB,EAAoB;AAChB,cAAGqC,MAAM,YAAYhC,SAAS,CAACI,MAAV,CAAiB2Z,aAAnC,IAAoD/X,MAAM,YAAYhC,SAAS,CAACI,MAAV,CAAiBuZ,WAA1F,EAAuG;AACnG,mBAAO3X,MAAP;AACH;;AAED,iBAAO,KAAKkV,QAAL,CAAclV,MAAd,CAAP;AACH;AACJ;AACJ;;;;EA7FsBqX,kB;;AAgG3BrY,MAAM,CAACC,OAAP,GAAiB8C,YAAjB,C;;;;;;;ACzGa;AAEb;;;;;;;;;;;;;;IAKMA,Y;;;;;;;;;;AACF;;;;;;;8CAOiCpE,E,EAAI;AACjC,aAAO,IAAIJ,OAAJ,CAAY,UAACya,QAAD,EAAc;AAC7BA,gBAAQ;AACX,OAFM,CAAP;AAGH;AAED;;;;;;;;;;6BAOgBhS,U,EAAY;AACxB,UAAG,CAACA,UAAJ,EAAgB;AAAE,eAAO,IAAP;AAAc,OADR,CAGxB;;;AACA,UAAGA,UAAU,YAAYhI,SAAS,CAACI,MAAV,CAAiB2Z,aAAvC,IAAwD/R,UAAU,YAAYhI,SAAS,CAACI,MAAV,CAAiBuZ,WAAlG,EAA+G;AAC3G,eAAO3R,UAAP;AACH,OANuB,CAQxB;;;AACA,UAAG,OAAOA,UAAU,CAACkR,SAAlB,KAAgC,UAAnC,EAA+C;AAC3ClR,kBAAU,GAAGA,UAAU,CAACkR,SAAX,EAAb;AACH;;AAED,UAAGlR,UAAU,CAAC1C,IAAX,KAAoB,SAAvB,EAAkC;AAC9B,eAAO,IAAItF,SAAS,CAACI,MAAV,CAAiB2Z,aAArB,CAAmC/R,UAAnC,CAAP;AACH,OAFD,MAEO,IAAGA,UAAU,CAAC1C,IAAX,KAAoB,OAAvB,EAAgC;AACnC,eAAO,IAAItF,SAAS,CAACI,MAAV,CAAiBuZ,WAArB,CAAiC3R,UAAjC,CAAP;AACH;;AAED,YAAM,IAAI3D,KAAJ,CAAU,2CAA2Ce,IAAI,CAAC2Q,SAAL,CAAe/N,UAAf,CAArD,CAAN;AACH;AAED;;;;;;;;;;;iCAQoB5D,W,EAAaF,Y,EAAc;AAC3CtE,gBAAU,CAACwE,WAAD,EAAc,aAAd,EAA6BpE,SAAS,CAACI,MAAV,CAAiB6Z,MAA9C,CAAV;AACAra,gBAAU,CAACsE,YAAD,EAAe,cAAf,EAA+BlE,SAAS,CAACI,MAAV,CAAiB6Z,MAAhD,CAAV;AAEA7V,iBAAW,GAAGA,WAAW,CAAC8U,SAAZ,EAAd;AACAhV,kBAAY,GAAGA,YAAY,CAACgV,SAAb,EAAf;AAEA,UAAIgB,YAAY,GAAGhW,YAAnB,CAP2C,CAS3C;;AACA,eAASiW,KAAT,CAAeC,YAAf,EAA6BC,WAA7B,EAA0C;AACtC,aAAI,IAAIzE,CAAR,IAAayE,WAAb,EAA0B;AACtB,cAAG,QAAOD,YAAY,CAACxE,CAAD,CAAnB,MAA2B,QAA3B,IAAuC,QAAOyE,WAAW,CAACzE,CAAD,CAAlB,MAA0B,QAApE,EAA8E;AAC1EuE,iBAAK,CAACC,YAAY,CAACxE,CAAD,CAAb,EAAkByE,WAAW,CAACzE,CAAD,CAA7B,CAAL;AAEH,WAHD,MAGO,IAAGyE,WAAW,CAACzE,CAAD,CAAd,EAAmB;AACtBwE,wBAAY,CAACxE,CAAD,CAAZ,GAAkByE,WAAW,CAACzE,CAAD,CAA7B;AAEH;AACJ;AACJ,OApB0C,CAsB3C;;;AACAsE,kBAAY,CAACva,EAAb,GAAkByE,WAAW,CAACzE,EAA9B;AACAua,kBAAY,CAAC5V,IAAb,GAAoBF,WAAW,CAACE,IAAhC;AACA4V,kBAAY,CAACT,cAAb,GAA8BrV,WAAW,CAACqV,cAA1C;AACAS,kBAAY,CAACI,IAAb,GAAoBlW,WAAW,CAACkW,IAAZ,IAAoBJ,YAAY,CAACI,IAArD,CA1B2C,CA4B3C;;AACA,cAAOJ,YAAY,CAAC5U,IAApB;AACI,aAAK,OAAL;AACI4U,sBAAY,CAACK,QAAb,GAAwBL,YAAY,CAACK,QAAb,IAAyBrW,YAAY,CAACqW,QAA9D,CADJ,CAGI;;AACA,cAAG,CAACL,YAAY,CAACL,MAAjB,EAAyB;AAAEK,wBAAY,CAACL,MAAb,GAAsB,EAAtB;AAA2B;;AACtD,cAAG,CAAC3V,YAAY,CAAC2V,MAAjB,EAAyB;AAAE3V,wBAAY,CAAC2V,MAAb,GAAsB,EAAtB;AAA2B;;AAEtDM,eAAK,CAACD,YAAY,CAACL,MAAd,EAAsBzV,WAAW,CAACyV,MAAlC,CAAL;AACA;;AAEJ,aAAK,SAAL;AACI;AACA,cAAG,CAACK,YAAY,CAACM,IAAjB,EAAuB;AAAEN,wBAAY,CAACM,IAAb,GAAoB,EAApB;AAAyB;;AAClD,cAAG,CAACpW,WAAW,CAACoW,IAAhB,EAAsB;AAAEpW,uBAAW,CAACoW,IAAZ,GAAmB,EAAnB;AAAwB;;AAEhDL,eAAK,CAACD,YAAY,CAACM,IAAd,EAAoBpW,WAAW,CAACoW,IAAhC,CAAL,CALJ,CAOI;;AACA,cAAG,CAACN,YAAY,CAACO,MAAjB,EAAyB;AAAEP,wBAAY,CAACO,MAAb,GAAsB,EAAtB;AAA2B;;AACtD,cAAG,CAACP,YAAY,CAACO,MAAb,CAAoBzS,UAAxB,EAAoC;AAAEkS,wBAAY,CAACO,MAAb,CAAoBzS,UAApB,GAAiC,EAAjC;AAAsC;;AAC5E,cAAG,CAAC5D,WAAW,CAACqW,MAAhB,EAAwB;AAAErW,uBAAW,CAACqW,MAAZ,GAAqB,EAArB;AAA0B;;AACpD,cAAG,CAACrW,WAAW,CAACqW,MAAZ,CAAmBzS,UAAvB,EAAmC;AAAE5D,uBAAW,CAACqW,MAAZ,CAAmBzS,UAAnB,GAAgC,EAAhC;AAAqC;;AAE1EmS,eAAK,CAACD,YAAY,CAACO,MAAd,EAAsBrW,WAAW,CAACqW,MAAlC,CAAL,CAbJ,CAeI;;AACAP,sBAAY,CAACQ,YAAb,GAA4BtW,WAAW,CAACsW,YAAZ,IAA4BR,YAAY,CAACQ,YAArE;AACA;AA5BR;;AA+BA,aAAO,KAAKxD,QAAL,CAAcgD,YAAd,CAAP;AACH;;;;;;AAGLlZ,MAAM,CAACC,OAAP,GAAiB8C,YAAjB,C;;;;;;;AC1Ha;;;;;;;;;;;;;;;;;;;;AAEb,IAAM4W,oBAAoB,GAAGvb,mBAAO,CAAC,EAAD,CAApC;AAEA;;;;;;;IAKMgC,c;;;;;;;;;;;;;;AACF;;;;;;;;;gCASmBF,O,EAA6C;AAAA;;AAAA,UAApCC,WAAoC,uEAAtB,IAAsB;AAAA,UAAhByZ,OAAgB,uEAAN,IAAM;AAC5Dhb,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;;AAEA,UAAGsB,WAAW,KAAK,GAAnB,EAAwB;AAAEA,mBAAW,GAAG,IAAd;AAAqB;;AAE/C,UAAI0Z,MAAM,GAAG,UAAU3Z,OAAV,GAAoB,GAAjC;;AAEA,UAAGC,WAAH,EAAgB;AACZ0Z,cAAM,IAAI1Z,WAAW,GAAG,GAAxB;AACH;;AAED0Z,YAAM,IAAI,UAAV;;AAEA,UAAGD,OAAH,EAAY;AACRC,cAAM,IAAI,MAAMD,OAAhB;AACH;;AAED,aAAO5a,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCwU,aAAhC,CAA8C,KAA9C,EAAqD2F,MAArD,EAEP;AAFO,OAGNpa,IAHM,CAGD,UAACqa,QAAD,EAAc;AAChB,aAAI,CAACC,WAAL,CAAiB7Z,OAAjB,EAA0BC,WAA1B,EAAuCyZ,OAAvC,EAAgDE,QAAhD;;AAEA,eAAOvb,OAAO,CAACC,OAAR,CAAgBsb,QAAQ,IAAI,EAA5B,CAAP;AACH,OAPM,CAAP;AAQH;AAED;;;;;;;;;;qCAOwB5Z,O,EAA6C;AAAA,UAApCC,WAAoC,uEAAtB,IAAsB;AAAA,UAAhByZ,OAAgB,uEAAN,IAAM;AACjEhb,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;;AAEA,UAAGsB,WAAW,KAAK,GAAnB,EAAwB;AAAEA,mBAAW,GAAG,IAAd;AAAqB;;AAE/C,WAAK6Z,KAAL,GAAa,KAAKA,KAAL,IAAc,EAA3B;AACA,WAAKA,KAAL,CAAW9Z,OAAX,IAAsB,KAAK8Z,KAAL,CAAW9Z,OAAX,KAAuB,EAA7C;;AAEA,UAAGC,WAAH,EAAgB;AACZ,aAAK6Z,KAAL,CAAW9Z,OAAX,EAAoBC,WAApB,IAAmC,KAAK6Z,KAAL,CAAW9Z,OAAX,EAAoBC,WAApB,KAAoC,EAAvE;;AAEA,YAAGyZ,OAAH,EAAY;AACR,eAAKI,KAAL,CAAW9Z,OAAX,EAAoBC,WAApB,EAAiCyZ,OAAjC,IAA4C,KAAKI,KAAL,CAAW9Z,OAAX,EAAoBC,WAApB,EAAiCyZ,OAAjC,KAA6C,EAAzF;AACH;AAEJ,OAPD,MAOO,IAAGA,OAAH,EAAY;AACf,aAAKI,KAAL,CAAW9Z,OAAX,EAAoB0Z,OAApB,IAA+B,KAAKI,KAAL,CAAW9Z,OAAX,EAAoB0Z,OAApB,KAAgC,EAA/D;AAEH;AACJ;AAED;;;;;;;;;;;gCAQmB1Z,O,EAAuD;AAAA,UAA9CC,WAA8C,uEAAhC,IAAgC;AAAA,UAA1ByZ,OAA0B,uEAAhB,IAAgB;AAAA,UAAVE,QAAU;AACtElb,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACkb,QAAD,EAAW,UAAX,EAAuBhD,MAAvB,CAAV;;AAEA,UAAG3W,WAAW,KAAK,GAAnB,EAAwB;AAAEA,mBAAW,GAAG,IAAd;AAAqB;;AAE/C,WAAK8Z,gBAAL,CAAsB/Z,OAAtB,EAA+BC,WAA/B,EAA4CyZ,OAA5C;;AAEA,UAAGzZ,WAAW,IAAI,CAACyZ,OAAnB,EAA4B;AACxB,eAAO,KAAKI,KAAL,CAAW9Z,OAAX,EAAoBC,WAApB,IAAmC2Z,QAA1C;AACH;;AAED,UAAG,CAAC3Z,WAAD,IAAgByZ,OAAnB,EAA4B;AACxB,eAAO,KAAKI,KAAL,CAAW9Z,OAAX,EAAoB0Z,OAApB,IAA+BE,QAAtC;AACH;;AAED,UAAG3Z,WAAW,IAAIyZ,OAAlB,EAA2B;AACvB,eAAO,KAAKI,KAAL,CAAW9Z,OAAX,EAAoBC,WAApB,EAAiCyZ,OAAjC,IAA4CE,QAAnD;AACH;;AAED,aAAO,KAAKE,KAAL,CAAW9Z,OAAX,IAAsB4Z,QAA7B;AACH;AAED;;;;;;;;;;sCAOyB5Z,O,EAA6C;AAAA,UAApCC,WAAoC,uEAAtB,IAAsB;AAAA,UAAhByZ,OAAgB,uEAAN,IAAM;AAClEhb,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;;AAEA,UAAGsB,WAAW,KAAK,GAAnB,EAAwB;AAAEA,mBAAW,GAAG,IAAd;AAAqB;;AAE/C,WAAK8Z,gBAAL,CAAsB/Z,OAAtB,EAA+BC,WAA/B,EAA4CyZ,OAA5C;;AAEA,UAAGzZ,WAAH,EAAgB;AACZ,YAAGyZ,OAAH,EAAY;AACR,iBAAO,KAAKI,KAAL,CAAW9Z,OAAX,EAAoBC,WAApB,EAAiCyZ,OAAjC,CAAP;AACH;;AAED,eAAO,KAAKI,KAAL,CAAW9Z,OAAX,EAAoBC,WAApB,CAAP;AACH;;AAED,UAAGyZ,OAAH,EAAY;AACR,eAAO,KAAKI,KAAL,CAAW9Z,OAAX,EAAoB0Z,OAApB,CAAP;AACH;;AAED,aAAO,KAAKI,KAAL,CAAW9Z,OAAX,CAAP;AACH;AAED;;;;;;;;;;;;;gCAUmBA,O,EAAuD;AAAA;;AAAA,UAA9CC,WAA8C,uEAAhC,IAAgC;AAAA,UAA1ByZ,OAA0B,uEAAhB,IAAgB;AAAA,UAAVE,QAAU;AACtElb,gBAAU,CAACsB,OAAD,EAAU,SAAV,EAAqBrB,MAArB,CAAV;AACAD,gBAAU,CAACkb,QAAD,EAAW,UAAX,EAAuBhD,MAAvB,CAAV;;AAEA,UAAG3W,WAAW,KAAK,GAAnB,EAAwB;AAAEA,mBAAW,GAAG,IAAd;AAAqB;;AAE/C,UAAI0Z,MAAM,GAAG,UAAU3Z,OAAV,GAAoB,GAAjC;AAEA4Z,cAAQ,CAACI,MAAT,GAAkB,SAAlB;;AAEA,UAAG/Z,WAAH,EAAgB;AACZ0Z,cAAM,IAAI1Z,WAAW,GAAG,GAAxB;AAEA2Z,gBAAQ,CAACI,MAAT,GAAkB/Z,WAAlB;AACH;;AAED0Z,YAAM,IAAI,UAAV;;AAEA,UAAGD,OAAH,EAAY;AACRC,cAAM,IAAI,MAAMD,OAAhB;AACH;;AAED,aAAO5a,SAAS,CAACC,OAAV,CAAkBS,aAAlB,CAAgCwU,aAAhC,CAA8C,MAA9C,EAAsD2F,MAAtD,EAA8DC,QAA9D,EAEP;AAFO,OAGNra,IAHM,CAGD,YAAM;AACR,cAAI,CAACsa,WAAL,CAAiB7Z,OAAjB,EAA0BC,WAA1B,EAAuCyZ,OAAvC,EAAgDE,QAAhD;;AAEA,eAAOvb,OAAO,CAACC,OAAR,EAAP;AACH,OAPM,CAAP;AAQH;;;;EArKwBmb,oB;;AAwK7B3Z,MAAM,CAACC,OAAP,GAAiBG,cAAjB,C;;;;;;;ACjLa;AAEb;;;;;;;;IAKMA,c;;;;AAGNJ,MAAM,CAACC,OAAP,GAAiBG,cAAjB,C;;;;;;;ACVa;AAEb;;;;;;;;;;;;IAKM+Z,Q;;;;;;;;;;AACF;;;;;;;;;;8BAUiBrM,O,EAASsM,K,EAAyC;AAAA,UAAlCC,SAAkC,uEAAtB,OAAsB;AAAA,UAAbC,WAAa;;AAC/D,UAAGxM,OAAO,KAAK,KAAf,EAAsB;AAClBwF,SAAC,CAAC,oBAAD,CAAD,CAAwBjG,MAAxB;AAEA;AACH;;AAED,UAAG,OAAOS,OAAP,KAAmB,QAAtB,EAAgC;AAC5BA,eAAO,GAAGxL,QAAQ,CAACC,aAAT,CAAuBuL,OAAvB,CAAV;AACH;;AAED,UAAG,CAACA,OAAJ,EAAa;AAAE,eAAOvP,OAAO,CAACC,OAAR,EAAP;AAA2B;;AAE1C,aAAO,IAAID,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC5B,YAAI+b,OAAO,GAAG,SAAVA,OAAU,GAAM;AAChBC,oBAAU,CAACnN,MAAX;AAEA7O,iBAAO,CAACsP,OAAD,CAAP;AACH,SAJD;;AAMA,YAAI0M,UAAU,GAAGlE,CAAC,CAACC,GAAF,CAAM;AAACC,eAAK,EAAE,uBAAuB4D,KAAK,GAAG,MAAMC,SAAT,GAAqB,EAAjD,CAAR;AAA8DI,eAAK,EAAE,UAAU3M,OAAO,CAAC4M,SAAlB,GAA8B,YAA9B,GAA6C5M,OAAO,CAAC6M,UAArD,GAAkE;AAAvI,SAAN,EACbrE,CAAC,CAACC,GAAF,CAAM;AAACC,eAAK,EAAE;AAAR,SAAN,CADa,EAEbF,CAAC,CAACC,GAAF,CAAM;AAACC,eAAK,EAAE,0BAAR;AAAoCiE,eAAK,EAAE,YAAY3M,OAAO,CAAC8M,WAApB,GAAkC,cAAlC,GAAmD9M,OAAO,CAAC+M,YAA3D,GAA0E;AAArH,SAAN,CAFa,EAGbvE,CAAC,CAACwE,EAAF,CAAKV,KAAL,EACI9D,CAAC,CAACC,GAAF,CAAM;AAACC,eAAK,EAAE;AAAR,SAAN,EACIF,CAAC,CAACC,GAAF,CAAM;AAACC,eAAK,EAAE;AAAR,SAAN,EAAiD4D,KAAjD,CADJ,EAEI9D,CAAC,CAACwE,EAAF,CAAKR,WAAL,EACIhE,CAAC,CAACyE,MAAF,CAAS;AAACvE,eAAK,EAAE;AAAR,SAAT,EAA+E8D,WAA/E,EACKU,KADL,CACW,YAAM;AACTT,iBAAO;AACV,SAHL,CADJ,CAFJ,CADJ,CAHa,EAcfS,KAde,CAcT,YAAM;AACV,cAAGV,WAAH,EAAgB;AAAE;AAAS;;AAE3BC,iBAAO;AACV,SAlBgB,CAAjB;;AAoBAjE,SAAC,CAAC/K,MAAF,CAASuC,OAAO,CAACmN,aAAjB,EAAgCT,UAAhC;AACH,OA5BM,CAAP;AA6BH;AAED;;;;;;;;;0CAM6B5Z,O,EAAS6J,S,EAAW;AAC7C,UAAIyQ,MAAM,GAAG5H,CAAC,CAAC,mCAAD,CAAd;;AAEA,UAAG7I,SAAH,EAAc;AACV7J,eAAO,GAAG0V,CAAC,CAACC,GAAF,CAAM;AAACC,eAAK,EAAE,uCAAuC/L;AAA/C,SAAN,EAAiE7J,OAAjE,CAAV;AACH;;AAED0V,OAAC,CAAC/K,MAAF,CAAS2P,MAAM,CAAC/E,KAAP,EAAT,EAAyBvV,OAAzB;AACH;AAED;;;;;;;;;;uCAO0BqM,K,EAAOkO,K,EAAOC,Q,EAAU;AAC9CnO,WAAK,GAAGA,KAAK,IAAI,EAAjB,CAD8C,CAG9C;;AACA,UAAIoO,KAAK,GAAGF,KAAK,CAAC5Y,aAAN,CAAoB,uBAApB,EAA6C0H,QAAzD;;AAEA,WAAI,IAAInL,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGuc,KAAK,CAAC7T,MAAzB,EAAiC1I,CAAC,EAAlC,EAAsC;AAClC,YAAGuc,KAAK,CAACvc,CAAD,CAAL,YAAoBwc,WAApB,KAAoC,KAApC,IAA6C,CAACD,KAAK,CAACvc,CAAD,CAAL,CAASyc,SAAT,CAAmBC,QAAnB,CAA4B,eAA5B,CAAjD,EAA+F;AAAE;AAAW;;AAE5GH,aAAK,CAACvc,CAAD,CAAL,CAAS2c,OAAT,CAAiB3R,KAAjB,GAAyBhL,CAAzB;AACH,OAV6C,CAY9C;;;AACA,WAAK4c,aAAL,CAAmBP,KAAnB,EAA0B,UAACrN,OAAD,EAAa;AACnC,YAAG,CAACA,OAAJ,EAAa;AAAE;AAAS;;AAExB,YAAI6N,QAAQ,GAAG7N,OAAO,CAAC2N,OAAR,CAAgB3R,KAA/B;AACA,YAAIhI,QAAQ,GAAG,CAAf,CAJmC,CAMnC;;AACA,YAAIuZ,KAAK,GAAGF,KAAK,CAAC5Y,aAAN,CAAoB,uBAApB,EAA6C0H,QAAzD;;AAEA,aAAI,IAAInL,EAAC,GAAG,CAAZ,EAAeA,EAAC,GAAGuc,KAAK,CAAC7T,MAAzB,EAAiC1I,EAAC,EAAlC,EAAsC;AAClC,cAAGuc,KAAK,CAACvc,EAAD,CAAL,KAAagP,OAAhB,EAAyB;AACrBhM,oBAAQ,GAAGhD,EAAX;AACA;AACH;AACJ,SAdkC,CAgBnC;;;AACAmO,aAAK,CAAC2O,MAAN,CAAa9Z,QAAb,EAAuB,CAAvB,EAA0BmL,KAAK,CAAC2O,MAAN,CAAaD,QAAb,EAAuB,CAAvB,EAA0B,CAA1B,CAA1B;AAEAP,gBAAQ,CAACnO,KAAD,CAAR;AACH,OApBD;AAqBH;AAED;;;;;;;;;;wCAO2B4I,M,EAAQsF,K,EAAOC,Q,EAAU;AAChDvF,YAAM,GAAGA,MAAM,IAAI,EAAnB;AAEA,WAAK6F,aAAL,CAAmBP,KAAnB,EAA0B,UAACrN,OAAD,EAAa;AACnC,YAAG,CAACA,OAAJ,EAAa;AAAE;AAAS;;AAExB,YAAI+N,kBAAkB,GAAG/N,OAAO,CAACvL,aAAR,CAAsB,0BAAtB,CAAzB;AACA,YAAIuZ,OAAO,GAAGD,kBAAkB,CAAC9a,KAAnB,IAA4B8a,kBAAkB,CAACE,SAA7D;AACA,YAAIC,SAAS,GAAGnG,MAAM,CAACiG,OAAD,CAAtB,CALmC,CAOnC;;AACA,YAAIG,OAAO,GAAG,EAAd;AACA,YAAIC,kBAAkB,GAAGpO,OAAO,CAACqO,kBAAR,GAA6BrO,OAAO,CAACqO,kBAAR,CAA2B5Z,aAA3B,CAAyC,0BAAzC,CAA7B,GAAoG,IAA7H;;AAEA,YAAG2Z,kBAAH,EAAuB;AACnBD,iBAAO,GAAGC,kBAAkB,CAACnb,KAAnB,IAA4Bmb,kBAAkB,CAACH,SAAzD;AACH,SAbkC,CAenC;;;AACA,YAAIK,SAAS,GAAG,EAAhB;;AAEA,aAAI,IAAIC,QAAR,IAAoBxG,MAApB,EAA4B;AACxB;AACA,cAAGwG,QAAQ,KAAKP,OAAhB,EAAyB;AAAE;AAAW;;AAEtC,cAAIQ,UAAU,GAAGzG,MAAM,CAACwG,QAAD,CAAvB,CAJwB,CAMxB;AACA;;AACA,cAAGJ,OAAO,KAAKI,QAAf,EAAyB;AACrBD,qBAAS,CAACN,OAAD,CAAT,GAAqBE,SAArB;AACH;;AAEDI,mBAAS,CAACC,QAAD,CAAT,GAAsBC,UAAtB;AACH,SA/BkC,CAiCnC;;;AACA,YAAG,CAACF,SAAS,CAACN,OAAD,CAAb,EAAwB;AACpBM,mBAAS,CAACN,OAAD,CAAT,GAAqBE,SAArB;AACH,SApCkC,CAsCnC;;;AACAnG,cAAM,GAAGuG,SAAT,CAvCmC,CAyCnC;;AACAhB,gBAAQ,CAACgB,SAAD,CAAR;AACH,OA3CD;AA4CH;AAED;;;;;;;;;kCAMqBjB,K,EAAOC,Q,EAAU;AAClC,UAAImB,OAAO,GAAGpB,KAAK,CAAC5Y,aAAN,CAAoB,mCAApB,CAAd;AACA,UAAIia,QAAQ,GAAGrB,KAAK,CAAC5Y,aAAN,CAAoB,uBAApB,CAAf;AACA,UAAIka,SAAS,GAAG,CAACD,QAAQ,CAACjB,SAAT,CAAmBC,QAAnB,CAA4B,SAA5B,CAAjB;;AAEA,UAAG,KAAKkB,QAAL,CAAcF,QAAd,EAAwB,eAAxB,EAAyCC,SAAzC,EAAoDrB,QAApD,CAAH,EAAkE;AAC9DmB,eAAO,CAAChB,SAAR,CAAkBoB,MAAlB,CAAyB,SAAzB,EAAoCF,SAApC;AACAD,gBAAQ,CAACjB,SAAT,CAAmBoB,MAAnB,CAA0B,SAA1B,EAAqCF,SAArC;AACH;AACJ;AAED;;;;;;;;;;;;;6BAUgBxB,a,EAAe2B,iB,EAAmBC,Q,EAAUzB,Q,EAAU;AAClE,UAAInR,QAAQ,GAAGtD,KAAK,CAACoD,SAAN,CAAgB+S,KAAhB,CAAsB9S,IAAtB,CAA2BiR,aAAa,CAAChR,QAAd,IAA0B,EAArD,CAAf;AACA,UAAI8S,OAAO,GAAG,IAAd;AACA,UAAIC,mBAAJ;AAEA/S,cAAQ,GAAGA,QAAQ,CAACrI,MAAT,CAAgB,UAACqb,KAAD,EAAW;AAClC,eAAOA,KAAK,YAAY3B,WAAjB,IAAgC2B,KAAK,CAAC1B,SAAN,CAAgBC,QAAhB,CAAyBoB,iBAAzB,CAAvC;AACH,OAFU,CAAX;;AAIA,UAAG,CAAC3S,QAAD,IAAaA,QAAQ,CAACzC,MAAT,GAAkB,CAAlC,EAAqC;AAAE,eAAO,KAAP;AAAe;;AAEtD,UAAG,OAAOqV,QAAP,KAAoB,WAAvB,EAAoC;AAChCA,gBAAQ,GAAG,CAAC5B,aAAa,CAACM,SAAd,CAAwBC,QAAxB,CAAiC,SAAjC,CAAZ;AACH;;AAED,UAAGqB,QAAH,EAAa;AACT5B,qBAAa,CAACiC,UAAd,GAA2B,UAACxY,CAAD,EAAO;AAC9B,cAAG,CAACqY,OAAD,IAAY,CAACC,mBAAhB,EAAqC;AAAE;AAAS;;AAEhD,cAAIG,QAAQ,GAAG7a,QAAQ,CAAC8a,IAAT,CAAcC,qBAAd,EAAf;;AAEA/G,WAAC,CAACgH,IAAF,CAAOrT,QAAP,EAAiB,UAACnL,CAAD,EAAI6R,OAAJ,EAAgB;AAC7B,gBAAGA,OAAO,KAAKqM,mBAAZ,IAAmC,CAACD,OAApC,IAA+CrY,CAAC,CAAC6Y,KAAF,GAAU,CAA5D,EAA+D;AAAE;AAAS;;AAE1E,gBAAIC,OAAO,GAAG9Y,CAAC,CAAC6Y,KAAhB;AACA,gBAAIE,MAAM,GAAGT,mBAAmB,CAACK,qBAApB,GAA4CK,CAA5C,GAAgDP,QAAQ,CAACO,CAAtE;AACA,gBAAIC,QAAQ,GAAGhN,OAAO,CAAC0M,qBAAR,GAAgCK,CAAhC,GAAoCP,QAAQ,CAACO,CAA5D;AACA,gBAAIE,QAAQ,GAAG,KAAf,CAN6B,CAQ7B;;AACA,gBAAGJ,OAAO,GAAGG,QAAV,IAAsBF,MAAM,GAAGE,QAAlC,EAA4C;AACxChN,qBAAO,CAACsK,aAAR,CAAsB4C,YAAtB,CAAmCb,mBAAnC,EAAwDrM,OAAxD;AACAiN,sBAAQ,GAAG,IAAX;AACH,aAZ4B,CAc7B;;;AACA,gBAAGJ,OAAO,GAAGG,QAAV,IAAsBF,MAAM,GAAGE,QAAlC,EAA4C;AACxChN,qBAAO,CAACsK,aAAR,CAAsB4C,YAAtB,CAAmCb,mBAAnC,EAAwDrM,OAAO,CAACwL,kBAAhE;AACAyB,sBAAQ,GAAG,IAAX;AACH,aAlB4B,CAoB7B;;;AACA,gBAAGA,QAAH,EAAa;AACTb,qBAAO,GAAG,KAAV;AAEA,kBAAIe,SAAS,GAAGd,mBAAmB,CAACK,qBAApB,GAA4CK,CAA5C,GAAgDpb,QAAQ,CAAC8a,IAAT,CAAcC,qBAAd,GAAsCK,CAAtG;AACA,kBAAIK,WAAW,GAAGpN,OAAO,CAAC0M,qBAAR,GAAgCK,CAAhC,GAAoCpb,QAAQ,CAAC8a,IAAT,CAAcC,qBAAd,GAAsCK,CAA5F;AAEAV,iCAAmB,CAACvC,KAApB,CAA0BuD,SAA1B,GAAsC,iBAAiBP,MAAM,GAAGK,SAA1B,IAAuC,KAA7E;AACAnN,qBAAO,CAAC8J,KAAR,CAAcuD,SAAd,GAA0B,iBAAiBL,QAAQ,GAAGI,WAA5B,IAA2C,KAArE;AAEA7b,wBAAU,CAAC,YAAM;AACb8a,mCAAmB,CAACiB,eAApB,CAAoC,OAApC;AACAtN,uBAAO,CAACsN,eAAR,CAAwB,OAAxB;AACAlB,uBAAO,GAAG,IAAV;AACH,eAJS,EAIP,GAJO,CAAV;AAKH;AACJ,WApCD;AAqCH,SA1CD;AA4CH,OA7CD,MA6CO;AACH9B,qBAAa,CAACiC,UAAd,GAA2B,IAA3B;AAEH;;AAED5G,OAAC,CAACgH,IAAF,CAAOrT,QAAP,EAAiB,UAACnL,CAAD,EAAIme,KAAJ,EAAc;AAC3BA,aAAK,CAACiB,SAAN,GAAkBrB,QAAlB;;AAEA,YAAGA,QAAH,EAAa;AACTI,eAAK,CAACkB,WAAN,GAAoB,UAACzZ,CAAD,EAAO;AACvBA,aAAC,CAAC0Z,YAAF,CAAeC,OAAf,CAAuB,YAAvB,EAAqC,EAArC;AACApB,iBAAK,CAAC1B,SAAN,CAAgBoB,MAAhB,CAAuB,UAAvB,EAAmC,IAAnC;AACAK,+BAAmB,GAAGC,KAAtB;AACH,WAJD;;AAMAA,eAAK,CAACqB,SAAN,GAAkB,UAAC5Z,CAAD,EAAO;AACrB0W,oBAAQ,CAAC6B,KAAD,CAAR;AACAD,+BAAmB,GAAG,IAAtB;AACAC,iBAAK,CAAC1B,SAAN,CAAgBoB,MAAhB,CAAuB,UAAvB,EAAmC,KAAnC;AACH,WAJD;;AAMAM,eAAK,CAACsB,YAAN,GAAqB,UAAC7Z,CAAD,EAAO;AACxB0W,oBAAQ,CAAC6B,KAAD,CAAR;AACAD,+BAAmB,GAAG,IAAtB;AACAC,iBAAK,CAAC1B,SAAN,CAAgBoB,MAAhB,CAAuB,UAAvB,EAAmC,KAAnC;AACH,WAJD;AAMH,SAnBD,MAmBO;AACHM,eAAK,CAAC1B,SAAN,CAAgBoB,MAAhB,CAAuB,UAAvB,EAAmC,KAAnC;AACAM,eAAK,CAACkB,WAAN,GAAoB,IAApB;AACAlB,eAAK,CAACuB,MAAN,GAAe,IAAf;AACAvB,eAAK,CAACwB,UAAN,GAAmB,IAAnB;AACAxB,eAAK,CAACsB,YAAN,GAAqB,IAArB;AACAvB,6BAAmB,GAAG,IAAtB;AACH;AACJ,OA9BD;;AAgCA/B,mBAAa,CAACM,SAAd,CAAwBoB,MAAxB,CAA+B,SAA/B,EAA0CE,QAA1C;AAEA,aAAO,IAAP;AACH;AAGD;;;;;;;;;;;gCAQmB6B,Y,EAActD,Q,EAAU;AACvC,UAAIzc,EAAE,GAAG,aAAa,QAAQggB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,KAA3B,CAArB,CAAT;AACA,UAAIC,MAAJ;;AAEA,UAAIC,QAAQ,GAAGzI,CAAC,CAACC,GAAF,CAAM;AAACC,aAAK,EAAE,QAAR;AAAkB,wBAAgBkI;AAAlC,OAAN,EACXI,MAAM,GAAGxI,CAAC,CAACzG,KAAF,CAAQ;AACblR,UAAE,EAAEA,EADS;AAEb6X,aAAK,EAAE,qBAFM;AAGblS,YAAI,EAAE;AAHO,OAAR,EAIN0a,MAJM,CAIC,YAAW;AACjB,aAAK/D,aAAL,CAAmBQ,OAAnB,CAA2BwD,OAA3B,GAAqC,KAAKA,OAA1C;;AAEA,YAAG7D,QAAH,EAAa;AACTA,kBAAQ,CAAC,KAAK6D,OAAN,CAAR;AACH;AACJ,OAVQ,CADE,EAYX3I,CAAC,CAAC8D,KAAF,CAAQ;AAAC8E,WAAG,EAAEvgB;AAAN,OAAR,CAZW,CAAf;;AAeAogB,cAAQ,CAACI,EAAT,CAAY,KAAZ,EAAmB,UAACza,CAAD,EAAI0a,QAAJ,EAAiB;AAChCN,cAAM,CAAC,CAAD,CAAN,CAAUG,OAAV,GAAoBG,QAApB;AACH,OAFD;;AAIA,UAAGV,YAAH,EAAiB;AACbI,cAAM,CAACO,IAAP,CAAY,SAAZ,EAAuB,IAAvB;AACH;;AAED,aAAON,QAAP;AACH;AAED;;;;;;;;;;;;;mCAUsB1D,K,EAAOiE,a,EAAelE,Q,EAAUmE,gB,EAAkB;AACpE,UAAIR,QAAQ,GAAGzI,CAAC,CAACC,GAAF,CAAM;AAACC,aAAK,EAAE;AAAR,OAAN,CAAf;;AAEA,UAAG,CAAC6E,KAAJ,EAAW;AAAEA,aAAK,GAAG,EAAR;AAAa;;AAE1B,eAASmE,MAAT,GAAkB;AACdlJ,SAAC,CAAC/K,MAAF,CAASwT,QAAQ,CAAC5I,KAAT,EAAT,EAEI;AACAG,SAAC,CAACgH,IAAF,CAAOjC,KAAP,EAAc,UAACoE,SAAD,EAAY7M,IAAZ,EAAqB;AAC/B,cAAIwH,KAAK,GAAGxH,IAAI,CAACwH,KAAL,IAAcxH,IAAI,CAACtP,IAAnB,IAA2BsP,IAAI,CAAC3H,KAA5C;;AAEA,cAAG,CAACmP,KAAJ,EAAW;AAAA;AAAA;AAAA;;AAAA;AACP,mCAAwBkF,aAAxB,8HAAuC;AAAA,oBAA/BI,YAA+B;AACnC,oBAAI3e,KAAK,GAAG2e,YAAY,CAAC/gB,EAAb,IAAmB+gB,YAAY,CAAC3e,KAAhC,IAAyC2e,YAArD;;AAEA,oBAAG3e,KAAK,KAAK6R,IAAb,EAAmB;AACfwH,uBAAK,GAAGsF,YAAY,CAACtF,KAAb,IAAsBsF,YAAY,CAACpc,IAAnC,IAA2Coc,YAAY,CAACzU,KAAxD,IAAiEyU,YAAzE;AACH;AACJ;AAPM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQV;;AAED,cAAG,CAACtF,KAAJ,EAAW;AACPA,iBAAK,GAAGxH,IAAR;AACH;;AAED,cAAI+M,KAAK,GAAGrJ,CAAC,CAACC,GAAF,CAAM;AAACC,iBAAK,EAAE;AAAR,WAAN,EAER;AACAF,WAAC,CAACwE,EAAF,CAAKnU,KAAK,CAACC,OAAN,CAAc0Y,aAAd,CAAL,EACIhJ,CAAC,CAACC,GAAF,CAAM;AAACC,iBAAK,EAAE;AAAR,WAAN,EACIF,CAAC,CAACyE,MAAF,CAAS;AAACvE,iBAAK,EAAE,iBAAR;AAA2B,2BAAe;AAA1C,WAAT,EACI4D,KADJ,CADJ,EAII9D,CAAC,CAACwE,EAAF,CAAKM,QAAL,EACI9E,CAAC,CAACsJ,EAAF,CAAK;AAACpJ,iBAAK,EAAE;AAAR,WAAL,EACIF,CAAC,CAACgH,IAAF,CAAOgC,aAAP,EAAsB,UAACO,iBAAD,EAAoBH,YAApB,EAAqC;AACvD;AACA,gBAAGH,gBAAH,EAAqB;AAAA;AAAA;AAAA;;AAAA;AACjB,sCAAgBlE,KAAhB,mIAAuB;AAAA,sBAAfzI,KAAe;;AACnB,sBAAGA,KAAI,IAAI8M,YAAX,EAAyB;AACrB;AACH;AACJ;AALgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMpB;;AAED,mBAAOpJ,CAAC,CAACwJ,EAAF,CACHxJ,CAAC,CAACyJ,CAAF,CAAI;AAAC/U,kBAAI,EAAE;AAAP,aAAJ,EACI0U,YAAY,CAACtF,KAAb,IAAsBsF,YAAY,CAACpc,IAAnC,IAA2Coc,YAAY,CAACzU,KAAxD,IAAiEyU,YADrE,EAEE1E,KAFF,CAEQ,UAAStW,CAAT,EAAY;AAChBA,eAAC,CAACsb,cAAF;AAEA3E,mBAAK,CAACoE,SAAD,CAAL,GAAmBC,YAAY,CAAC3e,KAAb,IAAsB2e,YAAY,CAAC/gB,EAAnC,IAAyC+gB,YAA5D;AAEAF,oBAAM;;AAEN,kBAAG,OAAOpE,QAAP,KAAoB,UAAvB,EAAmC;AAC/BA,wBAAQ,CAACC,KAAD,CAAR;AACH;AACJ,aAZD,CADG,CAAP;AAeH,WAzBD,CADJ,CADJ,CAJJ,CADJ,CAHQ,EAyCR;AACA/E,WAAC,CAACwE,EAAF,CAAK,CAACnU,KAAK,CAACC,OAAN,CAAc0Y,aAAd,CAAN,EACIhJ,CAAC,CAACwE,EAAF,CAAK,CAACM,QAAN,EACI9E,CAAC,CAAC2J,CAAF,CAAI;AAACzJ,iBAAK,EAAE;AAAR,WAAJ,EAA2B5D,IAA3B,CADJ,CADJ,EAII0D,CAAC,CAACwE,EAAF,CAAKM,QAAL,EACI9E,CAAC,CAACzG,KAAF,CAAQ;AAACvL,gBAAI,EAAE,MAAP;AAAekS,iBAAK,EAAE,YAAtB;AAAoCzV,iBAAK,EAAE6R;AAA3C,WAAR,EACKoM,MADL,CACY,UAACta,CAAD,EAAO;AACX2W,iBAAK,CAACoE,SAAD,CAAL,GAAmB/a,CAAC,CAACuS,MAAF,CAASlW,KAA5B;AACH,WAHL,CADJ,CAJJ,CA1CQ,EAsDR;AACAuV,WAAC,CAACwE,EAAF,CAAKM,QAAL,EACI9E,CAAC,CAACyE,MAAF,CAAS;AAACvE,iBAAK,EAAE;AAAR,WAAT,EACIF,CAAC,CAAC4J,IAAF,CAAO;AAAC1J,iBAAK,EAAE;AAAR,WAAP,CADJ,EAEEwE,KAFF,CAEQ,YAAM;AACVK,iBAAK,CAACO,MAAN,CAAa6D,SAAb,EAAwB,CAAxB;AAEAD,kBAAM;;AAEN,gBAAG,OAAOpE,QAAP,KAAoB,UAAvB,EAAmC;AAC/BA,sBAAQ,CAACC,KAAD,CAAR;AACH;AACJ,WAVD,CADJ,CAvDQ,CAAZ;;AAsEA,iBAAOsE,KAAP;AACH,SAxFD,CAHJ,EA6FI;AACArJ,SAAC,CAACwE,EAAF,CAAKM,QAAL,EACI9E,CAAC,CAACyE,MAAF,CAAS;AAACvE,eAAK,EAAE;AAAR,SAAT,EACIF,CAAC,CAAC4J,IAAF,CAAO;AAAC1J,eAAK,EAAE;AAAR,SAAP,CADJ,EAEEwE,KAFF,CAEQ,YAAM;AACV,cAAGrU,KAAK,CAACC,OAAN,CAAc0Y,aAAd,CAAH,EAAiC;AAC7B,gBAAGC,gBAAH,EAAqB;AAAA;AAAA;AAAA;;AAAA;AACjB,sCAAwBD,aAAxB,mIAAuC;AAAA,sBAA/BI,YAA+B;AACnC,sBAAIS,UAAU,GAAG,KAAjB;AADmC;AAAA;AAAA;;AAAA;AAGnC,0CAAgB9E,KAAhB,mIAAuB;AAAA,0BAAfzI,IAAe;;AACnB,0BAAGA,IAAI,IAAI8M,YAAX,EAAyB;AACrBS,kCAAU,GAAG,IAAb;AACA;AACH;AACJ;AARkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAUnC,sBAAG,CAACA,UAAJ,EAAgB;AACZ9E,yBAAK,CAAC/P,IAAN,CAAWoU,YAAY,CAAC3e,KAAb,IAAsB2e,YAAjC;AACA;AACH;AACJ;AAfgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBpB,aAhBD,MAgBO;AACHrE,mBAAK,CAAC/P,IAAN,CAAWgU,aAAa,CAAC,CAAD,CAAb,CAAiBve,KAAjB,IAA0Bue,aAAa,CAAC,CAAD,CAAlD;AACH;AAEJ,WArBD,MAqBO,IAAG,OAAOA,aAAP,KAAyB,QAA5B,EAAsC;AACzCjE,iBAAK,CAAC/P,IAAN,CAAWgU,aAAX;AAEH,WAHM,MAGA;AACHjE,iBAAK,CAAC/P,IAAN,CAAW,UAAX;AAEH;;AAEDkU,gBAAM;;AAEN,cAAG,OAAOpE,QAAP,KAAoB,UAAvB,EAAmC;AAC/BA,oBAAQ,CAACC,KAAD,CAAR;AACH;AACJ,SArCD,CADJ,CA9FJ;AAuIH;;AAAA;AAEDmE,YAAM;AAEN,aAAOT,QAAP;AACH;AAED;;;;;;;;;;;;;6BAUgB1D,K,EAAO+E,a,EAAeC,W,EAAaC,M,EAAQ;AACvD,UAAI3hB,EAAE,GAAG,eAAe,QAAQggB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,KAA3B,CAAvB,CAAT;AAEA,aAAOvI,CAAC,CAACC,GAAF,CAAM;AAACC,aAAK,EAAE,gBAAR;AAA0B7X,UAAE,EAAEA,EAA9B;AAAkC,qBAAa,UAA/C;AAA2D,yBAAiB;AAA5E,OAAN,EACH2X,CAAC,CAACwE,EAAF,CAAKsF,aAAL,EACI9J,CAAC,CAACiK,EAAF,CAAK;AAAC/J,aAAK,EAAE;AAAR,OAAL,EACIF,CAAC,CAACgH,IAAF,CAAOjC,KAAP,EAAc,UAACvc,CAAD,EAAI8T,IAAJ,EAAa;AACvB,eAAO0D,CAAC,CAACwJ,EAAF,CAAK;AAAC,yBAAe,MAAMnhB,EAAtB;AAA0B,2BAAiBG,CAA3C;AAA8C0X,eAAK,EAAE1X,CAAC,IAAI,CAAL,GAAS,QAAT,GAAoB;AAAzE,SAAL,CAAP;AACH,OAFD,CADJ,CADJ,CADG,EAQHwX,CAAC,CAACC,GAAF,CAAM;AAACC,aAAK,EAAE,gBAAR;AAA0BgK,YAAI,EAAE;AAAhC,OAAN,EACIlK,CAAC,CAACgH,IAAF,CAAOjC,KAAP,EAAc,UAACvc,CAAD,EAAI8T,IAAJ,EAAa;AACvB,eAAO0D,CAAC,CAACC,GAAF,CAAM;AAACC,eAAK,EAAE,UAAU1X,CAAC,IAAI,CAAL,GAAQ,SAAR,GAAmB,EAA7B,CAAR;AAA0C2b,eAAK,EAAE,aAAa6F,MAAM,IAAI,OAAvB;AAAjD,SAAN,EACH1N,IADG,CAAP;AAGH,OAJD,CADJ,CARG,EAeH0D,CAAC,CAACwE,EAAF,CAAKuF,WAAL,EACI/J,CAAC,CAACyJ,CAAF,CAAI;AAAC/U,YAAI,EAAE,MAAMrM,EAAb;AAAiB6hB,YAAI,EAAE,QAAvB;AAAiChK,aAAK,EAAE,uBAAxC;AAAiE,sBAAc;AAA/E,OAAJ,EACIF,CAAC,CAAC4J,IAAF,CAAO;AAAC1J,aAAK,EAAE;AAAR,OAAP,CADJ,CADJ,EAIIF,CAAC,CAACyJ,CAAF,CAAI;AAAC/U,YAAI,EAAE,MAAMrM,EAAb;AAAiB6hB,YAAI,EAAE,QAAvB;AAAiChK,aAAK,EAAE,wBAAxC;AAAkE,sBAAc;AAAhF,OAAJ,EACIF,CAAC,CAAC4J,IAAF,CAAO;AAAC1J,aAAK,EAAE;AAAR,OAAP,CADJ,CAJJ,CAfG,CAAP;AAwBH;AAED;;;;;;;;;+BAMkBvQ,K,EAAOwa,S,EAAW;AAChC,UAAG,CAACxa,KAAJ,EAAW;AAAE;AAAS;;AAEtB,UAAGA,KAAK,YAAYpH,MAApB,EAA4B;AACxBoH,aAAK,GAAG,IAAI5C,KAAJ,CAAU4C,KAAV,CAAR;AAEH,OAHD,MAGO,IAAGA,KAAK,YAAY6Q,MAApB,EAA4B;AAC/B,YAAG7Q,KAAK,CAACuP,YAAT,EAAuB;AACnBvP,eAAK,GAAG,IAAI5C,KAAJ,CAAU4C,KAAK,CAACuP,YAAhB,CAAR;AACH;AAEJ,OALM,MAKA,IAAGvP,KAAK,YAAY5C,KAAjB,KAA2B,KAA9B,EAAqC;AACxC4C,aAAK,GAAG,IAAI5C,KAAJ,CAAU4C,KAAK,CAACF,QAAN,EAAV,CAAR;AAEH;;AAEDhC,WAAK,CAACC,GAAN,CAAUiC,KAAK,CAACxB,OAAhB,EAAyBwB,KAAK,CAACya,KAA/B,EAAsC,WAAtC;AAEA,aAAOvG,QAAQ,CAACxE,YAAT,CAAsB,2CAAtB,EAAmE1P,KAAK,CAACxB,OAAzE,EAAkFgc,SAAlF,EAA6F,OAA7F,CAAP;AACH;AAED;;;;;;;;;iCAMoBE,O,EAASF,S,EAAW;AACpC,UAAG,CAACE,OAAJ,EAAa;AAAE;AAAS;;AAExB,aAAOxG,QAAQ,CAACxE,YAAT,CAAsB,6CAAtB,EAAqEgL,OAArE,EAA8EF,SAA9E,EAAyF,SAAzF,CAAP;AACH;AAED;;;;;;;;;;;iCAQoBxV,K,EAAOmS,I,EAAMqD,S,EAAWG,K,EAAO;AAC/C,UAAIC,KAAK,GAAG,IAAI7hB,SAAS,CAACY,KAAV,CAAgBkhB,MAAhB,CAAuBC,KAA3B,CAAiC;AACzCC,kBAAU,EAAEP,SAAS,KAAK,KADe;AAEzCxV,aAAK,EAAEA,KAFkC;AAGzC2V,aAAK,EAAEA,KAHkC;AAIzCxD,YAAI,EAAEA;AAJmC,OAAjC,CAAZ;;AAOA,UAAGqD,SAAH,EAAc;AACVI,aAAK,CAAC1B,EAAN,CAAS,IAAT,EAAesB,SAAf;AACH;;AAED,aAAOI,KAAP;AACH;AAED;;;;;;;;;;;gCAQmB5V,K,EAAOgJ,G,EAAKgN,Q,EAAUC,Q,EAAU;AAC/C,UAAIL,KAAK,GAAG,IAAI7hB,SAAS,CAACY,KAAV,CAAgBkhB,MAAhB,CAAuBK,WAA3B,CAAuC;AAC/ClW,aAAK,EAAEA,KADwC;AAE/CgJ,WAAG,EAAEA;AAF0C,OAAvC,CAAZ;;AAKA,UAAG,OAAOgN,QAAP,KAAoB,UAAvB,EAAmC;AAC/BJ,aAAK,CAAC1B,EAAN,CAAS,IAAT,EAAe8B,QAAf;AACH;;AAED,UAAG,OAAOC,QAAP,KAAoB,UAAvB,EAAmC;AAC/BL,aAAK,CAAC1B,EAAN,CAAS,QAAT,EAAmB+B,QAAnB;AACH;;AAED,aAAOL,KAAP;AACH;AAED;;;;;;;;;;;iCAQoBvc,I,EAAM2G,K,EAAOmS,I,EAAM6D,Q,EAAUC,Q,EAAU;AACvD,UAAIL,KAAK,GAAG,IAAI7hB,SAAS,CAACY,KAAV,CAAgBkhB,MAAhB,CAAuBM,YAA3B,CAAwC;AAChD9c,YAAI,EAAEA,IAAI,GAAGA,IAAI,CAAC7B,WAAL,EAAH,GAAwB,IADc;AAEhDwI,aAAK,EAAEA,KAFyC;AAGhDmS,YAAI,EAAEA;AAH0C,OAAxC,CAAZ;AAMAyD,WAAK,CAAC1B,EAAN,CAAS,QAAT,EAAmB+B,QAAnB;AACAL,WAAK,CAAC1B,EAAN,CAAS,IAAT,EAAe8B,QAAf;AAEA,aAAOJ,KAAP;AACH;AAED;;;;;;4BAGe/S,O,EAASuN,K,EAAO;AAC3B,UAAIgG,eAAe,GAAG,SAAlBA,eAAkB,CAAC3c,CAAD,EAAO;AACzB;AACA,YAAI4c,YAAY,GAAG,SAAfA,YAAe,GAAM;AACrB,cAAIC,OAAO,GAAGjf,QAAQ,CAACkf,gBAAT,CAA0B,sBAA1B,CAAd;;AAEA,cAAGD,OAAH,EAAY;AACR,iBAAI,IAAIziB,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGyiB,OAAO,CAAC/Z,MAA3B,EAAmC1I,CAAC,EAApC,EAAwC;AACpCyiB,qBAAO,CAACziB,CAAD,CAAP,CAAWyc,SAAX,CAAqBlO,MAArB,CAA4B,qBAA5B;AACH;AACJ;AACJ,SARD;;AAUAiU,oBAAY,GAZa,CAczB;;AACAxT,eAAO,CAACyN,SAAR,CAAkBoB,MAAlB,CAAyB,qBAAzB,EAAgD,IAAhD,EAfyB,CAiBzB;;AACA,YAAI8E,YAAY,GAAGnL,CAAC,CAACoL,IAAF,CAAO,gCAAP,CAAnB;;AAEA,YAAGD,YAAH,EAAiB;AAAEA,sBAAY,CAACpU,MAAb;AAAwB,SApBlB,CAsBzB;;;AACA,YAAIsU,QAAQ,GAAG,IAAI3iB,SAAS,CAACY,KAAV,CAAgBgiB,OAAhB,CAAwBC,QAA5B,CAAqC;AAChDjZ,iBAAO,EAAEyS,KADuC;AAEhDyG,qBAAW,EAAE,IAFmC;AAGhD1G,kBAAQ,EAAE,kBAAC2G,UAAD,EAAgB;AACtB,gBAAG,OAAOA,UAAP,KAAsB,UAAzB,EAAqC;AAAE;AAAS;;AAEhDA,sBAAU;AACb;AAP+C,SAArC,CAAf,CAvByB,CAiCzB;;AACA,YAAIpF,MAAM,GAAGgF,QAAQ,CAAC7T,OAAT,CAAiBvL,aAAjB,CAA+B,2BAA/B,CAAb;AAEAoa,cAAM,CAACzJ,gBAAP,CAAwB,aAAxB,EAAuC,UAACxO,CAAD,EAAO;AAC1CA,WAAC,CAACsb,cAAF;AACA2B,kBAAQ,CAAChF,MAAT,CAAgB,KAAhB;AACH,SAHD,EApCyB,CAyCzB;;AACAgF,gBAAQ,CAACxC,EAAT,CAAY,QAAZ,EAAsB,YAAM;AACxBwC,kBAAQ,CAACtU,MAAT,GADwB,CAGxB;;AACAnL,oBAAU,CAAC,YAAM;AACbof,wBAAY;AACf,WAFS,EAEP,GAFO,CAAV;AAGH,SAPD,EA1CyB,CAmDzB;;AACAK,gBAAQ,CAAC7T,OAAT,CAAiByN,SAAjB,CAA2BoB,MAA3B,CAAkC,cAAlC,EAAkD,IAAlD;AACAgF,gBAAQ,CAAC7T,OAAT,CAAiB2M,KAAjB,CAAuBuH,GAAvB,GAA6Btd,CAAC,CAACud,OAAF,GAAYvd,CAAC,CAACud,OAAF,CAAU,CAAV,EAAa1E,KAAzB,GAAiC7Y,CAAC,CAAC6Y,KAAhE;AACAoE,gBAAQ,CAAC7T,OAAT,CAAiB2M,KAAjB,CAAuByH,IAAvB,GAA8Bxd,CAAC,CAACud,OAAF,GAAYvd,CAAC,CAACud,OAAF,CAAU,CAAV,EAAaE,KAAzB,GAAiCzd,CAAC,CAACyd,KAAjE,CAtDyB,CAwDzB;;AACAR,gBAAQ,CAAChF,MAAT,CAAgB,IAAhB,EAzDyB,CA2DzB;;AACAra,gBAAQ,CAAC8a,IAAT,CAAcgF,WAAd,CAA0BT,QAAQ,CAAC7T,OAAnC;AACH,OA7DD;;AA+DAA,aAAO,CAACoF,gBAAR,CAAyB,aAAzB,EAAwC,UAACxO,CAAD,EAAO;AAC3CA,SAAC,CAACsb,cAAF;AACAtb,SAAC,CAAC2d,eAAF;AAEAhB,uBAAe,CAAC3c,CAAD,CAAf;AACH,OALD;AAOAoJ,aAAO,CAACoF,gBAAR,CAAyB,OAAzB,EAAkC,UAACxO,CAAD,EAAO;AACrC,YAAGA,CAAC,CAAC4d,KAAF,KAAY,CAAZ,IAAiB5d,CAAC,CAAC6d,OAAtB,EAA+B;AAC3B7d,WAAC,CAACsb,cAAF;AACAtb,WAAC,CAAC2d,eAAF;AAEAhB,yBAAe,CAAC3c,CAAD,CAAf;AACH;AACJ,OAPD;AASAoJ,aAAO,CAACoF,gBAAR,CAAyB,YAAzB,EAAuC,UAACxO,CAAD,EAAO;AAC1C,YAAGA,CAAC,CAAC8d,YAAF,IAAkB9d,CAAC,CAAC8d,YAAF,CAAehb,MAAf,GAAwB,CAA7C,EAAgD;AAC5C9C,WAAC,CAACsb,cAAF;AACAtb,WAAC,CAAC2d,eAAF;AAEAhB,yBAAe,CAAC3c,CAAD,CAAf;AACH;AACJ,OAPD;AAQH;;;;;;AAGL1E,MAAM,CAACC,OAAP,GAAiBka,QAAjB,C","file":"helpers.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","'use strict';\n\n/**\n * @namespace HashBrown.Client.Helpers\n */\nnamespace('Helpers')\n.add(require('./ConnectionHelper'))\n.add(require('./ContentHelper'))\n.add(require('./DebugHelper'))\n.add(require('./LanguageHelper'))\n.add(require('./MarkdownHelper'))\n.add(require('./MediaHelper'))\n.add(require('./ProjectHelper'))\n.add(require('./RequestHelper'))\n.add(require('./ResourceHelper'))\n.add(require('./SchemaHelper'))\n.add(require('./SettingsHelper'))\n.add(require('./UIHelper'));\n","'use strict';\n\nconst ConnectionHelperCommon = require('Common/Helpers/ConnectionHelper');\n\n/**\n * The client side connection helper\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass ConnectionHelper extends ConnectionHelperCommon {\n    /**\n     * Gets all connections\n     *\n     * @return {Promise} Array of Connections\n     */\n    static getAllConnections() {\n        return Promise.resolve(resources.connections);\n    }\n    \n    /**\n     * Gets a Connection by id (sync)\n     *\n     * @param {string} id\n     *\n     * @return {Promise} Connection\n     */\n    static getConnectionByIdSync(id) {\n        checkParam(id, 'id', String);\n\n        for(let i in resources.connections) {\n            let connection = resources.connections[i];\n\n            if(connection.id == id) {\n                return connection;\n            }\n        }\n    }\n    \n    /**\n     * Gets a Connection by id\n     *\n     * @param {String} id\n     *\n     * @return {Promise} Connection\n     */\n    static getConnectionById(id) {\n        if(!id) { return Promise.resolve(null); }\n\n        return HashBrown.Helpers.ResourceHelper.get(HashBrown.Models.Connection, 'connections', id);\n    }\n\n    /**\n     * Sets the Media provider\n     *\n     * @param {String} id\n     *\n     * @returns {Promise}\n     */\n    static setMediaProvider(id) {\n        return super.setMediaProvider(\n            HashBrown.Helpers.ProjectHelper.currentProject,\n            HashBrown.Helpers.ProjectHelper.currentEnvironment,\n            id\n        ).then(() => {\n            return HashBrown.Helpers.RequestHelper.reloadResource('media');  \n        })\n        .then(() => {\n            HashBrown.Views.Navigation.NavbarMain.reload();  \n        });\n    }\n    \n    /**\n     * Gets the Media provider\n     *\n     * @returns {Promise} Connection\n     */\n    static getMediaProvider() {\n        return super.getMediaProvider(\n            HashBrown.Helpers.ProjectHelper.currentProject,\n            HashBrown.Helpers.ProjectHelper.currentEnvironment\n        );\n    }\n}\n\nmodule.exports = ConnectionHelper;\n","'use strict';\n\n/**\n * The helper class for Connections\n *\n * @memberof HashBrown.Common.Helpers\n */\nclass ConnectionHelper {\n    /**\n     * Gets all connections\n     *\n     * @param {String} project\n     * @param {String} environment\n     *\n     * @returns {Promise(Array)} connections\n     */\n    static getAllConnections(project, environment) {\n        checkParam(project, 'project', String);\n        checkParam(environment, 'environment', String);\n\n        return Promise.resolve();\n    }\n    \n    /**\n     * Sets the Media provider\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {String} id\n     *\n     * @return {Promise} Promise\n     */\n    static setMediaProvider(project, environment, id = null) {\n        checkParam(project, 'project', String);\n        checkParam(environment, 'environment', String);\n\n        return HashBrown.Helpers.SettingsHelper.getSettings(project, environment, 'providers')\n        .then((providers) => {\n            providers = providers || {};\n            providers.media = id;\n\n            return HashBrown.Helpers.SettingsHelper.setSettings(project, environment, 'providers', providers)\n        });\n    }\n\n    /**\n     * Gets the Media provider\n     *\n     * @param {String} project\n     * @param {String} environment\n     *\n     * @return {Promise} Connection object\n     */\n    static getMediaProvider(project, environment) {\n        checkParam(project, 'project', String);\n        checkParam(environment, 'environment', String);\n\n        return HashBrown.Helpers.SettingsHelper.getSettings(project, environment, 'providers')\n        \n        // Previously, providers were set project-wide, so retrieve automatically if needed\n        .then((providers) => {\n            if(!providers) {\n                return HashBrown.Helpers.SettingsHelper.getSettings(project, null, 'providers');\n            \n            } else {\n                return Promise.resolve(providers);\n            }\n        })\n\n        // Return requested provider\n        .then((providers) => {\n            providers = providers || {};\n\n            if(providers.media) {\n                return this.getConnectionById(project, environment, providers.media);\n            } else {\n                return Promise.resolve(null);\n            }\n        });\n    }\n}\n\nmodule.exports = ConnectionHelper;\n","'use strict';\n\nconst ContentHelperCommon = require('Common/Helpers/ContentHelper');\n\n/**\n * The client side content helper\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass ContentHelper extends ContentHelperCommon {\n    /**\n     * Gets Content by id\n     *\n     * @param {String} id\n     *\n     * @returns {Content} Content node\n     */\n    static getContentByIdSync(id) {\n        if(!id) { return null; }\n\n        for(let content of resources.content) {\n            if(content.id === id) {\n                return content;\n            }\n        }\n    }\n    \n    /**\n     * Gets Content by id\n     *\n     * @param {String} id\n     *\n     * @returns {Promise} Content node\n     */\n    static getContentById(id) {\n        if(!id) { return Promise.resolve(null); }\n\n        return HashBrown.Helpers.ResourceHelper.get(HashBrown.Models.Content, 'content', id);\n    }\n    \n    /**\n     * Sets Content by id\n     *\n     * @param {String} id\n     * @param {Content} content\n     *\n     * @returns {Promise} Content node\n     */\n    static setContentById(id, content) {\n        checkParam(id, 'id', String);\n        checkParam(content, 'content', HashBrown.Models.Content);\n\n        return HashBrown.Helpers.ResourceHelper.set('content', id, content);\n    }\n\n    /**\n     * A sanity check for fields\n     *\n     * @param {Object} value\n     * @param {Schema} schema\n     */\n    static fieldSanityCheck(value, schema) {\n        // If the schema value is set to multilingual, but the value isn't an object, convert it\n        if(schema.multilingual && (!value || typeof value !== 'object')) {\n            let oldValue = value;\n\n            value = {};\n            value[window.language] = oldValue;\n        }\n\n        // If the schema value is not set to multilingual, but the value is an object\n        // containing the _multilingual flag, convert it\n        if(!schema.multilingual && value && typeof value === 'object' && value._multilingual) {\n            value = value[window.language];\n        }\n\n        // Update the _multilingual flag\n        if(schema.multilingual && value && !value._multilingual) {\n            value._multilingual = true;    \n        \n        } else if(!schema.multilingual && value && value._multilingual) {\n            delete value._multilingual;\n\n        }\n\n        return value;\n    }\n\n    /**\n     * Get new sort index\n     *\n     * @param {String} parentId\n     * @param {String} aboveId\n     * @param {String} belowId\n     */\n    static getNewSortIndex(parentId, aboveId, belowId) {\n        if(aboveId) {\n            return this.getContentByIdSync(aboveId).sort + 1;\n        }\n\n        if(belowId) {\n            return this.getContentByIdSync(belowId).sort - 1;\n        }\n\n        // Filter out content that doesn't have the same parent\n        let nodes = resources.content.filter((x) => {\n            return x.parentId == parentId || (!x.parentId && !parentId);\n        });\n\n        // Find new index\n        // NOTE: The index should be the highest sort number + 10000 to give a bit of leg room for sorting later\n        let newIndex = 10000;\n\n        for(let content of nodes) {\n            if(newIndex - 10000 <= content.sort) {\n                newIndex = content.sort + 10000;\n            }\n        }\n\n        return newIndex;\n    }\n\n    /**\n     * Starts a tour of the Content section\n     */\n    static startTour() {\n        if(location.hash.indexOf('content/') < 0) {\n            location.hash = '/content/';\n        }\n       \n        return new Promise((resolve) => {\n            setTimeout(() => {\n                resolve();\n            }, 500);\n        })\n        .then(() => {\n            return UI.highlight('.navbar-main__tab[data-route=\"/content/\"]', 'This the Content section, where you will do all of your authoring.', 'right', 'next')\n        })\n        .then(() => {\n            return UI.highlight('.navbar-main__pane[data-route=\"/content/\"]', 'Here you will find all of your authored Content, like webpages. You can right click here to create a Content node.', 'right', 'next');\n        })\n        .then(() => {\n            let editor = document.querySelector('.editor--content');\n\n            if(!editor) {\n                return UI.highlight('.page--environment__space--editor', 'This is where the Content editor will be when you click a Content node.', 'left', 'next');\n            }\n                \n            return UI.highlight('.editor--content', 'This is the Content editor, where you edit Content nodes.', 'left', 'next');\n        });\n    }\n}\n\nmodule.exports = ContentHelper;\n","'use strict';\n\n/**\n * A helper class for Content\n *\n * @memberof HashBrown.Common.Helpers\n */\nclass ContentHelper {\n    /**\n     * Gets all Content objects\n     *\n     * @param {String} project\n     * @param {String} environment\n     *\n     * @return {Promise} promise\n     */\n    static getAllContents(project, environment) {\n        checkParam(project, 'project', String);\n        checkParam(environment, 'environment', String);\n\n        return Promise.resolve();\n    }\n\n    /**\n     * Gets a URL-friendly version of a string\n     *\n     * @param {String} string\n     *\n     * @param {String} slug\n     */\n    static getSlug(string) {\n        return (string || '')\n            .toLowerCase()\n            .replace(/[|]/g, 'ae')\n            .replace(/[|]/g, 'oe')\n            .replace(//g, 'aa')\n            .replace(//g, 'ue')\n            .replace(//g, 'ss')\n            .replace(/[^\\w ]+/g, '')\n            .replace(/ +/g, '-')\n            ;\n    }\n\n    /**\n     * Gets a Content object by id\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {String} id\n     *\n     * @return {Promise} promise\n     */\n    static getContentById(project, environment, id) {\n        checkParam(project, 'project', String);\n        checkParam(environment, 'environment', String);\n        checkParam(id, 'id', String);\n\n        return Promise.resolve();\n    }\n    \n    /**\n     * Sets a Content object by id\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {String} id\n     * @param {Content} content\n     *\n     * @return {Promise} promise\n     */\n    static setContentById(project, environment, id, content) {\n        checkParam(project, 'project', String);\n        checkParam(environment, 'environment', String);\n        checkParam(id, 'id', String);\n        checkParam(content, 'content', HashBrown.Models.Content);\n\n        return new Promise((resolve, reject) => {\n            resolve();\n        });\n    }\n\n    /**\n     * Checks if a Schema type is allowed as a child of a Content object\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {String} parentId\n     * @param {String} childSchemaId\n     *\n     * @returns {Promise} Is the Content node allowed as a child\n     */\n    static isSchemaAllowedAsChild(project, environment, parentId, childSchemaId) {\n        checkParam(project, 'project', String);\n        checkParam(environment, 'environment', String);\n        checkParam(parentId, 'parentId', String);\n        checkParam(childSchemaId, 'childSchemaId', String);\n\n        // No parent ID means root, and all Schemas are allowed there\n        if(!parentId) {\n            return Promise.resolve();\n\n        } else {\n            return this.getContentById(project, environment, parentId)\n            .then((parentContent) => {\n                return HashBrown.Helpers.SchemaHelper.getSchemaById(project, environment, parentContent.schemaId);\n            })\n            .then((parentSchema) => {\n                // The Schema was not an allowed child\n                if(parentSchema.allowedChildSchemas.indexOf(childSchemaId) < 0) {\n                    return HashBrown.Helpers.SchemaHelper.getSchemaById(project, environment, childSchemaId)\n                    .then((childSchema) => {\n                        return Promise.reject(new Error('Content with Schema \"' + childSchema.name + '\" is not an allowed child of Content with Schema \"' + parentSchema.name + '\"'));\n                    });\n                \n                // The Schema was an allowed child, resolve\n                } else {\n                    return Promise.resolve();\n\n                }\n            });\n        }\n    }\n\n    /**\n     * Creates a new content object\n     *\n     * @return {Promise} promise\n     */\n    static createContent() {\n        return new Promise((resolve, reject) => {\n            resolve();\n        });\n    }\n    \n    /**\n     * Removes a content object\n     *\n     * @param {Number} id\n     *\n     * @return {Promise} promise\n     */\n    static removeContentById(id) {\n        return new Promise((resolve, reject) => {\n            resolve();\n        });\n    }\n}\n\nmodule.exports = ContentHelper;\n","'use strict';\n\nconst DebugHelperCommon = require('Common/Helpers/DebugHelper');\n\n/**\n * The client side debug helper\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass DebugHelper extends DebugHelperCommon {\n    /**\n     * Start the debug socket\n     */\n    static startSocket() {\n        let debugSocket = new WebSocket(location.protocol.replace('http', 'ws') + '//' + location.host + '/api/debug');\n\n        debugSocket.onopen = (ev) => {\n            debug.log('Debug socket open', 'HashBrown');\n        };\n\n        debugSocket.onmessage = (ev) => {\n            this.onSocketMessage(ev);\n        };\n    }\n\n    /**\n     * Event: On debug socket message\n     */\n    static onSocketMessage(ev) {\n        try {\n            let data = JSON.parse(ev.data);\n\n            switch(data.type) {\n                case 'error':\n                    UI.errorModal(new Error(data.sender + ': ' + data.message));\n                    break;\n\n                case 'warning':\n                    UI.errorModal(new Error(data.sender + ': ' + data.message));\n                    break;\n            }\n\n        } catch(e) {\n            UI.errorModal(ev);\n        }\n    }\n}\n\nmodule.exports = DebugHelper;\n","'use strict';\n\n/**\n * A helper for debugging\n *\n * @memberof HashBrown.Common.Helpers\n */\nclass DebugHelper {\n    /**\n     * Event: Log\n     *\n     * @param {String} dateString\n     * @param {String} senderString\n     * @param {String} message\n     * @param {String} type\n     */\n    static onLog(dateString, senderString, message, type) {\n        if(type) {\n            message = '[' + type.toUpperCase() + '] ' + message;\n        }\n\n        console.log(dateString + ' | ' + senderString + ' | ' + message);\n    }\n\n    /**\n     * Gets the date string\n     *\n     * @returns {String} date\n     */\n    static getDateString() {\n        let date = new Date();\n\n        let monthString = (date.getMonth() + 1);\n\n        if(monthString < 10) {\n            monthString = '0' + monthString;\n        }\n\n        let dateString = date.getDate();\n\n        if(dateString < 10) {\n            dateString = '0' + dateString;\n        }\n        \n        let hoursString = date.getHours();\n\n        if(hoursString < 10) {\n            hoursString = '0' + hoursString;\n        }\n        \n        let minutesString = date.getMinutes();\n\n        if(minutesString < 10) {\n            minutesString = '0' + minutesString;\n        }\n        \n        let secondsString = date.getSeconds();\n\n        if(secondsString < 10) {\n            secondsString = '0' + secondsString;\n        }\n\n        let output =\n            date.getFullYear() + '.' +\n            monthString + '.' +\n            dateString + ' ' +\n            hoursString + ':' + \n            minutesString + ':' + \n            secondsString;\n\n        return output;\n    }\n    \n    /**\n     * Parse sender\n     *\n     * @param {Object} sender\n     *\n     * @returns {String} name\n     */\n    static parseSender(sender, ignoreLast) {\n        let senderName = '';\n\n        if(sender) {\n            if(typeof sender === 'string') {\n                senderName = sender;\n\n            } else if(typeof sender === 'function') {\n                senderName = sender.name;\n\n            } else if(sender.constructor) {\n                senderName = sender.constructor.name;\n            \n            } else {\n                senderName = sender.toString();\n\n            }\n        }\n\n        return senderName;\n    }\n   \n    /**\n     * Gets the debug verbosity\n     *\n     * @returns {Number} Verbosity\n     */\n    static getDebugVerbosity() {\n        return 1;\n    }\n\n    /**\n     * Logs a message\n     *\n     * @param {String} message\n     * @param {Object} sender\n     * @param {Number} verbosity\n     */\n    static log(message, sender, verbosity = 1) {\n        if(verbosity == 0) {\n            this.error('Verbosity cannot be set to 0', this);\n\n        } else if(!verbosity) {\n            verbosity = 1;\n        }\n\n        if(this.getDebugVerbosity() >= verbosity) {\n            this.onLog(this.getDateString(), this.parseSender(sender), message);\n        }\n    }\n\n    /**\n     * Shows an error\n     *\n     * @param {String|Error} error\n     * @param {Object} sender\n     */\n    static error(error, sender) {\n        if(error instanceof Error !== true) {\n            error = new Error(error);\n        }\n\n        this.onLog(this.getDateString(), this.parseSender(sender), error.message || error.trace , 'error');\n    \n        throw error;\n    }\n\n    /**\n     * Shows a warning\n     */\n    static warning(message, sender) {\n        this.onLog(this.getDateString(), this.parseSender(sender), message, 'warning');\n    }\n}\n\nmodule.exports = DebugHelper;\n","'use strict';\n\nconst LanguageHelperCommon = require('Common/Helpers/LanguageHelper');\n\nlet selectedLanguages = {};\n\n/**\n * The client side language helper\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass LanguageHelper extends LanguageHelperCommon {\n    /**\n     * Gets all selected languages\n     *\n     * @param {String} project\n     *\n     * @returns {Array} List of language names\n     */\n    static getLanguages(project) {\n        project = project || HashBrown.Helpers.ProjectHelper.currentProject;\n\n        return HashBrown.Helpers.SettingsHelper.getSettings(project, null, 'languages')\n        .then((selected) => {\n            if(!selected || !Array.isArray(selected)) {\n                selected = ['en'];\n            }\n\n            selected.sort();\n\n            selectedLanguages[project] = selected;\n\n            return Promise.resolve(selected);\n        });\n    }\n   \n    /**\n     * Gets all selected languages (sync)\n     *\n     * @param {String} project\n     *\n     * @returns {Array} List of language names\n     */\n    static getLanguagesSync(project) {\n        project = project || HashBrown.Helpers.ProjectHelper.currentProject;\n\n        return selectedLanguages[project] || ['en'];\n    }\n\n    /**\n     * Sets all languages\n     *\n     * @param {String} project\n     * @param {Array} languages\n     *\n     * @returns {Promise} promise\n     */\n    static setLanguages(project, languages) {\n        checkParam(project, 'project', String);\n        checkParam(languages, 'languages', Array);\n\n        if(!Array.isArray(languages)) {\n            return Promise.reject(new Error('Language array cannot be of type \"' + typeof languages + '\"'));\n        }\n\n        return HashBrown.Helpers.SettingsHelper.setSettings(project, null, 'languages', languages);\n    }\n}\n\nmodule.exports = LanguageHelper;\n","'use strict';\n\n/**\n * A helper for language\n *\n * @memberof HashBrown.Common.Helpers\n */\nclass LanguageHelper {\n    /**\n     * Gets all selected languages\n     *\n     * @param {String} project\n     *\n     * @returns {Array} List of language names\n     */\n    static getLanguages(project) {\n        checkParam(project, 'project', String);\n\n        return Promise.resolve([]);\n    }\n    \n    /**\n     * Sets all languages\n     *\n     * @param {String} project\n     * @param {Array} languages\n     *\n     * @returns {Promise} Promise\n     */\n    static setLanguages(project, languages) {\n        checkParam(project, 'project', String);\n        checkParam(languages, 'languages', Array);\n\n        return Promise.resolve();\n    }\n\n    /**\n     * Gets localised sets of properties for a Content object\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {Content} content\n     *\n     * @return {Promise} Properties\n     */\n    static getAllLocalizedPropertySets(project, environment, content) {\n        checkParam(project, 'project', String);\n        checkParam(environment, 'environment', String);\n        checkParam(content, 'content', HashBrown.Models.Content);\n\n        return this.getLanguages(project)\n        .then((languages) => {\n            let sets = {};\n\n            for(let language of languages) {\n                let properties = content.getLocalizedProperties(language);\n                \n                sets[language] = properties;\n            }\n\n            return Promise.resolve(sets);\n        });\n    }\n    \n    /**\n     * Gets all languages\n     *\n     * @returns {Array} List of language names\n     */\n    static getLanguageOptions() {\n        return [\n            \"aa\",\n            \"ab\",\n            \"ae\",\n            \"af\",\n            \"ak\",\n            \"am\",\n            \"an\",\n            \"ar\",\n            \"as\",\n            \"av\",\n            \"ay\",\n            \"az\",\n            \"ba\",\n            \"be\",\n            \"bg\",\n            \"bh\",\n            \"bi\",\n            \"bm\",\n            \"bn\",\n            \"bo\",\n            \"br\",\n            \"bs\",\n            \"ca\",\n            \"ce\",\n            \"ch\",\n            \"co\",\n            \"cr\",\n            \"cs\",\n            \"cu\",\n            \"cv\",\n            \"cy\",\n            \"da\",\n            \"de\",\n            \"dv\",\n            \"dz\",\n            \"ee\",\n            \"el\",\n            \"en\",\n            \"eo\",\n            \"es\",\n            \"et\",\n            \"eu\",\n            \"fa\",\n            \"ff\",\n            \"fi\",\n            \"fj\",\n            \"fo\",\n            \"fr\",\n            \"fy\",\n            \"ga\",\n            \"gd\",\n            \"gl\",\n            \"gn\",\n            \"gu\",\n            \"gv\",\n            \"ha\",\n            \"he\",\n            \"hi\",\n            \"ho\",\n            \"hr\",\n            \"ht\",\n            \"hu\",\n            \"hy\",\n            \"hz\",\n            \"ia\",\n            \"id\",\n            \"ie\",\n            \"ig\",\n            \"ii\",\n            \"ik\",\n            \"io\",\n            \"is\",\n            \"it\",\n            \"iu\",\n            \"ja\",\n            \"jv\",\n            \"ka\",\n            \"kg\",\n            \"ki\",\n            \"kj\",\n            \"kk\",\n            \"kl\",\n            \"km\",\n            \"kn\",\n            \"ko\",\n            \"kr\",\n            \"ks\",\n            \"ku\",\n            \"kv\",\n            \"kw\",\n            \"ky\",\n            \"la\",\n            \"lb\",\n            \"lg\",\n            \"li\",\n            \"ln\",\n            \"lo\",\n            \"lt\",\n            \"lu\",\n            \"lv\",\n            \"mg\",\n            \"mh\",\n            \"mi\",\n            \"mk\",\n            \"ml\",\n            \"mn\",\n            \"mr\",\n            \"ms\",\n            \"mt\",\n            \"my\",\n            \"na\",\n            \"nb\",\n            \"nd\",\n            \"ne\",\n            \"ng\",\n            \"nl\",\n            \"nn\",\n            \"no\",\n            \"nr\",\n            \"nv\",\n            \"ny\",\n            \"oc\",\n            \"oj\",\n            \"om\",\n            \"or\",\n            \"os\",\n            \"pa\",\n            \"pi\",\n            \"pl\",\n            \"ps\",\n            \"pt\",\n            \"qu\",\n            \"rc\",\n            \"rm\",\n            \"rn\",\n            \"ro\",\n            \"ru\",\n            \"rw\",\n            \"sa\",\n            \"sc\",\n            \"sd\",\n            \"se\",\n            \"sg\",\n            \"si\",\n            \"sk\",\n            \"sl\",\n            \"sm\",\n            \"sn\",\n            \"so\",\n            \"sq\",\n            \"sr\",\n            \"ss\",\n            \"st\",\n            \"su\",\n            \"sv\",\n            \"sw\",\n            \"ta\",\n            \"te\",\n            \"tg\",\n            \"th\",\n            \"ti\",\n            \"tk\",\n            \"tl\",\n            \"tn\",\n            \"to\",\n            \"tr\",\n            \"ts\",\n            \"tt\",\n            \"tw\",\n            \"ty\",\n            \"ug\",\n            \"uk\",\n            \"ur\",\n            \"uz\",\n            \"ve\",\n            \"vi\",\n            \"vo\",\n            \"wa\",\n            \"wo\",\n            \"xh\",\n            \"yi\",\n            \"yo\",\n            \"za\",\n            \"zh\",\n            \"zu\"\n        ];\n    }\n}\n\nmodule.exports = LanguageHelper;\n","'use strict';\n\n/**\n * A helper class for handling markdown\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass MarkdownHelper {\n    /**\n     * Converts a string from HTML to markdown (based on \"turndown\")\n     *\n     * NOTE: This terrible approach had to be implemented since \"to-markdown\"\n     * became \"turndown\" and employed an ugly implementation that we're\n     * encapsulating here to prevent polluting the global namespace with libraries\n     *\n     * In the future, we should fork the project and integrate it more neatly\n     *\n     * @return {String} Markdown\n     */\n    static fromHtml(html) {\n        var TurndownService = (function () {\n            'use strict';\n\n            function extend(destination) {\n                for (var i = 1; i < arguments.length; i++) {\n                    var source = arguments[i];\n                    for (var key in source) {\n                        if (source.hasOwnProperty(key)) \n                            destination[key] = source[key];\n                        }\n                    }\n                return destination\n            }\n\n            function repeat(character, count) {\n                return Array(count + 1).join(character)\n            }\n\n            var blockElements = [\n                'address',\n                'article',\n                'aside',\n                'audio',\n                'blockquote',\n                'body',\n                'canvas',\n                'center',\n                'dd',\n                'dir',\n                'div',\n                'dl',\n                'dt',\n                'fieldset',\n                'figcaption',\n                'figure',\n                'footer',\n                'form',\n                'frameset',\n                'h1',\n                'h2',\n                'h3',\n                'h4',\n                'h5',\n                'h6',\n                'header',\n                'hgroup',\n                'hr',\n                'html',\n                'isindex',\n                'li',\n                'main',\n                'menu',\n                'nav',\n                'noframes',\n                'noscript',\n                'ol',\n                'output',\n                'p',\n                'pre',\n                'section',\n                'table',\n                'tbody',\n                'td',\n                'tfoot',\n                'th',\n                'thead',\n                'tr',\n                'ul'\n            ];\n\n            function isBlock(node) {\n                return blockElements.indexOf(node.nodeName.toLowerCase()) !== -1\n            }\n\n            var voidElements = [\n                'area',\n                'base',\n                'br',\n                'col',\n                'command',\n                'embed',\n                'hr',\n                'img',\n                'input',\n                'keygen',\n                'link',\n                'meta',\n                'param',\n                'source',\n                'track',\n                'wbr'\n            ];\n\n            function isVoid(node) {\n                return voidElements.indexOf(node.nodeName.toLowerCase()) !== -1\n            }\n\n            var voidSelector = voidElements.join();\n            function hasVoid(node) {\n                return node.querySelector && node.querySelector(voidSelector)\n            }\n\n            var rules = {};\n\n            rules.paragraph = {\n                filter: 'p',\n\n                replacement: function (content) {\n                    return '\\n\\n' + content + '\\n\\n'\n                }\n            };\n\n            rules.lineBreak = {\n                filter: 'br',\n\n                replacement: function (content, node, options) {\n                    return options.br + '\\n'\n                }\n            };\n\n            rules.heading = {\n                filter: [\n                    'h1',\n                    'h2',\n                    'h3',\n                    'h4',\n                    'h5',\n                    'h6'\n                ],\n\n                replacement: function (content, node, options) {\n                    var hLevel = Number(node.nodeName.charAt(1));\n\n                    if (options.headingStyle === 'setext' && hLevel < 3) {\n                        var underline = repeat((hLevel === 1\n                            ? '='\n                            : '-'), content.length);\n                        return ('\\n\\n' + content + '\\n' + underline + '\\n\\n')\n                    } else {\n                        return '\\n\\n' + repeat('#', hLevel) + ' ' + content + '\\n\\n'\n                    }\n                }\n            };\n\n            rules.blockquote = {\n                filter: 'blockquote',\n\n                replacement: function (content) {\n                    content = content.replace(/^\\n+|\\n+$/g, '');\n                    content = content.replace(/^/gm, '> ');\n                    return '\\n\\n' + content + '\\n\\n'\n                }\n            };\n\n            rules.list = {\n                filter: [\n                    'ul', 'ol'\n                ],\n\n                replacement: function (content, node) {\n                    var parent = node.parentNode;\n                    if (parent.nodeName === 'LI' && parent.lastElementChild === node) {\n                        return '\\n' + content\n                    } else {\n                        return '\\n\\n' + content + '\\n\\n'\n                    }\n                }\n            };\n\n            rules.listItem = {\n                filter: 'li',\n\n                replacement: function (content, node, options) {\n                    content = content.replace(/^\\n+/, '') // remove leading newlines\n                        .replace(/\\n+$/, '\\n') // replace trailing newlines with just a single one\n                        .replace(/\\n/gm, '\\n    '); // indent\n                    var prefix = options.bulletListMarker + '   ';\n                    var parent = node.parentNode;\n                    if (parent.nodeName === 'OL') {\n                        var start = parent.getAttribute('start');\n                        var index = Array\n                            .prototype\n                            .indexOf\n                            .call(parent.children, node);\n                        prefix = (start\n                            ? Number(start) + index\n                            : index + 1) + '.  ';\n                    }\n                    return (prefix + content + (node.nextSibling && !/\\n$/.test(content)\n                        ? '\\n'\n                        : ''))\n                }\n            };\n\n            rules.indentedCodeBlock = {\n                filter: function (node, options) {\n                    return (options.codeBlockStyle === 'indented' && node.nodeName === 'PRE' && node.firstChild && node.firstChild.nodeName === 'CODE')\n                },\n\n                replacement: function (content, node, options) {\n                    return ('\\n\\n    ' + node.firstChild.textContent.replace(/\\n/g, '\\n    ') + '\\n\\n')\n                }\n            };\n\n            rules.fencedCodeBlock = {\n                filter: function (node, options) {\n                    return (options.codeBlockStyle === 'fenced' && node.nodeName === 'PRE' && node.firstChild && node.firstChild.nodeName === 'CODE')\n                },\n\n                replacement: function (content, node, options) {\n                    var className = node.firstChild.className || '';\n                    var language = (className.match(/language-(\\S+)/) || [null, ''])[1];\n\n                    return ('\\n\\n' + options.fence + language + '\\n' + node.firstChild.textContent + '\\n' + options.fence + '\\n\\n')\n                }\n            };\n\n            rules.horizontalRule = {\n                filter: 'hr',\n\n                replacement: function (content, node, options) {\n                    return '\\n\\n' + options.hr + '\\n\\n'\n                }\n            };\n\n            rules.inlineLink = {\n                filter: function (node, options) {\n                    return (options.linkStyle === 'inlined' && node.nodeName === 'A' && node.getAttribute('href'))\n                },\n\n                replacement: function (content, node) {\n                    var href = node.getAttribute('href');\n                    var title = node.title\n                        ? ' \"' + node.title + '\"'\n                        : '';\n                    return '[' + content + '](' + href + title + ')'\n                }\n            };\n\n            rules.referenceLink = {\n                filter: function (node, options) {\n                    return (options.linkStyle === 'referenced' && node.nodeName === 'A' && node.getAttribute('href'))\n                },\n\n                replacement: function (content, node, options) {\n                    var href = node.getAttribute('href');\n                    var title = node.title\n                        ? ' \"' + node.title + '\"'\n                        : '';\n                    var replacement;\n                    var reference;\n\n                    switch (options.linkReferenceStyle) {\n                        case 'collapsed':\n                            replacement = '[' + content + '][]';\n                            reference = '[' + content + ']: ' + href + title;\n                            break\n                        case 'shortcut':\n                            replacement = '[' + content + ']';\n                            reference = '[' + content + ']: ' + href + title;\n                            break\n                        default:\n                            var id = this.references.length + 1;\n                            replacement = '[' + content + '][' + id + ']';\n                            reference = '[' + id + ']: ' + href + title;\n                    }\n\n                    this\n                        .references\n                        .push(reference);\n                    return replacement\n                },\n\n                references: [],\n\n                append: function (options) {\n                    var references = '';\n                    if (this.references.length) {\n                        references = '\\n\\n' + this\n                            .references\n                            .join('\\n') + '\\n\\n';\n                        this.references = []; // Reset references\n                    }\n                    return references\n                }\n            };\n\n            rules.emphasis = {\n                filter: [\n                    'em', 'i'\n                ],\n\n                replacement: function (content, node, options) {\n                    if (!content.trim()) \n                        return ''\n                    return options.emDelimiter + content + options.emDelimiter\n                }\n            };\n\n            rules.strong = {\n                filter: [\n                    'strong', 'b'\n                ],\n\n                replacement: function (content, node, options) {\n                    if (!content.trim()) \n                        return ''\n                    return options.strongDelimiter + content + options.strongDelimiter\n                }\n            };\n\n            rules.code = {\n                filter: function (node) {\n                    var hasSiblings = node.previousSibling || node.nextSibling;\n                    var isCodeBlock = node.parentNode.nodeName === 'PRE' && !hasSiblings;\n\n                    return node.nodeName === 'CODE' && !isCodeBlock\n                },\n\n                replacement: function (content) {\n                    if (!content.trim()) \n                        return ''\n\n                    var delimiter = '`';\n                    var leadingSpace = '';\n                    var trailingSpace = '';\n                    var matches = content.match(/`+/gm);\n                    if (matches) {\n                        if (/^`/.test(content)) \n                            leadingSpace = ' ';\n                        if (/`$/.test(content)) \n                            trailingSpace = ' ';\n                        while (matches.indexOf(delimiter) !== -1) \n                            delimiter = delimiter + '`';\n                        }\n                    \n                    return delimiter + leadingSpace + content + trailingSpace + delimiter\n                }\n            };\n\n            rules.image = {\n                filter: 'img',\n\n                replacement: function (content, node) {\n                    var alt = node.alt || '';\n                    var src = node.getAttribute('src') || '';\n                    var title = node.title || '';\n                    var titlePart = title\n                        ? ' \"' + title + '\"'\n                        : '';\n                    return src\n                        ? '![' + alt + '](' + src + titlePart + ')'\n                        : ''\n                }\n            };\n\n            /**\n         * Manages a collection of rules used to convert HTML to Markdown\n         */\n\n            function Rules(options) {\n                this.options = options;\n                this._keep = [];\n                this._remove = [];\n\n                this.blankRule = {\n                    replacement: options.blankReplacement\n                };\n\n                this.keepReplacement = options.keepReplacement;\n\n                this.defaultRule = {\n                    replacement: options.defaultReplacement\n                };\n\n                this.array = [];\n                for (var key in options.rules) \n                    this.array.push(options.rules[key]);\n                }\n            \n            Rules.prototype = {\n                add: function (key, rule) {\n                    this\n                        .array\n                        .unshift(rule);\n                },\n\n                keep: function (filter) {\n                    this\n                        ._keep\n                        .unshift({filter: filter, replacement: this.keepReplacement});\n                },\n\n                remove: function (filter) {\n                    this\n                        ._remove\n                        .unshift({\n                            filter: filter,\n                            replacement: function () {\n                                return ''\n                            }\n                        });\n                },\n\n                forNode: function (node) {\n                    if (node.isBlank) \n                        return this.blankRule\n                    var rule;\n\n                    if ((rule = findRule(this.array, node, this.options))) \n                        return rule\n                    if ((rule = findRule(this._keep, node, this.options))) \n                        return rule\n                    if ((rule = findRule(this._remove, node, this.options))) \n                        return rule\n\n                    return this.defaultRule\n                },\n\n                forEach: function (fn) {\n                    for (var i = 0; i < this.array.length; i++) \n                        fn(this.array[i], i);\n                    }\n                };\n\n            function findRule(rules, node, options) {\n                for (var i = 0; i < rules.length; i++) {\n                    var rule = rules[i];\n                    if (filterValue(rule, node, options)) \n                        return rule\n                }\n                return void 0\n            }\n\n            function filterValue(rule, node, options) {\n                var filter = rule.filter;\n                if (typeof filter === 'string') {\n                    if (filter === node.nodeName.toLowerCase()) \n                        return true\n                } else if (Array.isArray(filter)) {\n                    if (filter.indexOf(node.nodeName.toLowerCase()) > -1) \n                        return true\n                } else if (typeof filter === 'function') {\n                    if (filter.call(rule, node, options)) \n                        return true\n                } else {\n                    throw new TypeError('`filter` needs to be a string, array, or function')\n                }\n            }\n\n            /**\n         * The collapseWhitespace function is adapted from collapse-whitespace\n         * by Luc Thevenard.\n         *\n         * The MIT License (MIT)\n         *\n         * Copyright (c) 2014 Luc Thevenard <lucthevenard@gmail.com>\n         *\n         * Permission is hereby granted, free of charge, to any person obtaining a copy\n         * of this software and associated documentation files (the \"Software\"), to deal\n         * in the Software without restriction, including without limitation the rights\n         * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n         * copies of the Software, and to permit persons to whom the Software is\n         * furnished to do so, subject to the following conditions:\n         *\n         * The above copyright notice and this permission notice shall be included in\n         * all copies or substantial portions of the Software.\n         *\n         * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n         * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n         * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n         * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n         * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n         * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n         * THE SOFTWARE.\n         */\n\n            /**\n         * collapseWhitespace(options) removes extraneous whitespace from an the given element.\n         *\n         * @param {Object} options\n         */\n            function collapseWhitespace(options) {\n                var element = options.element;\n                var isBlock = options.isBlock;\n                var isVoid = options.isVoid;\n                var isPre = options.isPre || function (node) {\n                    return node.nodeName === 'PRE'\n                };\n\n                if (!element.firstChild || isPre(element)) \n                    return\n\n                var prevText = null;\n                var prevVoid = false;\n\n                var prev = null;\n                var node = next(prev, element, isPre);\n\n                while (node !== element) {\n                    if (node.nodeType === 3 || node.nodeType === 4) { // Node.TEXT_NODE or Node.CDATA_SECTION_NODE\n                        var text = node\n                            .data\n                            .replace(/[ \\r\\n\\t]+/g, ' ');\n\n                        if ((!prevText || / $/.test(prevText.data)) && !prevVoid && text[0] === ' ') {\n                            text = text.substr(1);\n                        }\n\n                        // `text` might be empty at this point.\n                        if (!text) {\n                            node = remove(node);\n                            continue\n                        }\n\n                        node.data = text;\n\n                        prevText = node;\n                    } else if (node.nodeType === 1) { // Node.ELEMENT_NODE\n                        if (isBlock(node) || node.nodeName === 'BR') {\n                            if (prevText) {\n                                prevText.data = prevText\n                                    .data\n                                    .replace(/ $/, '');\n                            }\n\n                            prevText = null;\n                            prevVoid = false;\n                        } else if (isVoid(node)) {\n                            // Avoid trimming space around non-block, non-BR void elements.\n                            prevText = null;\n                            prevVoid = true;\n                        }\n                    } else {\n                        node = remove(node);\n                        continue\n                    }\n\n                    var nextNode = next(prev, node, isPre);\n                    prev = node;\n                    node = nextNode;\n                }\n\n                if (prevText) {\n                    prevText.data = prevText\n                        .data\n                        .replace(/ $/, '');\n                    if (!prevText.data) {\n                        remove(prevText);\n                    }\n                }\n            }\n\n            /**\n         * remove(node) removes the given node from the DOM and returns the\n         * next node in the sequence.\n         *\n         * @param {Node} node\n         * @return {Node} node\n         */\n            function remove(node) {\n                var next = node.nextSibling || node.parentNode;\n\n                node\n                    .parentNode\n                    .removeChild(node);\n\n                return next\n            }\n\n            /**\n         * next(prev, current, isPre) returns the next node in the sequence, given the\n         * current and previous nodes.\n         *\n         * @param {Node} prev\n         * @param {Node} current\n         * @param {Function} isPre\n         * @return {Node}\n         */\n            function next(prev, current, isPre) {\n                if ((prev && prev.parentNode === current) || isPre(current)) {\n                    return current.nextSibling || current.parentNode\n                }\n\n                return current.firstChild || current.nextSibling || current.parentNode\n            }\n\n            /*\n         * Set up window for Node.js\n         */\n\n            var root = (typeof window !== 'undefined'\n                ? window\n                : {});\n\n            /*\n         * Parsing HTML strings\n         */\n\n            function canParseHTMLNatively() {\n                var Parser = root.DOMParser;\n                var canParse = false;\n\n                // Adapted from https://gist.github.com/1129031 Firefox/Opera/IE throw errors on\n                // unsupported types\n                try {\n                    // WebKit returns null on unsupported types\n                    if (new Parser().parseFromString('', 'text/html')) {\n                        canParse = true;\n                    }\n                } catch (e) {}\n\n                return canParse\n            }\n\n            function createHTMLParser() {\n                var Parser = function () {};\n\n                {\n                    if (shouldUseActiveX()) {\n                        Parser.prototype.parseFromString = function (string) {\n                            var doc = new window.ActiveXObject('htmlfile');\n                            doc.designMode = 'on'; // disable on-page scripts\n                            doc.open();\n                            doc.write(string);\n                            doc.close();\n                            return doc\n                        };\n                    } else {\n                        Parser.prototype.parseFromString = function (string) {\n                            var doc = document\n                                .implementation\n                                .createHTMLDocument('');\n                            doc.open();\n                            doc.write(string);\n                            doc.close();\n                            return doc\n                        };\n                    }\n                }\n                return Parser\n            }\n\n            function shouldUseActiveX() {\n                var useActiveX = false;\n                try {\n                    document\n                        .implementation\n                        .createHTMLDocument('')\n                        .open();\n                } catch (e) {\n                    if (window.ActiveXObject) \n                        useActiveX = true;\n                    }\n                return useActiveX\n            }\n\n            var HTMLParser = canParseHTMLNatively()\n                ? root.DOMParser\n                : createHTMLParser();\n\n            function RootNode(input) {\n                var root;\n                if (typeof input === 'string') {\n                    var doc = htmlParser().parseFromString(\n                    // DOM parsers arrange elements in the <head> and <body>. Wrapping in a custom\n                    // element ensures elements are reliably arranged in a single element.\n                    '<x-turndown id=\"turndown-root\">' + input + '</x-turndown>',\n                    'text/html');\n                    root = doc.getElementById('turndown-root');\n                } else {\n                    root = input.cloneNode(true);\n                }\n                collapseWhitespace({element: root, isBlock: isBlock, isVoid: isVoid});\n\n                return root\n            }\n\n            var _htmlParser;\n            function htmlParser() {\n                _htmlParser = _htmlParser || new HTMLParser();\n                return _htmlParser\n            }\n\n            function Node(node) {\n                node.isBlock = isBlock(node);\n                node.isCode = node\n                    .nodeName\n                    .toLowerCase() === 'code' || node.parentNode.isCode;\n                node.isBlank = isBlank(node);\n                node.flankingWhitespace = flankingWhitespace(node);\n                return node\n            }\n\n            function isBlank(node) {\n                return ([\n                    'A',\n                    'TH',\n                    'TD',\n                    'IFRAME',\n                    'SCRIPT',\n                    'AUDIO',\n                    'VIDEO'\n                ].indexOf(node.nodeName) === -1 && /^\\s*$/i.test(node.textContent) && !isVoid(node) && !hasVoid(node))\n            }\n\n            function flankingWhitespace(node) {\n                var leading = '';\n                var trailing = '';\n\n                if (!node.isBlock) {\n                    var hasLeading = /^[ \\r\\n\\t]/.test(node.textContent);\n                    var hasTrailing = /[ \\r\\n\\t]$/.test(node.textContent);\n\n                    if (hasLeading && !isFlankedByWhitespace('left', node)) {\n                        leading = ' ';\n                    }\n                    if (hasTrailing && !isFlankedByWhitespace('right', node)) {\n                        trailing = ' ';\n                    }\n                }\n\n                return {leading: leading, trailing: trailing}\n            }\n\n            function isFlankedByWhitespace(side, node) {\n                var sibling;\n                var regExp;\n                var isFlanked;\n\n                if (side === 'left') {\n                    sibling = node.previousSibling;\n                    regExp = / $/;\n                } else {\n                    sibling = node.nextSibling;\n                    regExp = /^ /;\n                }\n\n                if (sibling) {\n                    if (sibling.nodeType === 3) {\n                        isFlanked = regExp.test(sibling.nodeValue);\n                    } else if (sibling.nodeType === 1 && !isBlock(sibling)) {\n                        isFlanked = regExp.test(sibling.textContent);\n                    }\n                }\n                return isFlanked\n            }\n\n            var reduce = Array.prototype.reduce;\n            var leadingNewLinesRegExp = /^\\n*/;\n            var trailingNewLinesRegExp = /\\n*$/;\n            var escapes = [\n                [\n                    /\\\\/g, '\\\\\\\\'\n                ],\n                [\n                    /\\*/g, '\\\\*'\n                ],\n                [\n                    /^-/g, '\\\\-'\n                ],\n                [\n                    /^\\+ /g, '\\\\+ '\n                ],\n                [\n                    /^(=+)/g, '\\\\$1'\n                ],\n                [\n                    /^(#{1,6}) /g, '\\\\$1 '\n                ],\n                [\n                    /`/g, '\\\\`'\n                ],\n                [\n                    /^~~~/g, '\\\\~~~'\n                ],\n                [\n                    /\\[/g, '\\\\['\n                ],\n                [\n                    /\\]/g, '\\\\]'\n                ],\n                [\n                    /^>/g, '\\\\>'\n                ],\n                [\n                    /_/g, '\\\\_'\n                ],\n                [/^(\\d+)\\. /g, '$1\\\\. ']\n            ];\n\n            function TurndownService(options) {\n                if (!(this instanceof TurndownService)) \n                    return new TurndownService(options)\n\n                var defaults = {\n                    rules: rules,\n                    headingStyle: 'setext',\n                    hr: '* * *',\n                    bulletListMarker: '*',\n                    codeBlockStyle: 'indented',\n                    fence: '```',\n                    emDelimiter: '_',\n                    strongDelimiter: '**',\n                    linkStyle: 'inlined',\n                    linkReferenceStyle: 'full',\n                    br: '  ',\n                    blankReplacement: function (content, node) {\n                        return node.isBlock\n                            ? '\\n\\n'\n                            : ''\n                    },\n                    keepReplacement: function (content, node) {\n                        return node.isBlock\n                            ? '\\n\\n' + node.outerHTML + '\\n\\n'\n                            : node.outerHTML\n                    },\n                    defaultReplacement: function (content, node) {\n                        return node.isBlock\n                            ? '\\n\\n' + content + '\\n\\n'\n                            : content\n                    }\n                };\n                this.options = extend({}, defaults, options);\n                this.rules = new Rules(this.options);\n            }\n\n            TurndownService.prototype = {\n                /**\n           * The entry point for converting a string or DOM node to Markdown\n           * @public\n           * @param {String|HTMLElement} input The string or DOM node to convert\n           * @returns A Markdown representation of the input\n           * @type String\n           */\n\n                turndown: function (input) {\n                    if (!canConvert(input)) {\n                        throw new TypeError(input + ' is not a string, or an element/document/fragment node.')\n                    }\n\n                    if (input === '') \n                        return ''\n\n                    var output = process.call(this, new RootNode(input));\n                    return postProcess.call(this, output)\n                },\n\n                /**\n           * Add one or more plugins\n           * @public\n           * @param {Function|Array} plugin The plugin or array of plugins to add\n           * @returns The Turndown instance for chaining\n           * @type Object\n           */\n\n                use: function (plugin) {\n                    if (Array.isArray(plugin)) {\n                        for (var i = 0; i < plugin.length; i++) \n                            this.use(plugin[i]);\n                        }\n                    else if (typeof plugin === 'function') {\n                        plugin(this);\n                    } else {\n                        throw new TypeError('plugin must be a Function or an Array of Functions')\n                    }\n                    return this\n                },\n\n                /**\n           * Adds a rule\n           * @public\n           * @param {String} key The unique key of the rule\n           * @param {Object} rule The rule\n           * @returns The Turndown instance for chaining\n           * @type Object\n           */\n\n                addRule: function (key, rule) {\n                    this\n                        .rules\n                        .add(key, rule);\n                    return this\n                },\n\n                /**\n           * Keep a node (as HTML) that matches the filter\n           * @public\n           * @param {String|Array|Function} filter The unique key of the rule\n           * @returns The Turndown instance for chaining\n           * @type Object\n           */\n\n                keep: function (filter) {\n                    this\n                        .rules\n                        .keep(filter);\n                    return this\n                },\n\n                /**\n           * Remove a node that matches the filter\n           * @public\n           * @param {String|Array|Function} filter The unique key of the rule\n           * @returns The Turndown instance for chaining\n           * @type Object\n           */\n\n                remove: function (filter) {\n                    this\n                        .rules\n                        .remove(filter);\n                    return this\n                },\n\n                /**\n           * Escapes Markdown syntax\n           * @public\n           * @param {String} string The string to escape\n           * @returns A string with Markdown syntax escaped\n           * @type String\n           */\n\n                escape: function (string) {\n                    return escapes.reduce(function (accumulator, escape) {\n                        return accumulator.replace(escape[0], escape[1])\n                    }, string)\n                }\n            };\n\n            /**\n         * Reduces a DOM node down to its Markdown string equivalent\n         * @private\n         * @param {HTMLElement} parentNode The node to convert\n         * @returns A Markdown representation of the node\n         * @type String\n         */\n\n            function process(parentNode) {\n                var self = this;\n                return reduce.call(parentNode.childNodes, function (output, node) {\n                    node = new Node(node);\n\n                    var replacement = '';\n                    if (node.nodeType === 3) {\n                        replacement = node.isCode\n                            ? node.nodeValue\n                            : self.escape(node.nodeValue);\n                    } else if (node.nodeType === 1) {\n                        replacement = replacementForNode.call(self, node);\n                    }\n\n                    return join(output, replacement)\n                }, '')\n            }\n\n            /**\n         * Appends strings as each rule requires and trims the output\n         * @private\n         * @param {String} output The conversion output\n         * @returns A trimmed version of the ouput\n         * @type String\n         */\n\n            function postProcess(output) {\n                var self = this;\n                this\n                    .rules\n                    .forEach(function (rule) {\n                        if (typeof rule.append === 'function') {\n                            output = join(output, rule.append(self.options));\n                        }\n                    });\n\n                return output\n                    .replace(/^[\\t\\r\\n]+/, '')\n                    .replace(/[\\t\\r\\n\\s]+$/, '')\n            }\n\n            /**\n         * Converts an element node to its Markdown equivalent\n         * @private\n         * @param {HTMLElement} node The node to convert\n         * @returns A Markdown representation of the node\n         * @type String\n         */\n\n            function replacementForNode(node) {\n                var rule = this\n                    .rules\n                    .forNode(node);\n                var content = process.call(this, node);\n                var whitespace = node.flankingWhitespace;\n                if (whitespace.leading || whitespace.trailing) \n                    content = content.trim();\n                return (whitespace.leading + rule.replacement(content, node, this.options) + whitespace.trailing)\n            }\n\n            /**\n         * Determines the new lines between the current output and the replacement\n         * @private\n         * @param {String} output The current conversion output\n         * @param {String} replacement The string to append to the output\n         * @returns The whitespace to separate the current output and the replacement\n         * @type String\n         */\n\n            function separatingNewlines(output, replacement) {\n                var newlines = [\n                    output.match(trailingNewLinesRegExp)[0],\n                    replacement.match(leadingNewLinesRegExp)[0]\n                ].sort();\n                var maxNewlines = newlines[newlines.length - 1];\n                return maxNewlines.length < 2\n                    ? maxNewlines\n                    : '\\n\\n'\n            }\n\n            function join(string1, string2) {\n                var separator = separatingNewlines(string1, string2);\n\n                // Remove trailing/leading newlines and replace with separator\n                string1 = string1.replace(trailingNewLinesRegExp, '');\n                string2 = string2.replace(leadingNewLinesRegExp, '');\n\n                return string1 + separator + string2\n            }\n\n            /**\n         * Determines whether an input can be converted\n         * @private\n         * @param {String|HTMLElement} input Describe this parameter\n         * @returns Describe what it returns\n         * @type String|Object|Array|Boolean|Number\n         */\n\n            function canConvert(input) {\n                return (input != null && (typeof input === 'string' || (input.nodeType && (input.nodeType === 1 || input.nodeType === 9 || input.nodeType === 11))))\n            }\n\n            return TurndownService;\n\n        }());\n\n\n        return new TurndownService().turndown(html);\n    }\n}\n\nmodule.exports = MarkdownHelper;\n","'use strict';\n\nconst MediaHelperCommon = require('Common/Helpers/MediaHelper');\n\n/**\n * The client side media helper\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass MediaHelper extends MediaHelperCommon {\n    /**\n     * Gets the Media tree\n     *\n     * @returns {Promise(Object)} tree\n     */\n    static getTree() {\n        return HashBrown.Helpers.RequestHelper.request('get', 'media/tree');\n    }\n\n    /**\n     * Gets whether the Media provider exists\n     *\n     * @returns {Promise} Promise\n     */\n    static checkMediaProvider() {\n        return HashBrown.Helpers.SettingsHelper.getSettings(HashBrown.Helpers.ProjectHelper.currentProject, HashBrown.Helpers.ProjectHelper.currentEnvironment, 'providers')\n        .then((result) => {\n            if(!result || !result.media) {\n                return Promise.reject(new Error('No Media provider has been set for this project. Please make sure one of your <a href=\"#/connections/\">Connections</a> has the \"is Media provider\" setting switched on.'));\n            }  \n\n            return Promise.resolve();\n        }); \n    }\n    \n    /**\n     * Gets Media object by id synchronously\n     *\n     * @param {String} id\n     *\n     * @return {Media} Media object\n     */\n    static getMediaByIdSync(id) {\n        for(let i = 0; i < resources.media.length; i++) {\n            let media = resources.media[i];\n\n            if(media.id == id) {\n                return media;\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * Gets the Media Url\n     */\n    static getMediaUrl(id) {\n        return '/media/' + ProjectHelper.currentProject + '/' + ProjectHelper.currentEnvironment + '/' + id;\n    } \n\n    /**\n     * Gets Media object by id\n     *\n     * @param {String} id\n     *\n     * @return {Promise} Media object\n     */\n    static getMediaById(id) {\n        return new Promise((resolve, reject) => {\n            for(let i = 0; i < resources.media.length; i++) {\n                let media = resources.media[i];\n\n                if(media.id == id) {\n                    resolve(media);\n                    return;\n                }\n            }\n\n            reject(new Error('Media with id \"' + id + '\" not found'));\n        });\n    }\n\n    /**\n     * Sets a Media tree item\n     *\n     * @param {String} id\n     * @param {Object} item\n     *\n     * @returns {Promise} promise\n     */\n    static setTreeItem(id, item) {\n        return HashBrown.Helpers.RequestHelper.request('post', 'media/tree/' + id, item);\n    }\n\n    /**\n     * Initialises the media picker mode\n     *\n     * @param {Function} onPickMedia\n     * @param {Function} onChangeResource\n     * @param {Object} allResources\n     */\n    static initMediaPickerMode(onPickMedia, onChangeResource, onError, allResources) {\n        // Claim debug messages\n        UI.errorModal = onError;\n        \n        // Use the provided resources instead of reloading them\n        HashBrown.Helpers.RequestHelper.reloadAllResources = () => {\n            resources = allResources;\n\n            return Promise.resolve();\n        };\n\n        // Listen for picked Media\n        window.addEventListener('hashchange', () => {\n            let isMediaView = location.hash.indexOf('#/media/') === 0;\n\n            if(isMediaView) {\n                let id = location.hash.replace('#/media/', '');\n\n                onPickMedia(id);\n            }\n        }); \n       \n        // Listen for resource change\n        HashBrown.Views.Navigation.NavbarMain.reload = () => {\n            Crisp.View.get('NavbarMain').reload();\n\n            onChangeResource();\n        };\n\n        // Set visual fixes for media picker mode\n        $('.page--environment').addClass('media-picker');\n    }\n}\n\nmodule.exports = MediaHelper;\n","'use strict';\n\n/**\n * A helper for Media objects\n *\n * @memberof HashBrown.Common.Helpers\n */\nclass MediaHelper {\n    /**\n     * Gets the media root path\n     *\n     * @returns {Promise} Path\n     */\n    static getRootPath() {\n        return ConnectionHelper.getMediaProvider()\n        .then((connection) => {\n            resolve(connection.getMediaPath());   \n        })\n        .catch(() => {\n            resolve('');  \n        });\n    }\n\n    /**\n     * Gets the Media tree\n     *\n     * @returns {Promise(Object)} tree\n     */\n    static getTree() {\n        return Promise.resolve({});\n    }\n    \n    /**\n     * Sets a Media tree item\n     *\n     * @param {String} id\n     * @param {Object} item\n     *\n     * @returns {Promise} promise\n     */\n    static setTreeItem(id, item) {\n        return Promise.resolve();\n    }\n\n    /**\n     * Gets the media temp path\n     *\n     * @param {String} project\n     *\n     * @returns {String} Path\n     */\n    static getTempPath(project) {\n        checkParam(project, 'project', String);\n\n        let path = \n            '/storage/' +\n            ProjectHelper.currentProject +\n            '/temp';\n\n        return path;\n    }\n}\n\nmodule.exports = MediaHelper;\n","'use strict';\n\n/**\n * A helper class for managing projects client side\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass ProjectHelper {\n    /**\n     * Gets the current project id\n     *\n     * @return {String} Project id\n     */\n    static get currentProject() {\n        let parts = location.pathname.substring(1).split('/');\n\n        if(parts.indexOf('dashboard') > -1) { return null; }\n\n        return parts[0];\n    }\n    \n    /**\n     * Gets the current environment name\n     *\n     * @return {String} Environment name\n     */\n    static get currentEnvironment() {\n        let parts = location.pathname.substring(1).split('/');\n\n        if(parts.indexOf('dashboard') > -1) { return null; }\n\n        return parts[1];\n    }\n}\n\nmodule.exports = ProjectHelper;\n","'use strict';\n\n/**\n * A helper class for making HTTP/S requests\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass RequestHelper {\n    /**\n     * An environment specific request\n     *\n     * @param {String} method\n     * @param {String} url\n     * @param {Object} data\n     *\n     * @returns {Promise} Response\n     */\n    static request(method, url, data) {\n        return RequestHelper.customRequest(method, RequestHelper.environmentUrl(url), data);\n    }\n\n    /**\n     * Uploads a file\n     *\n     * @param {String} url\n     * @param {String} type\n     * @param {FormData} data\n     *\n     * @returns {Promise} Response\n     */\n    static uploadFile(url, type, data) {\n        return new Promise((resolve, reject) => {\n            $.ajax({\n                url: RequestHelper.environmentUrl(url),\n                type: 'POST',\n                data: data,\n                processData: false,\n                contentType: false,\n                success: (response) => {\n                    resolve(response);\n                },\n                error: (e) => {\n                    reject(e);            \n                }\n            })\n        });\n        //return RequestHelper.customRequest('POST', RequestHelper.environmentUrl(url), data, { 'Content-Type': type });\n    }\n\n    /**\n     * An environment-independent request\n     *\n     * @param {String} method\n     * @param {String} url\n     * @param {Object} data\n     * @param {Object} headers\n     *\n     * @returns {Promise} Response\n     */\n    static customRequest(method, url, data, headers) {\n        headers = headers || {\n            'Content-Type': 'application/json; charset=utf-8'\n        };\n\n        return new Promise((resolve, reject) => {\n            var xhr = new XMLHttpRequest();\n            xhr.open(method.toUpperCase(), url);\n\n            for(let k in headers) {\n                xhr.setRequestHeader(k, headers[k]);\n            }\n\n            if(data) {\n                if(typeof data === 'object' && data instanceof FormData === false) {\n                    data = JSON.stringify(data);\n                }\n               \n                xhr.send(data);\n\n            } else {\n                xhr.send();\n            \n            }\n\n            xhr.onreadystatechange = () => {\n                const DONE = 4;\n                const OK = 200;\n                const NOT_MODIFIED = 304;\n                const UNAUTHORIZED = 403;\n\n                if(xhr.readyState === DONE) {\n                    if(xhr.status === UNAUTHORIZED) {\n                        location = '/login/?path=' + location.pathname + location.hash;\n\n                        reject(new Error('User is not logged in'));\n\n                    } else if(xhr.status == OK || xhr.status == NOT_MODIFIED) {\n                        let response = xhr.responseText;\n\n                        if(response && response != 'OK') {\n                            try {\n                                response = JSON.parse(response);\n                            \n                            } catch(e) {\n                                // If the response isn't JSON, then so be it\n\n                            }\n                        }\n\n                        if(response === '') { response = null; }\n\n                        resolve(response);\n\n                    } else {\n                        let error = new Error(xhr.responseText);\n\n                        error.statusCode = xhr.status;\n\n                        reject(error);\n                    \n                    }\n                }\n            }\n        });\n    }\n\n    /**\n     * Wraps a URL to include environment\n     *\n     * @param {String} url\n     */\n    static environmentUrl(url) {\n        let newUrl = '/api/';\n\n        if(HashBrown.Helpers.ProjectHelper.currentProject) {\n            newUrl += HashBrown.Helpers.ProjectHelper.currentProject + '/';\n        }\n\n        if(HashBrown.Helpers.ProjectHelper.currentEnvironment) {\n            newUrl += HashBrown.Helpers.ProjectHelper.currentEnvironment + '/';\n        }\n\n        newUrl += url;\n\n        return newUrl;\n    }\n\n    /**\n     * Listens for server restart\n     */\n    static listenForRestart() {\n        UI.messageModal('Restart', 'HashBrown is restarting...', false);\n\n        function poke() {\n            $.ajax({\n                type: 'get',\n                url: '/',\n                success: () => {\n                    location.reload();\n                },\n                error: () => {\n                    poke();\n                }\n            });\n        }\n\n        poke();\n    };\n\n    /**\n     * Reloads a resource\n     */\n    static reloadResource(name) {\n        return RequestHelper.request('get', name)\n        .then((result) => {\n            window.resources[name] = result;\n\n            // Apply correct model\n            for(let i in window.resources[name]) {\n                let object = window.resources[name][i];\n                let model = null;\n\n                switch(name) {\n                    case 'connections':\n                        model = new HashBrown.Models.Connection(object);\n                        break;\n\n                    case 'content':\n                        model = new HashBrown.Models.Content(object);\n                        break;\n\n                    case 'forms':\n                        model = new HashBrown.Models.Form(object);\n                        break;\n\n                    case 'users':\n                        model = new HashBrown.Models.User(object);\n                        break;\n\n                    case 'media':\n                        model = new HashBrown.Models.Media(object);\n                        break;\n\n                    case 'schemas':\n                        model = HashBrown.Helpers.SchemaHelper.getModel(object);\n                        break;\n\n                    default:\n                        return Promise.reject(new Error('Resource \"' + name + '\" has no model defined'));\n                }\n                \n                window.resources[name][i] = model;\n            }\n\n            return Promise.resolve(result);\n        })\n        .catch((e) => {\n            // If the error is a 404, it's an intended response from the controller\n            if(e.statusCode !== 404) {\n                UI.errorModal(e);\n            }\n            \n            window.resources[name] = [];\n\n            return Promise.resolve([]);\n        });\n    };\n\n    /**\n     * Reloads all resources\n     */\n    static reloadAllResources() {\n        $('.page--environment__spinner__messages').empty();\n        \n        let queue = [\n            'content',\n            'schemas',\n            'media',\n            'connections',\n            'forms',\n            'users'\n        ];\n\n        for(let item of queue) {\n            let $msg = _.div({class: 'widget--spinner__message', 'data-name': item}, item);\n            \n            $('.page--environment__spinner__messages').append($msg);\n        }\n\n        let processQueue = () => {\n            let name = queue.shift();\n\n            return RequestHelper.reloadResource(name)\n            .then(() => {\n                $('.page--environment__spinner__messages [data-name=\"' + name + '\"]').toggleClass('loaded', true);\n                \n                if(queue.length < 1) {\n                    return Promise.resolve();\n\n                } else {\n                    return processQueue();\n\n                }\n            });\n        }\n\n        return processQueue();\n    };\n\n}\n\nmodule.exports = RequestHelper;\n","'use strict';\n\n/**\n * A helper class for accessing resources on the server and in cache\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass ResourceHelper {\n    /**\n     * Opens a connection to the indexedDB\n     *\n     * @param {String} action\n     * @param {String} store\n     * @param {Object} query\n     *\n     * @return {Promise} Result\n     */\n    static indexedDbTransaction(action, store, id = null, data = null) {\n        checkParam(action, 'action', String);\n        checkParam(store, 'store', String);\n        checkParam(id, 'id', String);\n        checkParam(data, 'data', Object);\n\n        return new Promise((resolve, reject) => {\n            try {\n                let request = window.indexedDB.open('HashBrownCMS', 1);\n\n                request.onsuccess = (e) => {\n                    resolve(e.target.result);\n                };\n                \n                request.onerror = (e) => {\n                    reject(new Error('Query ' + JSON.stringify(query) + ' with action \"' + action + '\" for store \"' + store + '\" failed. Error code: ' + e.target.errorCode));\n                };\n\n                request.onupgradeneeded = (e) => {\n                    let db = e.target.result;\n                    \n                    db.createObjectStore('connections', { keyPath: 'id', autoIncrement: false });\n                    db.createObjectStore('content', { keyPath: 'id', autoIncrement: false });\n                    db.createObjectStore('schemas', { keyPath: 'id', autoIncrement: false });\n                    db.createObjectStore('media', { keyPath: 'id', autoIncrement: false });\n                    db.createObjectStore('forms', { keyPath: 'id', autoIncrement: false });\n                    db.createObjectStore('users', { keyPath: 'id', autoIncrement: false });\n                };\n\n            } catch(e) {\n                reject(e);\n\n            }\n        })\n        .then((db) => {\n            return new Promise((resolve, reject) => {\n                try {\n                    let objectStore = db.transaction([store], 'readwrite').objectStore(store);\n                    let request = null;\n\n                    if(action === 'put') {\n                        data.id = id;\n                        request = objectStore.put(data);\n                    } else if(action === 'get') {\n                        request = objectStore.get(id);\n                    } else if(action === 'delete') {\n                        request = objectStore.delete(id);\n                    }\n\n                    request.onsuccess = (e) => {\n                        resolve(e.target.result);\n                    };\n                    \n                    request.onerror = (e) => {\n                        reject(new Error('Query ' + JSON.stringify(query) + ' with action \"' + action + '\" for store \"' + store + '\" failed. Error code: ' + e.target.errorCode));\n                    };\n\n                } catch(e) {\n                    reject(e);\n\n                }\n            });\n        });\n    }\n  \n    /**\n     * Gets a resource or a list of resources from cache\n     *\n     * @param {Resource} model\n     * @param {String} category\n     * @param {String} id\n     *\n     * @returns {Promise} Result\n     */\n    static getCache(model, category, id) {\n        checkParam(model, 'model', HashBrown.Models.Resource);\n        checkParam(category, 'category', String);\n\n        return this.indexedDbTransaction('get', category, id)\n        .then((data) => {\n            if(!data) { return Promise.resolve(null); }\n\n            if(!Array.isArray(data)) { return Promise.resolve(new model(data));  }\n\n            for(let i in data) {\n                data[i] = new model(data[i]);\n            }\n\n            return Promise.resolve(data);\n        })\n        .catch((e) => {\n            return Promise.resolve(null);  \n        });\n    }\n\n    /**\n     * Sets a resource in cache\n     *\n     * @param {String} category\n     * @param {String} id\n     * @param {Resource} data\n     *\n     * @returns {Promise} Result\n     */\n    static setCache(category, id, data) {\n        checkParam(category, 'category', String);\n        checkParam(id, 'id', String);\n        checkParam(data, 'data', HashBrown.Models.Resource);\n\n        return this.removeCache(category, id)\n        .then(() => {\n            return this.indexedDbTransaction('put', category, id, data.getObject());\n        });\n    }\n    \n    /**\n     * Removes a resource from cache\n     *\n     * @param {String} category\n     * @param {String} id\n     *\n     * @returns {Promise} Result\n     */\n    static removeCache(category, id, data) {\n        checkParam(category, 'category', String);\n        checkParam(id, 'id', String);\n\n        return this.indexedDbTransaction('delete', category, id);\n    }\n\n    /**\n     * Removes a resource\n     *\n     * @param {String} category\n     * @param {String} id\n     *\n     * @returns {Promise} Result\n     */\n    static remove(category, id) {\n        checkParam(category, 'category', String);\n        checkParam(id, 'id', String);\n\n        return HashBrown.Helpers.RequestHelper.request('delete', category + '/' + id)\n        .then(() => {\n            return this.removeCache(category, id);\n        });\n    }\n\n    /**\n     * Gets a resource or a list of resources\n     *\n     * @param {Resource} model\n     * @param {String} category\n     * @param {String} id\n     *\n     * @returns {Promise} Result\n     */\n    static get(model, category, id = null) {\n        checkParam(model, 'model', HashBrown.Models.Resource);\n        checkParam(category, 'category', String);\n    \n        return this.getCache(model, category, id)\n        .then((result) => {\n            if(result) { return Promise.resolve(result); }\n\n            return HashBrown.Helpers.RequestHelper.request('get', category + (id ? '/' + id : ''))\n            .then((result) => {\n                if(!result) { throw new Error('Resource ' + category + (id ? '/' + id : '') + ' not found'); }\n\n                if(!Array.isArray(result)) {\n                    result = new model(result);\n\n                    this.setCache(category, result.id, result);\n                \n                    return Promise.resolve(result);\n\n                } else {\n                    for(let i in result) {\n                        result[i] = new model(result[i]);\n                        \n                        this.setCache(category, result[i].id, result[i]);\n                    }\n                }\n\n                return Promise.resolve(result);\n            });\n        });\n    }\n    \n    /**\n     * Sets a resource\n     *\n     * @param {String} category\n     * @param {String} id\n     * @param {Resource} data\n     *\n     * @returns {Promise} Result\n     */\n    static set(category, id, data) {\n        checkParam(category, 'category', String);\n        checkParam(category, 'id', String);\n        checkParam(data, 'data', HashBrown.Models.Resource);\n\n        return HashBrown.Helpers.RequestHelper.request('post', category + '/' + id, data)\n        .then(() => {\n            return this.setCache(category, id, data);\n        });\n    }\n}\n\nmodule.exports = ResourceHelper;\n","'use strict';\n\nconst SchemaHelperCommon = require('Common/Helpers/SchemaHelper');\n\n/**\n * The client side Schema helper\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass SchemaHelper extends SchemaHelperCommon {\n    /**\n     * Gets a Schema with all parent fields\n     *\n     * @param {String} id\n     *\n     * @returns {Promise} Schema with parent fields\n     */\n    static getSchemaWithParentFields(id) {\n        if(!id) {\n            return Promise.resolve(null);\n        }\n        \n        return HashBrown.Helpers.RequestHelper.request('get', 'schemas/' + id + '/?withParentFields=true')\n        .then((schema) => {\n            return Promise.resolve(SchemaHelper.getModel(schema));\n        });\n    }\n    \n    /**\n     * Gets a FieldSchema with all parent configs\n     *\n     * @param {String} id\n     *\n     * @returns {FieldSchema} Compiled FieldSchema\n     */\n    static getFieldSchemaWithParentConfigs(id) {\n        let fieldSchema = this.getSchemaByIdSync(id);\n\n        if(!fieldSchema) { return null; }\n\n        let nextSchema = this.getSchemaByIdSync(fieldSchema.parentSchemaId);\n        let compiledSchema = new HashBrown.Models.FieldSchema(fieldSchema.getObject());\n       \n        while(nextSchema) {\n            compiledSchema.appendConfig(nextSchema.config);\n\n            nextSchema = this.getSchemaByIdSync(nextSchema.parentSchemaId);\n        }\n\n        return compiledSchema;\n    }\n\n    /**\n     * Gets a Schema by id\n     *\n     * @param {String} id\n     *\n     * @return {Promise} Promise\n     */\n    static getSchemaById(id) {\n        return HashBrown.Helpers.RequestHelper.request('get', 'schemas/' + id)\n        .then((schema) => {\n            return Promise.resolve(this.getModel(schema));\n        });\n    }\n   \n    /**\n     * Gets all Schemas by type (sync)\n     *\n     * @param {String} type\n     *\n     * @returns {Array} All Schemas\n     */\n    static getAllSchemasSync(type) {\n        if(!type) { return resources.schemas; }\n\n        return resources.schemas.filter((schema) => {\n            if(schema.id == type + 'Base') { return false; }\n\n            return schema.type === type;\n        });\n    }\n\n    /**\n     * Gets a Schema by id (sync)\n     *\n     * @param {String} id\n     *\n     * @return {Promise} Promise\n     */\n    static getSchemaByIdSync(id) {\n        for(let i in resources.schemas) {\n            let schema = resources.schemas[i];\n\n            if(schema.id == id) {\n                if(schema instanceof HashBrown.Models.ContentSchema || schema instanceof HashBrown.Models.FieldSchema) {\n                    return schema;\n                }\n\n                return this.getModel(schema);\n            }\n        }\n    }\n}\n\nmodule.exports = SchemaHelper;\n","'use strict';\n\n/**\n * The common base for SchemaHelper\n *\n * @memberof HashBrown.Common.Helpers\n */\nclass SchemaHelper {\n    /**\n     * Gets all parent fields\n     *\n     * @param {String} id\n     *\n     * @returns {Promise(Schema)} schema\n     */\n    static getSchemaWithParentFields(id) {\n        return new Promise((callback) => {\n            callback();\n        });\n    }\n\n    /**\n     * Gets the appropriate model\n     *\n     * @param {Object} properties\n     *\n     * @return {Schema} Schema\n     */\n    static getModel(properties) {\n        if(!properties) { return null; }\n\n        // If the properties object is already a recognised model, return it\n        if(properties instanceof HashBrown.Models.ContentSchema || properties instanceof HashBrown.Models.FieldSchema) {\n            return properties;\n        }\n\n        // If the properties object is using an unrecognised model, serialise it\n        if(typeof properties.getObject === 'function') {\n            properties = properties.getObject();\n        }\n\n        if(properties.type === 'content') {\n            return new HashBrown.Models.ContentSchema(properties);\n        } else if(properties.type === 'field') {\n            return new HashBrown.Models.FieldSchema(properties);\n        }\n\n        throw new Error('Schema data is incorrectly formatted: ' + JSON.stringify(properties));\n    }\n    \n    /**\n     * Merges two Schemas\n     *\n     * @param Schema childSchema\n     * @param Schema parentSchema\n     *\n     * @returns {Schema} Merged Schema\n     */\n    static mergeSchemas(childSchema, parentSchema) {\n        checkParam(childSchema, 'childSchema', HashBrown.Models.Schema);\n        checkParam(parentSchema, 'parentSchema', HashBrown.Models.Schema);\n\n        childSchema = childSchema.getObject();\n        parentSchema = parentSchema.getObject();\n\n        let mergedSchema = parentSchema;\n\n        // Recursive merge\n        function merge(parentValues, childValues) {\n            for(let k in childValues) {\n                if(typeof parentValues[k] === 'object' && typeof childValues[k] === 'object') {\n                    merge(parentValues[k], childValues[k]);\n                \n                } else if(childValues[k]) {\n                    parentValues[k] = childValues[k];\n                \n                }\n            }\n        }\n\n        // Overwrite native values \n        mergedSchema.id = childSchema.id;\n        mergedSchema.name = childSchema.name;\n        mergedSchema.parentSchemaId = childSchema.parentSchemaId;\n        mergedSchema.icon = childSchema.icon || mergedSchema.icon;\n        \n        // Specific values for schema types\n        switch(mergedSchema.type) {\n            case 'field':\n                mergedSchema.editorId = mergedSchema.editorId || parentSchema.editorId;\n                \n                // Merge config\n                if(!mergedSchema.config) { mergedSchema.config = {}; }\n                if(!parentSchema.config) { parentSchema.config = {}; }\n\n                merge(mergedSchema.config, childSchema.config);\n                break;\n\n            case 'content':\n                // Merge tabs\n                if(!mergedSchema.tabs) { mergedSchema.tabs = {}; }\n                if(!childSchema.tabs) { childSchema.tabs = {}; }\n               \n                merge(mergedSchema.tabs, childSchema.tabs);\n\n                // Merge fields\n                if(!mergedSchema.fields) { mergedSchema.fields = {}; }\n                if(!mergedSchema.fields.properties) { mergedSchema.fields.properties = {}; }\n                if(!childSchema.fields) { childSchema.fields = {}; }\n                if(!childSchema.fields.properties) { childSchema.fields.properties = {}; }\n\n                merge(mergedSchema.fields, childSchema.fields);\n       \n                // Set default tab id\n                mergedSchema.defaultTabId = childSchema.defaultTabId || mergedSchema.defaultTabId;\n                break;\n        }\n\n        return this.getModel(mergedSchema);\n    }\n}\n\nmodule.exports = SchemaHelper;\n","'use strict';\n\nconst SettingsHelperCommon = require('Common/Helpers/SettingsHelper');\n\n/**\n * The client side settings helper\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass SettingsHelper extends SettingsHelperCommon {\n    /**\n     * Gets all settings\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {String} section\n     *\n     * @return {Promise(Object)}  settings\n     */\n    static getSettings(project, environment = null, section = null) {\n        checkParam(project, 'project', String);\n\n        if(environment === '*') { environment = null; }\n\n        let apiUrl = '/api/' + project + '/';\n\n        if(environment) {\n            apiUrl += environment + '/'; \n        }\n       \n        apiUrl += 'settings';\n\n        if(section) {\n            apiUrl += '/' + section;\n        }\n\n        return HashBrown.Helpers.RequestHelper.customRequest('get', apiUrl)\n\n        // Cache settings client-side\n        .then((settings) => {\n            this.updateCache(project, environment, section, settings);\n\n            return Promise.resolve(settings || {});\n        });\n    }\n   \n    /**\n     * Cache update\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {String} section\n     */\n    static cacheSanityCheck(project, environment = null, section = null) {\n        checkParam(project, 'project', String);\n\n        if(environment === '*') { environment = null; }\n\n        this.cache = this.cache || {};\n        this.cache[project] = this.cache[project] || {};\n\n        if(environment) {\n            this.cache[project][environment] = this.cache[project][environment] || {};\n\n            if(section) {\n                this.cache[project][environment][section] = this.cache[project][environment][section] || {};\n            }\n     \n        } else if(section) {\n            this.cache[project][section] = this.cache[project][section] || {};\n        \n        }\n    }\n\n    /**\n     * Cache update\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {String} section\n     * @param {Object} settings\n     */\n    static updateCache(project, environment = null, section = null, settings) {\n        checkParam(project, 'project', String);\n        checkParam(settings, 'settings', Object);\n\n        if(environment === '*') { environment = null; }\n\n        this.cacheSanityCheck(project, environment, section);\n\n        if(environment && !section) {\n            return this.cache[project][environment] = settings;\n        }\n\n        if(!environment && section) {\n            return this.cache[project][section] = settings;\n        }\n        \n        if(environment && section) {\n            return this.cache[project][environment][section] = settings;\n        } \n        \n        return this.cache[project] = settings;\n    }\n\n    /**\n     * Gets cached settings\n     *\n     * @param {String} section\n     *\n     * @returns {Object} Settings\n     */\n    static getCachedSettings(project, environment = null, section = null) {\n        checkParam(project, 'project', String);\n\n        if(environment === '*') { environment = null; }\n\n        this.cacheSanityCheck(project, environment, section);\n\n        if(environment) {\n            if(section) {\n                return this.cache[project][environment][section];\n            }\n                \n            return this.cache[project][environment];\n        }\n        \n        if(section) {\n            return this.cache[project][section];\n        }\n\n        return this.cache[project];\n    }\n\n    /**\n     * Sets all settings\n     *\n     * @param {String} project\n     * @param {String} environment\n     * @param {String} section\n     * @param {Object} settings\n     *\n     * @return {Promise} promise\n     */\n    static setSettings(project, environment = null, section = null, settings) {\n        checkParam(project, 'project', String);\n        checkParam(settings, 'settings', Object);\n\n        if(environment === '*') { environment = null; }\n\n        let apiUrl = '/api/' + project + '/';\n\n        settings.usedBy = 'project';\n\n        if(environment) {\n            apiUrl += environment + '/'; \n\n            settings.usedBy = environment;\n        }\n       \n        apiUrl += 'settings';\n\n        if(section) {\n            apiUrl += '/' + section;\n        }\n\n        return HashBrown.Helpers.RequestHelper.customRequest('post', apiUrl, settings)\n\n        // Cache new settings\n        .then(() => {\n            this.updateCache(project, environment, section, settings);\n\n            return Promise.resolve();\n        })\n    }\n}\n\nmodule.exports = SettingsHelper;\n","'use strict';\n\n/**\n * A helper for settings\n *\n * @memberof HashBrown.Common.Helpers\n */\nclass SettingsHelper {\n}\n\nmodule.exports = SettingsHelper;\n","'use strict';\n\n/**\n * A UI helper for creating and handling common interface behaviours\n *\n * @memberof HashBrown.Client.Helpers\n */\nclass UIHelper {\n    /**\n     * Highlights an element with an optional label\n     *\n     * @param {Boolean|HTMLElement} element\n     * @param {String} label\n     * @param {String} direction\n     * @param {String} buttonLabel\n     *\n     * @return {Promise} Callback on dismiss\n     */\n    static highlight(element, label, direction = 'right', buttonLabel) {\n        if(element === false) {\n            $('.widget--highlight').remove();\n\n            return;\n        }\n\n        if(typeof element === 'string') {\n            element = document.querySelector(element);\n        }\n\n        if(!element) { return Promise.resolve(); }\n\n        return new Promise((resolve) => {\n            let dismiss = () => {\n                $highlight.remove();\n\n                resolve(element);\n            };\n            \n            let $highlight = _.div({class: 'widget--highlight' + (label ? ' ' + direction : ''), style: 'top: ' + element.offsetTop + 'px; left: ' + element.offsetLeft + 'px;'},\n                _.div({class: 'widget--highlight__backdrop'}),\n                _.div({class: 'widget--highlight__frame', style: 'width: ' + element.offsetWidth + 'px; height: ' + element.offsetHeight + 'px;'}),\n                _.if(label,\n                    _.div({class: 'widget--highlight__label'},\n                        _.div({class: 'widget--highlight__label__text'}, label),\n                        _.if(buttonLabel,\n                            _.button({class: 'widget widget--button widget--highlight__button condensed'}, buttonLabel)\n                                .click(() => {\n                                    dismiss();\n                                })\n                        )\n                    )\n                )\n            ).click(() => {\n                if(buttonLabel) { return; }\n\n                dismiss();\n            });\n            \n            _.append(element.parentElement, $highlight);\n        });\n    }\n\n    /**\n     * Sets the content of the editor space\n     *\n     * @param {Array|HTMLElement} content\n     * @param {String} className\n     */\n    static setEditorSpaceContent(content, className) {\n        let $space = $('.page--environment__space--editor');\n\n        if(className) {\n            content = _.div({class: 'page--environment__space--editor__' + className}, content);\n        }\n\n        _.append($space.empty(), content);\n    }\n\n    /**\n     * Creates a sortable context specific to arrays using editor fields\n     *\n     * @param {Array} array\n     * @param {HTMLElement} field\n     * @param {Function} onChange\n     */\n    static fieldSortableArray(array, field, onChange) {\n        array = array || [];\n\n        // Set indices on all elements\n        let items = field.querySelector('.editor__field__value').children;\n\n        for(let i = 0; i < items.length; i++) {\n            if(items[i] instanceof HTMLElement === false || !items[i].classList.contains('editor__field')) { continue; }\n\n            items[i].dataset.index = i;\n        }\n\n        // Init the sortable context\n        this.fieldSortable(field, (element) => {\n            if(!element) { return; }\n\n            let oldIndex = element.dataset.index;\n            let newIndex = 0;\n\n            // Discover new index\n            let items = field.querySelector('.editor__field__value').children;\n\n            for(let i = 0; i < items.length; i++) {\n                if(items[i] === element) {\n                    newIndex = i;\n                    break;\n                }\n            }\n\n            // Swap indices\n            array.splice(newIndex, 0, array.splice(oldIndex, 1)[0])\n\n            onChange(array);\n        });\n    }\n\n    /**\n     * Creates a sortable context specific to objects using editor fields\n     *\n     * @param {Object} object\n     * @param {HTMLElement} field\n     * @param {Function} onChange\n     */\n    static fieldSortableObject(object, field, onChange) {\n        object = object || {};\n\n        this.fieldSortable(field, (element) => {\n            if(!element) { return; }\n\n            let itemSortKeyElement = element.querySelector('.editor__field__sort-key');\n            let itemKey = itemSortKeyElement.value || itemSortKeyElement.innerHTML;\n            let itemValue = object[itemKey];\n\n            // Try to get the next key\n            let nextKey = '';\n            let nextSortKeyElement = element.nextElementSibling ? element.nextElementSibling.querySelector('.editor__field__sort-key') : null;\n\n            if(nextSortKeyElement) {\n                nextKey = nextSortKeyElement.value || nextSortKeyElement.innerHTML;\n            }\n\n            // Construct a new object based on the old one\n            let newObject = {};\n\n            for(let fieldKey in object) {\n                // Omit existing key\n                if(fieldKey === itemKey) { continue; }\n\n                let fieldValue = object[fieldKey];\n\n                // If there is a next key, and it's the same as this field key,\n                // the sorted item should be inserted just before it\n                if(nextKey === fieldKey) {\n                    newObject[itemKey] = itemValue;\n                }\n\n                newObject[fieldKey] = fieldValue;\n            }\n\n            // If the item wasn't reinserted, insert it now\n            if(!newObject[itemKey]) {\n                newObject[itemKey] = itemValue;\n            }\n\n            // Assign the new object to the old one\n            object = newObject;\n\n            // Fire the change event\n            onChange(newObject);\n        });\n    }\n\n    /**\n     * Creates a sortable context specific to fields\n     *\n     * @param {HTMLElement} field\n     * @param {Function} onChange\n     */\n    static fieldSortable(field, onChange) {\n        let btnSort = field.querySelector('.editor__field__key__action--sort');\n        let divValue = field.querySelector('.editor__field__value');\n        let isSorting = !divValue.classList.contains('sorting');\n\n        if(this.sortable(divValue, 'editor__field', isSorting, onChange)) {\n            btnSort.classList.toggle('sorting', isSorting);\n            divValue.classList.toggle('sorting', isSorting);\n        }\n    }\n\n    /**\n     * Creates a sortable context\n     *\n     * @param {HTMLElement} parentElement\n     * @param {String} sortableClassName\n     * @param {Boolean} isActive\n     * @param {Function} onChange\n     *\n     * @returns {Boolean} Whether or not sorting was initialised\n     */\n    static sortable(parentElement, sortableClassName, isActive, onChange) {\n        let children = Array.prototype.slice.call(parentElement.children || []);\n        let canSort = true;\n        let currentDraggedChild;\n        \n        children = children.filter((child) => {\n            return child instanceof HTMLElement && child.classList.contains(sortableClassName);\n        });\n\n        if(!children || children.length < 1) { return false; }\n\n        if(typeof isActive === 'undefined') {\n            isActive = !parentElement.classList.contains('sorting');\n        }\n\n        if(isActive) {\n            parentElement.ondragover = (e) => {\n                if(!canSort || !currentDraggedChild) { return; }\n\n                let bodyRect = document.body.getBoundingClientRect();\n\n                _.each(children, (i, sibling) => {\n                    if(sibling === currentDraggedChild || !canSort || e.pageY < 1) { return; }\n\n                    let cursorY = e.pageY;\n                    let childY = currentDraggedChild.getBoundingClientRect().y - bodyRect.y;\n                    let siblingY = sibling.getBoundingClientRect().y - bodyRect.y;\n                    let hasMoved = false;\n\n                    // Dragging above a sibling\n                    if(cursorY < siblingY && childY > siblingY) {\n                        sibling.parentElement.insertBefore(currentDraggedChild, sibling);    \n                        hasMoved = true;\n                    }\n\n                    // Dragging below a sibling\n                    if(cursorY > siblingY && childY < siblingY) {\n                        sibling.parentElement.insertBefore(currentDraggedChild, sibling.nextElementSibling);\n                        hasMoved = true;\n                    }\n\n                    // Init transition\n                    if(hasMoved) {\n                        canSort = false;\n\n                        let newChildY = currentDraggedChild.getBoundingClientRect().y - document.body.getBoundingClientRect().y;\n                        let newSiblingY = sibling.getBoundingClientRect().y - document.body.getBoundingClientRect().y;\n\n                        currentDraggedChild.style.transform = 'translateY(' + (childY - newChildY) + 'px)';\n                        sibling.style.transform = 'translateY(' + (siblingY - newSiblingY) + 'px)';\n\n                        setTimeout(() => {\n                            currentDraggedChild.removeAttribute('style');\n                            sibling.removeAttribute('style');\n                            canSort = true;\n                        }, 100);\n                    }\n                });\n            };\n\n        } else {\n            parentElement.ondragover = null;\n\n        }\n\n        _.each(children, (i, child) => {\n            child.draggable = isActive;\n\n            if(isActive) {\n                child.ondragstart = (e) => {\n                    e.dataTransfer.setData('text/plain', '');\n                    child.classList.toggle('dragging', true);\n                    currentDraggedChild = child;\n                };\n                \n                child.ondragend = (e) => {\n                    onChange(child);\n                    currentDraggedChild = null;\n                    child.classList.toggle('dragging', false);\n                };\n\n                child.ondragcancel = (e) => {\n                    onChange(child);\n                    currentDraggedChild = null;\n                    child.classList.toggle('dragging', false);\n                };\n\n            } else {\n                child.classList.toggle('dragging', false);\n                child.ondragstart = null;\n                child.ondrag = null;\n                child.ondragstop = null;\n                child.ondragcancel = null;\n                currentDraggedChild = null;\n            }\n        });\n        \n        parentElement.classList.toggle('sorting', isActive);\n\n        return true;\n    }\n\n\n    /**\n     * Creates a switch\n     *\n     * @param {Boolean} initialValue\n     * @param {Function} onChange\n     *\n     * @returns {HTMLElement} Switch element\n     */\n    static inputSwitch(initialValue, onChange) {\n        let id = 'switch-' + (10000 + Math.floor(Math.random() * 10000));\n        let $input;\n\n        let $element = _.div({class: 'switch', 'data-checked': initialValue},\n            $input = _.input({\n                id: id,\n                class: 'form-control switch',\n                type: 'checkbox'\n            }).change(function() {\n                this.parentElement.dataset.checked = this.checked;\n\n                if(onChange) {\n                    onChange(this.checked);\n                }\n            }),\n            _.label({for: id})\n        );\n\n        $element.on('set', (e, newValue) => {\n            $input[0].checked = newValue;\n        });\n\n        if(initialValue) {\n            $input.attr('checked', true);\n        }\n\n        return $element;\n    }\n\n    /**\n     * Creates a group of chips\n     *\n     * @param {Array} items\n     * @param {Array} dropdownItems\n     * @param {Function} onChange\n     * @param {Boolean} isDropdownUnique\n     *\n     * @returns {HtmlElement} Chip group element\n     */\n    static inputChipGroup(items, dropdownItems, onChange, isDropdownUnique) {\n        let $element = _.div({class: 'chip-group'});\n\n        if(!items) { items = []; }\n\n        function render() {\n            _.append($element.empty(),\n\n                // Render individual chips\n                _.each(items, (itemIndex, item) => {\n                    let label = item.label || item.name || item.title;\n                    \n                    if(!label) {\n                        for(let dropdownItem of dropdownItems) {\n                            let value = dropdownItem.id || dropdownItem.value || dropdownItem;\n\n                            if(value === item) {\n                                label = dropdownItem.label || dropdownItem.name || dropdownItem.title || dropdownItem;\n                            }\n                        }\n                    }\n\n                    if(!label) { \n                        label = item;\n                    }\n\n                    let $chip = _.div({class: 'chip'},\n\n                        // Dropdown\n                        _.if(Array.isArray(dropdownItems),\n                            _.div({class: 'chip-label dropdown'},\n                                _.button({class: 'dropdown-toggle', 'data-toggle': 'dropdown'},\n                                    label\n                                ),\n                                _.if(onChange,\n                                    _.ul({class: 'dropdown-menu'},\n                                        _.each(dropdownItems, (dropdownItemIndex, dropdownItem) => {\n                                            // Look for unique dropdown items\n                                            if(isDropdownUnique) {\n                                                for(let item of items) {\n                                                    if(item == dropdownItem) {\n                                                        return;\n                                                    }\n                                                }\n                                            }\n\n                                            return _.li(\n                                                _.a({href: '#'},\n                                                    dropdownItem.label || dropdownItem.name || dropdownItem.title || dropdownItem\n                                                ).click(function(e) {\n                                                    e.preventDefault();\n                                                        \n                                                    items[itemIndex] = dropdownItem.value || dropdownItem.id || dropdownItem;\n\n                                                    render();\n                                \n                                                    if(typeof onChange === 'function') {\n                                                        onChange(items);\n                                                    }\n                                                })\n                                            );\n                                        })\n                                    )\n                                )\n                            )\n                        ),\n\n                        // Regular string\n                        _.if(!Array.isArray(dropdownItems),\n                            _.if(!onChange,\n                                _.p({class: 'chip-label'}, item)\n                            ),\n                            _.if(onChange,\n                                _.input({type: 'text', class: 'chip-label', value: item})\n                                    .change((e) => {\n                                        items[itemIndex] = e.target.value;\n                                    })\n                            )\n                        ),\n\n                        // Remove button\n                        _.if(onChange,\n                            _.button({class: 'btn chip-remove'},\n                                _.span({class: 'fa fa-remove'})\n                            ).click(() => {\n                                items.splice(itemIndex, 1);\n\n                                render();\n\n                                if(typeof onChange === 'function') {\n                                    onChange(items);\n                                }\n                            })\n                        )\n                    );\n                    \n                    return $chip;\n                }),\n\n                // Add button\n                _.if(onChange,\n                    _.button({class: 'btn chip-add'},\n                        _.span({class: 'fa fa-plus'})\n                    ).click(() => {\n                        if(Array.isArray(dropdownItems)) {\n                            if(isDropdownUnique) {\n                                for(let dropdownItem of dropdownItems) {\n                                    let isSelected = false;\n\n                                    for(let item of items) {\n                                        if(item == dropdownItem) {\n                                            isSelected = true;\n                                            break;\n                                        }\n                                    }\n\n                                    if(!isSelected) {\n                                        items.push(dropdownItem.value || dropdownItem);\n                                        break;\n                                    }\n                                }\n                            } else {\n                                items.push(dropdownItems[0].value || dropdownItems[0]);\n                            }\n                        \n                        } else if(typeof dropdownItems === 'string') {\n                            items.push(dropdownItems);\n\n                        } else {\n                            items.push('New item');\n\n                        }\n\n                        render(); \n\n                        if(typeof onChange === 'function') {\n                            onChange(items);\n                        }\n                    })\n                )\n            );\n        };\n\n        render();\n\n        return $element;\n    }\n    \n    /**\n     * Renders a carousel\n     *\n     * @param {Array} items\n     * @param {Boolean} useIndicators\n     * @param {Boolean} useControls\n     * @param {String} height\n     *\n     * @returns {HtmlElement} Carousel element\n     */\n    static carousel(items, useIndicators, useControls, height) {\n        let id = 'carousel-' + (10000 + Math.floor(Math.random() * 10000));\n        \n        return _.div({class: 'carousel slide', id: id, 'data-ride': 'carousel', 'data-interval': 0},\n            _.if(useIndicators,\n                _.ol({class: 'carousel-indicators'},\n                    _.each(items, (i, item) => {\n                        return _.li({'data-target': '#' + id, 'data-slide-to': i, class: i == 0 ? 'active' : ''});\n                    })\n                )\n            ),\n            _.div({class: 'carousel-inner', role: 'listbox'},\n                _.each(items, (i, item) => {\n                    return _.div({class: 'item' + (i == 0? ' active': ''), style: 'height:' + (height || '500px')},\n                        item\n                    );\n                })\n            ),\n            _.if(useControls,\n                _.a({href: '#' + id, role: 'button', class: 'left carousel-control', 'data-slide': 'prev'},\n                    _.span({class: 'fa fa-arrow-left'})\n                ),\n                _.a({href: '#' + id, role: 'button', class: 'right carousel-control', 'data-slide': 'next'},\n                    _.span({class: 'fa fa-arrow-right'})\n                )\n            )\n        );\n    }\n\n    /**\n     * Brings up an error modal\n     *\n     * @param {String|Error} error\n     * @param {Function} onClickOK\n     */\n    static errorModal(error, onClickOK) {\n        if(!error) { return; }\n\n        if(error instanceof String) {\n            error = new Error(error);\n        \n        } else if(error instanceof Object) {\n            if(error.responseText) {\n                error = new Error(error.responseText);\n            }\n        \n        } else if(error instanceof Error === false) {\n            error = new Error(error.toString());\n\n        }\n       \n        debug.log(error.message, error.stack, 'HashBrown');\n\n        return UIHelper.messageModal('<span class=\"fa fa-warning\"></span> Error', error.message, onClickOK, 'error');\n    }\n    \n    /**\n     * Brings up a warning modal\n     *\n     * @param {String} warning\n     * @param {Function} onClickOK\n     */\n    static warningModal(warning, onClickOK) {\n        if(!warning) { return; }\n\n        return UIHelper.messageModal('<span class=\"fa fa-warning\"></span> Warning', warning, onClickOK, 'warning');\n    }\n\n    /**\n     * Brings up a message modal\n     *\n     * @param {String} title\n     * @param {String} body\n     * @param {Function} onClickOK\n     * @param {String} group\n     */\n    static messageModal(title, body, onClickOK, group) {\n        let modal = new HashBrown.Views.Modals.Modal({\n            isBlocking: onClickOK === false,\n            title: title,\n            group: group,\n            body: body\n        });\n\n        if(onClickOK) {\n            modal.on('ok', onClickOK);\n        }\n\n        return modal;\n    }\n\n    /**\n     * Brings up an iframe modal\n     *\n     * @param {String} title\n     * @param {String} url\n     * @param {Function} onSubmit\n     * @param {Function} onCancel\n     */\n    static iframeModal(title, url, onSubmit, onCancel) {\n        let modal = new HashBrown.Views.Modals.IframeModal({\n            title: title,\n            url: url\n        });\n\n        if(typeof onSubmit === 'function') {\n            modal.on('ok', onSubmit);\n        }\n\n        if(typeof onCancel === 'function') {\n            modal.on('cancel', onCancel);\n        }\n       \n        return modal;\n    }\n\n    /**\n     * Brings up a confirm modal\n     *\n     * @param {String} type\n     * @param {String} title\n     * @param {String} body\n     * @param {Function} onSubmit\n     */\n    static confirmModal(type, title, body, onSubmit, onCancel) {\n        let modal = new HashBrown.Views.Modals.ConfirmModal({\n            type: type ? type.toLowerCase() : null,\n            title: title,\n            body: body\n        });\n\n        modal.on('cancel', onCancel);\n        modal.on('ok', onSubmit);\n\n        return modal;\n    }\n\n    /**\n     * Creates a context menu\n     */\n    static context(element, items) {\n        let openContextMenu = (e) => {\n            // Find any existing context menu targets and remove their classes\n            let clearTargets = () => {\n                let targets = document.querySelectorAll('.context-menu-target');\n            \n                if(targets) {\n                    for(let i = 0; i < targets.length; i++) {\n                        targets[i].classList.remove('context-menu-target');\n                    }\n                }\n            };\n\n            clearTargets();\n\n            // Set new target\n            element.classList.toggle('context-menu-target', true);\n            \n            // Remove existing dropdowns\n            let existingMenu = _.find('.widget--dropdown.context-menu');\n\n            if(existingMenu) { existingMenu.remove(); }\n\n            // Init new dropdown\n            let dropdown = new HashBrown.Views.Widgets.Dropdown({\n                options: items,\n                reverseKeys: true,\n                onChange: (pickedItem) => {\n                    if(typeof pickedItem !== 'function') { return; }\n\n                    pickedItem();\n                }\n            });\n\n            // Prevent the toggle button from blocking new context menu events\n            let toggle = dropdown.element.querySelector('.widget--dropdown__toggle');\n\n            toggle.addEventListener('contextmenu', (e) => {\n                e.preventDefault();\n                dropdown.toggle(false);\n            });\n\n            // Set cancel event\n            dropdown.on('cancel', () => {\n                dropdown.remove();\n\n                // Wait a bit before removing the classes, as they are often used as references in the functions executed by the context menu\n                setTimeout(() => {\n                    clearTargets();\n                }, 100);\n            });\n\n            // Set styles\n            dropdown.element.classList.toggle('context-menu', true);\n            dropdown.element.style.top = e.touches ? e.touches[0].pageY : e.pageY;\n            dropdown.element.style.left = e.touches ? e.touches[0].pageX : e.pageX;\n\n            // Open it\n            dropdown.toggle(true);\n\n            // Append to body\n            document.body.appendChild(dropdown.element);\n        };\n        \n        element.addEventListener('contextmenu', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n                \n            openContextMenu(e);\n        });\n\n        element.addEventListener('click', (e) => {\n            if(e.which === 3 || e.ctrlKey) {\n                e.preventDefault();\n                e.stopPropagation();\n            \n                openContextMenu(e);\n            }\n        });\n        \n        element.addEventListener('touchstart', (e) => {\n            if(e.touchTargets && e.touchTargets.length > 1) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                openContextMenu(e);\n            }\n        });\n    }\n}\n\nmodule.exports = UIHelper;\n"],"sourceRoot":""}